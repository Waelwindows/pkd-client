





<!DOCTYPE html>
<html
  lang="en"
  
  data-color-mode="auto" data-light-theme="light" data-dark-theme="dark"
  data-a11y-animated-images="system" data-a11y-link-underlines="true"
  
  >




  <head>
    <meta charset="utf-8">
  <link rel="dns-prefetch" href="https://github.githubassets.com">
  <link rel="dns-prefetch" href="https://avatars.githubusercontent.com">
  <link rel="dns-prefetch" href="https://github-cloud.s3.amazonaws.com">
  <link rel="dns-prefetch" href="https://user-images.githubusercontent.com/">
  <link rel="preconnect" href="https://github.githubassets.com" crossorigin>
  <link rel="preconnect" href="https://avatars.githubusercontent.com">

  


  <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/light-44e67b0cd5d5.css" /><link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/light_high_contrast-b51c2fae25e8.css" /><link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/dark-cb035ed575b8.css" /><link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/dark_high_contrast-99e9b1169976.css" /><link data-color-theme="light" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light-44e67b0cd5d5.css" /><link data-color-theme="light_high_contrast" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light_high_contrast-b51c2fae25e8.css" /><link data-color-theme="light_colorblind" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light_colorblind-dadcba82130c.css" /><link data-color-theme="light_colorblind_high_contrast" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light_colorblind_high_contrast-cdc36145225e.css" /><link data-color-theme="light_tritanopia" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light_tritanopia-0ca195e3b5f3.css" /><link data-color-theme="light_tritanopia_high_contrast" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/light_tritanopia_high_contrast-f9fb5556a83f.css" /><link data-color-theme="dark" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark-cb035ed575b8.css" /><link data-color-theme="dark_high_contrast" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_high_contrast-99e9b1169976.css" /><link data-color-theme="dark_colorblind" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_colorblind-9541c4141757.css" /><link data-color-theme="dark_colorblind_high_contrast" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_colorblind_high_contrast-bc604fc65912.css" /><link data-color-theme="dark_tritanopia" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_tritanopia-384776200fd7.css" /><link data-color-theme="dark_tritanopia_high_contrast" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_tritanopia_high_contrast-489c70dedd0a.css" /><link data-color-theme="dark_dimmed" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_dimmed-1545a2e9e540.css" /><link data-color-theme="dark_dimmed_high_contrast" crossorigin="anonymous" media="all" rel="stylesheet" data-href="https://github.githubassets.com/assets/dark_dimmed_high_contrast-4c1792a987c3.css" />

  <style type="text/css">
    :root {
      --tab-size-preference: 4;
    }

    pre, code {
      tab-size: var(--tab-size-preference);
    }
  </style>

    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-primitives-15839d47b75d.css" />
    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-a5c85403da8c.css" />
    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/global-4d11e88b2383.css" />
    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/github-73fd10e24e0c.css" />
  <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/repository-5d735668c600.css" />
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/code-9c9b8dc61e74.css" />

  

  <script type="application/json" id="client-env">{"locale":"en","featureFlags":["alternate_user_config_repo","api_insights_show_missing_data_banner","attestations_filtering","attestations_sorting","billing_unfiltered_discounts","client_version_header","codespaces_prebuild_region_target_update","contact_sales_locale_utm_medium","contentful_lp_footnotes","copilot_agent_cli_public_preview","copilot_agent_tasks_btn_code_nav","copilot_agent_tasks_btn_code_view","copilot_agent_tasks_btn_code_view_lines","copilot_api_agentic_issue_marshal_yaml","copilot_api_github_draft_update_issue_skill","copilot_bing_search_use_azure_ai_agent_service","copilot_bing_search_use_grounding_ui","copilot_chat_attach_multiple_images","copilot_chat_file_redirect","copilot_chat_reduce_quota_checks","copilot_chat_search_bar_redirect","copilot_chat_selection_attachments","copilot_chat_vision_in_claude","copilot_chat_vision_skip_thread_create","copilot_custom_copilots","copilot_custom_copilots_feature_preview","copilot_duplicate_thread","copilot_extensions_deprecation_notice","copilot_features_raycast_logo","copilot_file_block_ref_matching","copilot_free_to_paid_telem","copilot_ftp_hyperspace_upgrade_prompt","copilot_ftp_settings_upgrade","copilot_ftp_upgrade_to_pro_from_models","copilot_ftp_your_copilot_settings","copilot_generate_commit_message_dry_regenerate","copilot_immersive_structured_model_picker","copilot_no_floating_button","copilot_read_shared_conversation","copilot_show_copilot_sub_issues_button_on_issues_page","copilot_spaces_as_attachments","copilot_spaces_ga","copilot_spark_loading_webgl","copilot_spark_progressive_error_handling","copilot_spark_read_iteration_history_from_git_v2","copilot_spark_single_user_iteration","copilot_spark_use_billing_headers","copilot_spark_write_iteration_history_to_git","copilot_stable_conversation_view","copilot_workbench_agent_seed_tool","copilot_workbench_cache","copilot_workbench_connection_reload_banner","copilot_workbench_preview_analytics","copilot_workbench_refresh_on_wsod","copilot_workbench_skip_repo_on_codespace","copilot_workbench_use_single_prompt","direct_to_salesforce","dotcom_chat_client_side_skills","failbot_report_error_react_apps_on_page","ghas_licensing_card_header_cta","ghost_pilot_confidence_truncation_25","ghost_pilot_confidence_truncation_40","global_search_multi_orgs","hpc_improve_dom_insertion_observer","inp_reduced_threshold","insert_before_patch","issue_fields_report_usage","issues_copilot_cross_repo_assign","issues_react_blur_item_picker_on_close","issues_react_bots_timeline_pagination","issues_react_prohibit_title_fallback","issues_react_remove_placeholders","issues_sticky_sidebar","item_picker_milestone_tsq_migration","kb_convert_to_space","lifecycle_label_name_updates","link_contact_sales_swp_marketo","marketing_pages_search_explore_provider","mcp_registry_install","memex_mwl_filter_field_delimiter","migrate_toasts_to_banners_web_notifications","new_traffic_page_banner","override_pulse_legacy_url","pinned_issue_fields","primer_react_segmented_control_tooltip","primer_react_unified_portal_root","record_sso_banner_metrics","ref_selector_create_tag_dialog","releases_update_ref_selector","remove_child_patch","repos_insights_remove_new_url","sample_network_conn_type","scheduled_reminders_updated_limits","site_homepage_collaborate_video","site_homepage_contentful","site_msbuild_webgl_hero","spark_commit_on_default_branch","spark_force_push_after_checkout","spark_show_data_access_on_publish","spark_sync_repository_after_iteration","viewscreen_sandbox","webp_support","workbench_store_readonly"],"copilotApiOverrideUrl":"https://api.githubcopilot.com"}</script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/high-contrast-cookie-f3788027bd8d.js"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/wp-runtime-0a33df58e674.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_oddbird_popover-polyfill_dist_popover-fn_js-468bf7cab607.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_stacktrace-parser_dist_stack-trace-parser_esm_js-node_modules_github_bro-2f4e04-280c10ec004d.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/environment-b4e74adb6411.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_primer_behaviors_dist_esm_index_mjs-3eee64e5ddf0.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_selector-observer_dist_index_esm_js-9ab93471824e.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_relative-time-element_dist_index_js-c98257dc79a7.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_auto-complete-element_dist_index_js-node_modules_github_catalyst_-0d7d60-ad3a87b2f0eb.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_text-expander-element_dist_index_js-754f5b5e9e7e.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_filter-input-element_dist_index_js-node_modules_github_remote-inp-665e70-ac788066c220.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_markdown-toolbar-element_dist_index_js-d41270eb61be.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_file-attachment-element_dist_index_js-node_modules_primer_view-co-777ce2-9ec8c103bf42.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/github-elements-9e1d42c09c62.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/element-registry-a2a22f48e135.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_braintree_browser-detection_dist_browser-detection_js-node_modules_githu-bb80ec-f11c694928ba.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_lit-html_lit-html_js-9012bef51135.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_mini-throttle_dist_index_js-node_modules_morphdom_dist_morphdom-e-c1896e-ba47f43192a8.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_remote-form_dist_index_js-node_modules_delegated-events_dist_inde-893f9f-9ba0881c72fb.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_turbo_dist_turbo_es2017-esm_js-8eb9b2209bcd.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_hotkey_dist_index_js-node_modules_github_hydro-analytics-client_d-dd3ec8-1f3d5f90de2b.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_quote-selection_dist_index_js-node_modules_github_session-resume_-31b9f3-e00a737a5ea6.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_document-metadata_document-metadata_ts-packages_failbot_failbot_ts-06156f7d8d1a.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_updatable-content_updatable-content_ts-38f5e2f7c2a7.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_behaviors_ajax-error_ts-app_assets_modules_github_behaviors_details-6493f1-cecb020e2bb7.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_behaviors_task-list_ts-app_assets_modules_github_throttled-input_ts-047775-cfe8770908d1.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_github_behaviors_commenting_edit_ts-app_assets_modules_github_behaviors_ht-83c235-d8c5bfe37d1d.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/behaviors-2c0a177b1bbe.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_delegated-events_dist_index_js-node_modules_github_catalyst_lib_index_js-ef6d0f-20d6767cecc0.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/notifications-global-d89a4ddd4532.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_mini-throttle_dist_index_js-node_modules_github_catalyst_lib_inde-96937f-70732ff56a20.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/code-menu-614eb4e0c016.js" defer="defer"></script>
  
  <script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/primer-react-08acf876eb7c.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/react-lib-25ef56e89e94.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/react-core-ca4f004636c1.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/octicons-react-dfcd3f5e8531.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_emotion_is-prop-valid_dist_emotion-is-prop-valid_esm_js-node_modules_emo-5b2f05-e03e95da9abb.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_mini-throttle_dist_index_js-node_modules_github_hydro-analytics-c-c228f9-e9af1d9bff76.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_tanstack_query-core_build_modern_mutation_js-node_modules_tanstack_query-9bf7e4-2866c135221a.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_swc_helpers_esm__class_private_method_get_js-node_modules_swc_helpers_es-d6b1a6-ea538d0fdafa.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_dompurify_dist_purify_es_mjs-0294cfa498e7.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_tanstack_query-core_build_modern_queryObserver_js-node_modules_tanstack_-defd52-b021f9f0d92e.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_lodash-es__Stack_js-node_modules_lodash-es__Uint8Array_js-node_modules_l-4faaa6-fa61bd48d446.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_hydro-analytics-client_dist_analytics-client_js-node_modules_gith-c7919d-70dcea79f7a9.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_tanstack_react-virtual_dist_esm_index_js-4f7c027617ef.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_mini-throttle_dist_decorators_js-node_modules_accname_dist_access-690142-387fd2fa9b38.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_fzy_js_index_js-node_modules_lit-labs_react_index_js-node_modules_primer-f2dcb3-705cdc996f67.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_catalyst_lib_index_js-node_modules_swc_helpers_esm__class_check_p-2c3c06-e97dfd69b8bb.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_react-reverse-portal_dist_web_index_js-node_modules_swc_helpers_esm__cla-3af928-d148e6552274.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_paths_index_ts-b2d80b245113.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_history_history_ts-packages_promise-with-resolvers-polyfill_promise-with-resolvers-p-2cdd04-a13a722d5075.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_ref-selector_RefSelector_tsx-c9b0b65e746b.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_copilot-chat_utils_copilot-local-storage_ts-5dc327763002.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_copilot-chat_components_tracing_TraceProvider_tsx-3bf4bd1c2170.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_copilot-chat_utils_CopilotChatContext_tsx-packages_safe-html_VerifiedHTML_tsx-396ac2da7fe9.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_commit-attribution_index_ts-packages_commit-checks-status_index_ts-packages_current--18e2dc-36936e806be4.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_code-view-shared_hooks_use-canonical-object_ts-packages_code-view-shared_hooks_use-f-37800a-6c8f00a8ce1c.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_app-uuid_app-uuid_ts-packages_repos-file-tree-view_repos-file-tree-view_ts-0977800e9d2d.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/app_assets_modules_react-code-view_utilities_lines_ts-2feff25dd2a7.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_code-view-shared_utilities_web-worker_ts-packages_code-view-shared_worker-jobs_debou-a85645-b1eb8311b77e.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/react-code-view-39ceeaba7a58.js" defer="defer"></script>
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-react.c916beccff42f23950ab.module.css" />
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/react-code-view.9d3b72df4543ce88ddf6.module.css" />

  <script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/packages_notifications-subscriptions-menu_entry_ts-packages_promise-with-resolvers-polyfill_p-15cb60-e3e8760e36b7.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/notifications-subscriptions-menu-c6e2d0703961.js" defer="defer"></script>
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-react.c916beccff42f23950ab.module.css" />
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/notifications-subscriptions-menu.bab8822ac328fb95c70d.module.css" />


  <title>public-key-directory-specification/Specification.md at main · fedi-e2ee/public-key-directory-specification · GitHub</title>



  <meta name="route-pattern" content="/:user_id/:repository/blob/*name(/*path)" data-turbo-transient>
  <meta name="route-controller" content="blob" data-turbo-transient>
  <meta name="route-action" content="show" data-turbo-transient>
  <meta name="fetch-nonce" content="v2:bd676494-8a7e-4a70-afcd-fad71956b5c1">

    
  <meta name="current-catalog-service-hash" content="f3abb0cc802f3d7b95fc8762b94bdcb13bf39634c40c357301c4aa1d67a256fb">


  <meta name="request-id" content="DBE0:2F2F35:727FE:E6C73:68F191FD" data-pjax-transient="true"/><meta name="html-safe-nonce" content="85e6488b3ce96a672eddd73c4563e09bd0aeb559f3bdb0720ed93d81bd7b2934" data-pjax-transient="true"/><meta name="visitor-payload" content="eyJyZWZlcnJlciI6IiIsInJlcXVlc3RfaWQiOiJEQkUwOjJGMkYzNTo3MjdGRTpFNkM3Mzo2OEYxOTFGRCIsInZpc2l0b3JfaWQiOiIyNTM5NDM3ODcxMzIzOTE5MzMiLCJyZWdpb25fZWRnZSI6InVhZW5vcnRoIiwicmVnaW9uX3JlbmRlciI6InVhZW5vcnRoIn0=" data-pjax-transient="true"/><meta name="visitor-hmac" content="f19ae61420760d04141f6cd4715e806c59b1b00cf11716a51700760bc7ad7955" data-pjax-transient="true"/>


    <meta name="hovercard-subject-tag" content="repository:812178125" data-turbo-transient>


  <meta name="github-keyboard-shortcuts" content="repository,source-code,file-tree,copilot" data-turbo-transient="true" />
  

  <meta name="selected-link" value="repo_source" data-turbo-transient>
  <link rel="assets" href="https://github.githubassets.com/">

    <meta name="google-site-verification" content="Apib7-x98H0j5cPqHWwSMm6dNU4GmODRoqxLiDzdx9I">

<meta name="octolytics-url" content="https://collector.github.com/github/collect" />

  <meta name="analytics-location" content="/&lt;user-name&gt;/&lt;repo-name&gt;/blob/show" data-turbo-transient="true" />

  




    <meta name="user-login" content="">

  

    <meta name="viewport" content="width=device-width">

    

      <meta name="description" content="Specification for a Fediverse Directory Server for Public Keys - public-key-directory-specification/Specification.md at main · fedi-e2ee/public-key-directory-specification">

      <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="GitHub">

    <link rel="fluid-icon" href="https://github.com/fluidicon.png" title="GitHub">
    <meta property="fb:app_id" content="1401488693436528">
    <meta name="apple-itunes-app" content="app-id=1477376905, app-argument=https://github.com/fedi-e2ee/public-key-directory-specification/blob/main/Specification.md" />

      <meta name="twitter:image" content="https://opengraph.githubassets.com/8942ffb638a247abfd031a5afc66f1cc3be1ed1ae8ea2b680ebc1c2389fa2103/fedi-e2ee/public-key-directory-specification" /><meta name="twitter:site" content="@github" /><meta name="twitter:card" content="summary_large_image" /><meta name="twitter:title" content="public-key-directory-specification/Specification.md at main · fedi-e2ee/public-key-directory-specification" /><meta name="twitter:description" content="Specification for a Fediverse Directory Server for Public Keys - fedi-e2ee/public-key-directory-specification" />
  <meta property="og:image" content="https://opengraph.githubassets.com/8942ffb638a247abfd031a5afc66f1cc3be1ed1ae8ea2b680ebc1c2389fa2103/fedi-e2ee/public-key-directory-specification" /><meta property="og:image:alt" content="Specification for a Fediverse Directory Server for Public Keys - fedi-e2ee/public-key-directory-specification" /><meta property="og:image:width" content="1200" /><meta property="og:image:height" content="600" /><meta property="og:site_name" content="GitHub" /><meta property="og:type" content="object" /><meta property="og:title" content="public-key-directory-specification/Specification.md at main · fedi-e2ee/public-key-directory-specification" /><meta property="og:url" content="https://github.com/fedi-e2ee/public-key-directory-specification/blob/main/Specification.md" /><meta property="og:description" content="Specification for a Fediverse Directory Server for Public Keys - fedi-e2ee/public-key-directory-specification" />
  




      <meta name="hostname" content="github.com">



        <meta name="expected-hostname" content="github.com">


  <meta http-equiv="x-pjax-version" content="23c36fcad2070a9e180b120dd65f0bcf6e7e9defe86636983f03c38fcafb3e5c" data-turbo-track="reload">
  <meta http-equiv="x-pjax-csp-version" content="c922ef32c4ab94f8b870c62883f3e41755ec705db76ec4efb0d343458f1e28c7" data-turbo-track="reload">
  <meta http-equiv="x-pjax-css-version" content="d18b3c9fa72cd490c825769fe7da15241f27234ff3cead1c3655abad201ff181" data-turbo-track="reload">
  <meta http-equiv="x-pjax-js-version" content="bd2fb72cd8b091a6140c1464d4f00fab0bd474d2e73850a7c1ff2b2789e0487d" data-turbo-track="reload">

  <meta name="turbo-cache-control" content="no-preview" data-turbo-transient="">

      <meta name="turbo-cache-control" content="no-cache" data-turbo-transient>

    <meta data-hydrostats="publish">

  <meta name="go-import" content="github.com/fedi-e2ee/public-key-directory-specification git https://github.com/fedi-e2ee/public-key-directory-specification.git">

  <meta name="octolytics-dimension-user_id" content="172102947" /><meta name="octolytics-dimension-user_login" content="fedi-e2ee" /><meta name="octolytics-dimension-repository_id" content="812178125" /><meta name="octolytics-dimension-repository_nwo" content="fedi-e2ee/public-key-directory-specification" /><meta name="octolytics-dimension-repository_public" content="true" /><meta name="octolytics-dimension-repository_is_fork" content="false" /><meta name="octolytics-dimension-repository_network_root_id" content="812178125" /><meta name="octolytics-dimension-repository_network_root_nwo" content="fedi-e2ee/public-key-directory-specification" />



    

    <meta name="turbo-body-classes" content="logged-out env-production page-responsive">


  <meta name="browser-stats-url" content="https://api.github.com/_private/browser/stats">

  <meta name="browser-errors-url" content="https://api.github.com/_private/browser/errors">

  <meta name="release" content="39203871828945377b98ad4a2da6bedb8c714e5f">
  <meta name="ui-target" content="full">

  <link rel="mask-icon" href="https://github.githubassets.com/assets/pinned-octocat-093da3e6fa40.svg" color="#000000">
  <link rel="alternate icon" class="js-site-favicon" type="image/png" href="https://github.githubassets.com/favicons/favicon.png">
  <link rel="icon" class="js-site-favicon" type="image/svg+xml" href="https://github.githubassets.com/favicons/favicon.svg" data-base-href="https://github.githubassets.com/favicons/favicon">

<meta name="theme-color" content="#1e2327">
<meta name="color-scheme" content="light dark" />


  <link rel="manifest" href="/manifest.json" crossOrigin="use-credentials">

  </head>

  <body class="logged-out env-production page-responsive" style="word-wrap: break-word;">
    <div data-turbo-body class="logged-out env-production page-responsive" style="word-wrap: break-word;">
      



    <div class="position-relative header-wrapper js-header-wrapper ">
      <a href="#start-of-content" data-skip-target-assigned="false" class="px-2 py-4 color-bg-accent-emphasis color-fg-on-emphasis show-on-focus js-skip-to-content">Skip to content</a>

      <span data-view-component="true" class="progress-pjax-loader Progress position-fixed width-full">
    <span style="width: 0%;" data-view-component="true" class="Progress-item progress-pjax-loader-bar left-0 top-0 color-bg-accent-emphasis"></span>
</span>      
      
      <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-react.c916beccff42f23950ab.module.css" />
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/keyboard-shortcuts-dialog.2de9c7d6456a311fce49.module.css" />

<react-partial
  partial-name="keyboard-shortcuts-dialog"
  data-ssr="false"
  data-attempted-ssr="false"
  data-react-profiling="false"
>
  
  <script type="application/json" data-target="react-partial.embeddedData">{"props":{"docsUrl":"https://docs.github.com/get-started/accessibility/keyboard-shortcuts"}}</script>
  <div data-target="react-partial.reactRoot"></div>
</react-partial>





      

          

              
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_gsap_index_js-23c9606618ce.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/vendors-node_modules_github_remote-form_dist_index_js-node_modules_delegated-events_dist_inde-94fd67-dc050877d1bf.js" defer="defer"></script>
<script crossorigin="anonymous" type="application/javascript" src="https://github.githubassets.com/assets/sessions-917229b8a853.js" defer="defer"></script>

<header class="HeaderMktg header-logged-out js-details-container js-header Details f4 py-3" role="banner" data-is-top="true" data-color-mode=light data-light-theme=light data-dark-theme=dark>
  <h2 class="sr-only">Navigation Menu</h2>

  <button type="button" class="HeaderMktg-backdrop d-lg-none border-0 position-fixed top-0 left-0 width-full height-full js-details-target" aria-label="Toggle navigation">
    <span class="d-none">Toggle navigation</span>
  </button>

  <div class="d-flex flex-column flex-lg-row flex-items-center px-3 px-md-4 px-lg-5 height-full position-relative z-1">
    <div class="d-flex flex-justify-between flex-items-center width-full width-lg-auto">
      <div class="flex-1">
        <button aria-label="Toggle navigation" aria-expanded="false" type="button" data-view-component="true" class="js-details-target js-nav-padding-recalculate js-header-menu-toggle Button--link Button--medium Button d-lg-none color-fg-inherit p-1">  <span class="Button-content">
    <span class="Button-label"><div class="HeaderMenu-toggle-bar rounded my-1"></div>
            <div class="HeaderMenu-toggle-bar rounded my-1"></div>
            <div class="HeaderMenu-toggle-bar rounded my-1"></div></span>
  </span>
</button>
      </div>

      <a class="mr-lg-3 color-fg-inherit flex-order-2 js-prevent-focus-on-mobile-nav"
        href="/"
        aria-label="Homepage"
        data-analytics-event="{&quot;category&quot;:&quot;Marketing nav&quot;,&quot;action&quot;:&quot;click to go to homepage&quot;,&quot;label&quot;:&quot;ref_page:Marketing;ref_cta:Logomark;ref_loc:Header&quot;}">
        <svg height="32" aria-hidden="true" viewBox="0 0 24 24" version="1.1" width="32" data-view-component="true" class="octicon octicon-mark-github">
    <path d="M12 1C5.923 1 1 5.923 1 12c0 4.867 3.149 8.979 7.521 10.436.55.096.756-.233.756-.522 0-.262-.013-1.128-.013-2.049-2.764.509-3.479-.674-3.699-1.292-.124-.317-.66-1.293-1.127-1.554-.385-.207-.936-.715-.014-.729.866-.014 1.485.797 1.691 1.128.99 1.663 2.571 1.196 3.204.907.096-.715.385-1.196.701-1.471-2.448-.275-5.005-1.224-5.005-5.432 0-1.196.426-2.186 1.128-2.956-.111-.275-.496-1.402.11-2.915 0 0 .921-.288 3.024 1.128a10.193 10.193 0 0 1 2.75-.371c.936 0 1.871.123 2.75.371 2.104-1.43 3.025-1.128 3.025-1.128.605 1.513.221 2.64.111 2.915.701.77 1.127 1.747 1.127 2.956 0 4.222-2.571 5.157-5.019 5.432.399.344.743 1.004.743 2.035 0 1.471-.014 2.654-.014 3.025 0 .289.206.632.756.522C19.851 20.979 23 16.854 23 12c0-6.077-4.922-11-11-11Z"></path>
</svg>
      </a>

      <div class="d-flex flex-1 flex-order-2 text-right d-lg-none gap-2 flex-justify-end">
          <a
            href="/login?return_to=https%3A%2F%2Fgithub.com%2Ffedi-e2ee%2Fpublic-key-directory-specification%2Fblob%2Fmain%2FSpecification.md"
            class="HeaderMenu-link HeaderMenu-button d-inline-flex f5 no-underline border color-border-default rounded-2 px-2 py-1 color-fg-inherit js-prevent-focus-on-mobile-nav"
            data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;site header menu&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;SIGN_UP&quot;,&quot;originating_url&quot;:&quot;https://github.com/fedi-e2ee/public-key-directory-specification/blob/main/Specification.md&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="bdc4ea9572fe079183fe5885c9de48bde7abc4925963509402c71f9a9c17622d"
            data-analytics-event="{&quot;category&quot;:&quot;Marketing nav&quot;,&quot;action&quot;:&quot;click to Sign in&quot;,&quot;label&quot;:&quot;ref_page:Marketing;ref_cta:Sign in;ref_loc:Header&quot;}"
          >
            Sign in
          </a>
              <div class="AppHeader-appearanceSettings">
    <react-partial-anchor>
      <button data-target="react-partial-anchor.anchor" id="icon-button-bfdf42e5-de39-47c8-b282-0e8f2b62930e" aria-labelledby="tooltip-571445d7-81ff-44db-a09b-6717ce46a682" type="button" disabled="disabled" data-view-component="true" class="Button Button--iconOnly Button--invisible Button--medium AppHeader-button HeaderMenu-link border cursor-wait">  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-sliders Button-visual">
    <path d="M15 2.75a.75.75 0 0 1-.75.75h-4a.75.75 0 0 1 0-1.5h4a.75.75 0 0 1 .75.75Zm-8.5.75v1.25a.75.75 0 0 0 1.5 0v-4a.75.75 0 0 0-1.5 0V2H1.75a.75.75 0 0 0 0 1.5H6.5Zm1.25 5.25a.75.75 0 0 0 0-1.5h-6a.75.75 0 0 0 0 1.5h6ZM15 8a.75.75 0 0 1-.75.75H11.5V10a.75.75 0 1 1-1.5 0V6a.75.75 0 0 1 1.5 0v1.25h2.75A.75.75 0 0 1 15 8Zm-9 5.25v-2a.75.75 0 0 0-1.5 0v1.25H1.75a.75.75 0 0 0 0 1.5H4.5v1.25a.75.75 0 0 0 1.5 0v-2Zm9 0a.75.75 0 0 1-.75.75h-6a.75.75 0 0 1 0-1.5h6a.75.75 0 0 1 .75.75Z"></path>
</svg>
</button><tool-tip id="tooltip-571445d7-81ff-44db-a09b-6717ce46a682" for="icon-button-bfdf42e5-de39-47c8-b282-0e8f2b62930e" popover="manual" data-direction="s" data-type="label" data-view-component="true" class="sr-only position-absolute">Appearance settings</tool-tip>

      <template data-target="react-partial-anchor.template">
        <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-react.c916beccff42f23950ab.module.css" />
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/appearance-settings.6c63a6de228d6520804d.module.css" />

<react-partial
  partial-name="appearance-settings"
  data-ssr="false"
  data-attempted-ssr="false"
  data-react-profiling="false"
>
  
  <script type="application/json" data-target="react-partial.embeddedData">{"props":{}}</script>
  <div data-target="react-partial.reactRoot"></div>
</react-partial>


      </template>
    </react-partial-anchor>
  </div>

      </div>
    </div>


    <div class="HeaderMenu js-header-menu height-fit position-lg-relative d-lg-flex flex-column flex-auto top-0">
      <div class="HeaderMenu-wrapper d-flex flex-column flex-self-start flex-lg-row flex-auto rounded rounded-lg-0">
          <nav class="HeaderMenu-nav" aria-label="Global">
            <ul class="d-lg-flex list-style-none">
                <li class="HeaderMenu-item position-relative flex-wrap flex-justify-between flex-items-center d-block d-lg-flex flex-lg-nowrap flex-lg-items-center js-details-container js-header-menu-item">
      <button type="button" class="HeaderMenu-link border-0 width-full width-lg-auto px-0 px-lg-2 py-lg-2 no-wrap d-flex flex-items-center flex-justify-between js-details-target" aria-expanded="false">
        Platform
        <svg opacity="0.5" aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-chevron-down HeaderMenu-icon ml-1">
    <path d="M12.78 5.22a.749.749 0 0 1 0 1.06l-4.25 4.25a.749.749 0 0 1-1.06 0L3.22 6.28a.749.749 0 1 1 1.06-1.06L8 8.939l3.72-3.719a.749.749 0 0 1 1.06 0Z"></path>
</svg>
      </button>

      <div class="HeaderMenu-dropdown dropdown-menu rounded m-0 p-0 pt-2 pt-lg-4 position-relative position-lg-absolute left-0 left-lg-n3 dropdown-menu-wide">
        <div class="d-lg-flex dropdown-menu-wide">
            <div class="HeaderMenu-column px-lg-4">
                <div class="">

                  <ul class="list-style-none f5" >
                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description mb-lg-3" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;github_copilot&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;github_copilot_link_platform_navbar&quot;}" href="https://github.com/features/copilot">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-copilot color-fg-subtle mr-3">
    <path d="M23.922 16.992c-.861 1.495-5.859 5.023-11.922 5.023-6.063 0-11.061-3.528-11.922-5.023A.641.641 0 0 1 0 16.736v-2.869a.841.841 0 0 1 .053-.22c.372-.935 1.347-2.292 2.605-2.656.167-.429.414-1.055.644-1.517a10.195 10.195 0 0 1-.052-1.086c0-1.331.282-2.499 1.132-3.368.397-.406.89-.717 1.474-.952 1.399-1.136 3.392-2.093 6.122-2.093 2.731 0 4.767.957 6.166 2.093.584.235 1.077.546 1.474.952.85.869 1.132 2.037 1.132 3.368 0 .368-.014.733-.052 1.086.23.462.477 1.088.644 1.517 1.258.364 2.233 1.721 2.605 2.656a.832.832 0 0 1 .053.22v2.869a.641.641 0 0 1-.078.256ZM12.172 11h-.344a4.323 4.323 0 0 1-.355.508C10.703 12.455 9.555 13 7.965 13c-1.725 0-2.989-.359-3.782-1.259a2.005 2.005 0 0 1-.085-.104L4 11.741v6.585c1.435.779 4.514 2.179 8 2.179 3.486 0 6.565-1.4 8-2.179v-6.585l-.098-.104s-.033.045-.085.104c-.793.9-2.057 1.259-3.782 1.259-1.59 0-2.738-.545-3.508-1.492a4.323 4.323 0 0 1-.355-.508h-.016.016Zm.641-2.935c.136 1.057.403 1.913.878 2.497.442.544 1.134.938 2.344.938 1.573 0 2.292-.337 2.657-.751.384-.435.558-1.15.558-2.361 0-1.14-.243-1.847-.705-2.319-.477-.488-1.319-.862-2.824-1.025-1.487-.161-2.192.138-2.533.529-.269.307-.437.808-.438 1.578v.021c0 .265.021.562.063.893Zm-1.626 0c.042-.331.063-.628.063-.894v-.02c-.001-.77-.169-1.271-.438-1.578-.341-.391-1.046-.69-2.533-.529-1.505.163-2.347.537-2.824 1.025-.462.472-.705 1.179-.705 2.319 0 1.211.175 1.926.558 2.361.365.414 1.084.751 2.657.751 1.21 0 1.902-.394 2.344-.938.475-.584.742-1.44.878-2.497Z"></path><path d="M14.5 14.25a1 1 0 0 1 1 1v2a1 1 0 0 1-2 0v-2a1 1 0 0 1 1-1Zm-5 0a1 1 0 0 1 1 1v2a1 1 0 0 1-2 0v-2a1 1 0 0 1 1-1Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">
          GitHub Copilot

        </div>

        Write better code with AI
      </div>

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description mb-lg-3" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;github_spark&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;github_spark_link_platform_navbar&quot;}" href="https://github.com/features/spark">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-sparkle-fill color-fg-subtle mr-3">
    <path d="M11.296 1.924c.24-.656 1.168-.656 1.408 0l.717 1.958a11.25 11.25 0 0 0 6.697 6.697l1.958.717c.657.24.657 1.168 0 1.408l-1.958.717a11.25 11.25 0 0 0-6.697 6.697l-.717 1.958c-.24.657-1.168.657-1.408 0l-.717-1.958a11.25 11.25 0 0 0-6.697-6.697l-1.958-.717c-.656-.24-.656-1.168 0-1.408l1.958-.717a11.25 11.25 0 0 0 6.697-6.697l.717-1.958Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">
          GitHub Spark

            <span class="HeaderMenu-label">
              New
            </span>
        </div>

        Build and deploy intelligent apps
      </div>

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description mb-lg-3" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;github_models&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;github_models_link_platform_navbar&quot;}" href="https://github.com/features/models">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-ai-model color-fg-subtle mr-3">
    <path d="M19.375 8.5a3.25 3.25 0 1 1-3.163 4h-3a3.252 3.252 0 0 1-4.443 2.509L7.214 17.76a3.25 3.25 0 1 1-1.342-.674l1.672-2.957A3.238 3.238 0 0 1 6.75 12c0-.907.371-1.727.97-2.316L6.117 6.846A3.253 3.253 0 0 1 1.875 3.75a3.25 3.25 0 1 1 5.526 2.32l1.603 2.836A3.25 3.25 0 0 1 13.093 11h3.119a3.252 3.252 0 0 1 3.163-2.5ZM10 10.25a1.75 1.75 0 1 0-.001 3.499A1.75 1.75 0 0 0 10 10.25ZM5.125 2a1.75 1.75 0 1 0 0 3.5 1.75 1.75 0 0 0 0-3.5Zm12.5 9.75a1.75 1.75 0 1 0 3.5 0 1.75 1.75 0 0 0-3.5 0Zm-14.25 8.5a1.75 1.75 0 1 0 3.501-.001 1.75 1.75 0 0 0-3.501.001Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">
          GitHub Models

            <span class="HeaderMenu-label">
              New
            </span>
        </div>

        Manage and compare prompts
      </div>

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description mb-lg-3" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;github_advanced_security&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;github_advanced_security_link_platform_navbar&quot;}" href="https://github.com/security/advanced-security">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-shield-check color-fg-subtle mr-3">
    <path d="M16.53 9.78a.75.75 0 0 0-1.06-1.06L11 13.19l-1.97-1.97a.75.75 0 0 0-1.06 1.06l2.5 2.5a.75.75 0 0 0 1.06 0l5-5Z"></path><path d="m12.54.637 8.25 2.675A1.75 1.75 0 0 1 22 4.976V10c0 6.19-3.771 10.704-9.401 12.83a1.704 1.704 0 0 1-1.198 0C5.77 20.705 2 16.19 2 10V4.976c0-.758.489-1.43 1.21-1.664L11.46.637a1.748 1.748 0 0 1 1.08 0Zm-.617 1.426-8.25 2.676a.249.249 0 0 0-.173.237V10c0 5.46 3.28 9.483 8.43 11.426a.199.199 0 0 0 .14 0C17.22 19.483 20.5 15.461 20.5 10V4.976a.25.25 0 0 0-.173-.237l-8.25-2.676a.253.253 0 0 0-.154 0Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">
          GitHub Advanced Security

        </div>

        Find and fix vulnerabilities
      </div>

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;actions&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;actions_link_platform_navbar&quot;}" href="https://github.com/features/actions">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-workflow color-fg-subtle mr-3">
    <path d="M1 3a2 2 0 0 1 2-2h6.5a2 2 0 0 1 2 2v6.5a2 2 0 0 1-2 2H7v4.063C7 16.355 7.644 17 8.438 17H12.5v-2.5a2 2 0 0 1 2-2H21a2 2 0 0 1 2 2V21a2 2 0 0 1-2 2h-6.5a2 2 0 0 1-2-2v-2.5H8.437A2.939 2.939 0 0 1 5.5 15.562V11.5H3a2 2 0 0 1-2-2Zm2-.5a.5.5 0 0 0-.5.5v6.5a.5.5 0 0 0 .5.5h6.5a.5.5 0 0 0 .5-.5V3a.5.5 0 0 0-.5-.5ZM14.5 14a.5.5 0 0 0-.5.5V21a.5.5 0 0 0 .5.5H21a.5.5 0 0 0 .5-.5v-6.5a.5.5 0 0 0-.5-.5Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">
          Actions

        </div>

        Automate any workflow
      </div>

    
</a></li>

                  </ul>
                </div>
            </div>
            <div class="HeaderMenu-column px-lg-4 pb-3 pb-lg-0 border-lg-right">
                <div class="border-bottom border-lg-bottom-0 pb-lg-0 pb-3">

                  <ul class="list-style-none f5" >
                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description mb-lg-3" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;codespaces&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;codespaces_link_platform_navbar&quot;}" href="https://github.com/features/codespaces">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-codespaces color-fg-subtle mr-3">
    <path d="M3.5 3.75C3.5 2.784 4.284 2 5.25 2h13.5c.966 0 1.75.784 1.75 1.75v7.5A1.75 1.75 0 0 1 18.75 13H5.25a1.75 1.75 0 0 1-1.75-1.75Zm-2 12c0-.966.784-1.75 1.75-1.75h17.5c.966 0 1.75.784 1.75 1.75v4a1.75 1.75 0 0 1-1.75 1.75H3.25a1.75 1.75 0 0 1-1.75-1.75ZM5.25 3.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h13.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Zm-2 12a.25.25 0 0 0-.25.25v4c0 .138.112.25.25.25h17.5a.25.25 0 0 0 .25-.25v-4a.25.25 0 0 0-.25-.25Z"></path><path d="M10 17.75a.75.75 0 0 1 .75-.75h6.5a.75.75 0 0 1 0 1.5h-6.5a.75.75 0 0 1-.75-.75Zm-4 0a.75.75 0 0 1 .75-.75h.5a.75.75 0 0 1 0 1.5h-.5a.75.75 0 0 1-.75-.75Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">
          Codespaces

        </div>

        Instant dev environments
      </div>

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description mb-lg-3" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;issues&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;issues_link_platform_navbar&quot;}" href="https://github.com/features/issues">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-issue-opened color-fg-subtle mr-3">
    <path d="M12 1c6.075 0 11 4.925 11 11s-4.925 11-11 11S1 18.075 1 12 5.925 1 12 1ZM2.5 12a9.5 9.5 0 0 0 9.5 9.5 9.5 9.5 0 0 0 9.5-9.5A9.5 9.5 0 0 0 12 2.5 9.5 9.5 0 0 0 2.5 12Zm9.5 2a2 2 0 1 1-.001-3.999A2 2 0 0 1 12 14Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">
          Issues

        </div>

        Plan and track work
      </div>

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description mb-lg-3" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;code_review&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;code_review_link_platform_navbar&quot;}" href="https://github.com/features/code-review">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-code-review color-fg-subtle mr-3">
    <path d="M10.3 6.74a.75.75 0 0 1-.04 1.06l-2.908 2.7 2.908 2.7a.75.75 0 1 1-1.02 1.1l-3.5-3.25a.75.75 0 0 1 0-1.1l3.5-3.25a.75.75 0 0 1 1.06.04Zm3.44 1.06a.75.75 0 1 1 1.02-1.1l3.5 3.25a.75.75 0 0 1 0 1.1l-3.5 3.25a.75.75 0 1 1-1.02-1.1l2.908-2.7-2.908-2.7Z"></path><path d="M1.5 4.25c0-.966.784-1.75 1.75-1.75h17.5c.966 0 1.75.784 1.75 1.75v12.5a1.75 1.75 0 0 1-1.75 1.75h-9.69l-3.573 3.573A1.458 1.458 0 0 1 5 21.043V18.5H3.25a1.75 1.75 0 0 1-1.75-1.75ZM3.25 4a.25.25 0 0 0-.25.25v12.5c0 .138.112.25.25.25h2.5a.75.75 0 0 1 .75.75v3.19l3.72-3.72a.749.749 0 0 1 .53-.22h10a.25.25 0 0 0 .25-.25V4.25a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">
          Code Review

        </div>

        Manage code changes
      </div>

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description mb-lg-3" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;discussions&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;discussions_link_platform_navbar&quot;}" href="https://github.com/features/discussions">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-comment-discussion color-fg-subtle mr-3">
    <path d="M1.75 1h12.5c.966 0 1.75.784 1.75 1.75v9.5A1.75 1.75 0 0 1 14.25 14H8.061l-2.574 2.573A1.458 1.458 0 0 1 3 15.543V14H1.75A1.75 1.75 0 0 1 0 12.25v-9.5C0 1.784.784 1 1.75 1ZM1.5 2.75v9.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h6.5a.25.25 0 0 0 .25-.25v-9.5a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25Z"></path><path d="M22.5 8.75a.25.25 0 0 0-.25-.25h-3.5a.75.75 0 0 1 0-1.5h3.5c.966 0 1.75.784 1.75 1.75v9.5A1.75 1.75 0 0 1 22.25 20H21v1.543a1.457 1.457 0 0 1-2.487 1.03L15.939 20H10.75A1.75 1.75 0 0 1 9 18.25v-1.465a.75.75 0 0 1 1.5 0v1.465c0 .138.112.25.25.25h5.5a.75.75 0 0 1 .53.22l2.72 2.72v-2.19a.75.75 0 0 1 .75-.75h2a.25.25 0 0 0 .25-.25v-9.5Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">
          Discussions

        </div>

        Collaborate outside of code
      </div>

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;code_search&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;code_search_link_platform_navbar&quot;}" href="https://github.com/features/code-search">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-code-square color-fg-subtle mr-3">
    <path d="M10.3 8.24a.75.75 0 0 1-.04 1.06L7.352 12l2.908 2.7a.75.75 0 1 1-1.02 1.1l-3.5-3.25a.75.75 0 0 1 0-1.1l3.5-3.25a.75.75 0 0 1 1.06.04Zm3.44 1.06a.75.75 0 1 1 1.02-1.1l3.5 3.25a.75.75 0 0 1 0 1.1l-3.5 3.25a.75.75 0 1 1-1.02-1.1l2.908-2.7-2.908-2.7Z"></path><path d="M2 3.75C2 2.784 2.784 2 3.75 2h16.5c.966 0 1.75.784 1.75 1.75v16.5A1.75 1.75 0 0 1 20.25 22H3.75A1.75 1.75 0 0 1 2 20.25Zm1.75-.25a.25.25 0 0 0-.25.25v16.5c0 .138.112.25.25.25h16.5a.25.25 0 0 0 .25-.25V3.75a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">
          Code Search

        </div>

        Find more, search less
      </div>

    
</a></li>

                  </ul>
                </div>
            </div>
            <div class="HeaderMenu-column px-lg-4">
                <div class="border-bottom border-lg-bottom-0 pb-lg-0 mb-3 pb-3">

                      <span class="d-block h4 color-fg-default my-1" id="platform-explore-heading">Explore</span>

                  <ul class="list-style-none f5" aria-labelledby="platform-explore-heading">
                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;why_github&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;why_github_link_platform_navbar&quot;}" href="https://github.com/why-github">
      Why GitHub

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary Link--external" target="_blank" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;documentation&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;documentation_link_platform_navbar&quot;}" href="https://docs.github.com">
      Documentation

    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-link-external HeaderMenu-external-icon color-fg-subtle">
    <path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path>
</svg>
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary Link--external" target="_blank" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;github_skills&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;github_skills_link_platform_navbar&quot;}" href="https://skills.github.com">
      GitHub Skills

    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-link-external HeaderMenu-external-icon color-fg-subtle">
    <path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path>
</svg>
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary Link--external" target="_blank" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;blog&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;blog_link_platform_navbar&quot;}" href="https://github.blog">
      Blog

    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-link-external HeaderMenu-external-icon color-fg-subtle">
    <path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path>
</svg>
</a></li>

                  </ul>
                </div>
                <div class="border-bottom border-lg-bottom-0 pb-lg-0 pb-3">

                      <span class="d-block h4 color-fg-default my-1" id="platform-integrations-heading">Integrations</span>

                  <ul class="list-style-none f5" aria-labelledby="platform-integrations-heading">
                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;github_marketplace&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;github_marketplace_link_platform_navbar&quot;}" href="https://github.com/marketplace">
      GitHub Marketplace

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;mcp_registry&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;mcp_registry_link_platform_navbar&quot;}" href="https://github.com/mcp">
      MCP Registry

    
</a></li>

                  </ul>
                </div>
            </div>
        </div>

          <div class="HeaderMenu-trailing-link rounded-bottom-2 mt-lg-4 px-lg-4 py-4 py-lg-3 f5 text-semibold">
            <a data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;view_all_features&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;view_all_features_link_platform_navbar&quot;}" href="https://github.com/features">
              View all features
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-chevron-right HeaderMenu-trailing-link-icon">
    <path d="M6.22 3.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L9.94 8 6.22 4.28a.75.75 0 0 1 0-1.06Z"></path>
</svg>
</a>          </div>
      </div>
</li>


                <li class="HeaderMenu-item position-relative flex-wrap flex-justify-between flex-items-center d-block d-lg-flex flex-lg-nowrap flex-lg-items-center js-details-container js-header-menu-item">
      <button type="button" class="HeaderMenu-link border-0 width-full width-lg-auto px-0 px-lg-2 py-lg-2 no-wrap d-flex flex-items-center flex-justify-between js-details-target" aria-expanded="false">
        Solutions
        <svg opacity="0.5" aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-chevron-down HeaderMenu-icon ml-1">
    <path d="M12.78 5.22a.749.749 0 0 1 0 1.06l-4.25 4.25a.749.749 0 0 1-1.06 0L3.22 6.28a.749.749 0 1 1 1.06-1.06L8 8.939l3.72-3.719a.749.749 0 0 1 1.06 0Z"></path>
</svg>
      </button>

      <div class="HeaderMenu-dropdown dropdown-menu rounded m-0 p-0 pt-2 pt-lg-4 position-relative position-lg-absolute left-0 left-lg-n3 dropdown-menu-wide">
        <div class="d-lg-flex dropdown-menu-wide">
            <div class="HeaderMenu-column px-lg-4 pb-3 pb-lg-0 border-lg-right">
                <div class="border-bottom border-lg-bottom-0 pb-lg-0 pb-3">

                      <span class="d-block h4 color-fg-default my-1" id="solutions-by-company-size-heading">By company size</span>

                  <ul class="list-style-none f5" aria-labelledby="solutions-by-company-size-heading">
                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;enterprises&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;enterprises_link_solutions_navbar&quot;}" href="https://github.com/enterprise">
      Enterprises

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;small_and_medium_teams&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;small_and_medium_teams_link_solutions_navbar&quot;}" href="https://github.com/team">
      Small and medium teams

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;startups&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;startups_link_solutions_navbar&quot;}" href="https://github.com/enterprise/startups">
      Startups

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;nonprofits&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;nonprofits_link_solutions_navbar&quot;}" href="/solutions/industry/nonprofits">
      Nonprofits

    
</a></li>

                  </ul>
                </div>
            </div>
            <div class="HeaderMenu-column px-lg-4 pb-3 pb-lg-0 border-lg-right">
                <div class="border-bottom border-lg-bottom-0 pb-lg-0 pb-3">

                      <span class="d-block h4 color-fg-default my-1" id="solutions-by-use-case-heading">By use case</span>

                  <ul class="list-style-none f5" aria-labelledby="solutions-by-use-case-heading">
                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;app_modernization&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;app_modernization_link_solutions_navbar&quot;}" href="/solutions/use-case/app-modernization">
      App Modernization

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;devsecops&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;devsecops_link_solutions_navbar&quot;}" href="/solutions/use-case/devsecops">
      DevSecOps

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;devops&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;devops_link_solutions_navbar&quot;}" href="/solutions/use-case/devops">
      DevOps

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;ci_cd&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;ci_cd_link_solutions_navbar&quot;}" href="/solutions/use-case/ci-cd">
      CI/CD

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;view_all_use_cases&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;view_all_use_cases_link_solutions_navbar&quot;}" href="/solutions/use-case">
      View all use cases

    
</a></li>

                  </ul>
                </div>
            </div>
            <div class="HeaderMenu-column px-lg-4">
                <div class="border-bottom border-lg-bottom-0 pb-lg-0 pb-3">

                      <span class="d-block h4 color-fg-default my-1" id="solutions-by-industry-heading">By industry</span>

                  <ul class="list-style-none f5" aria-labelledby="solutions-by-industry-heading">
                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;healthcare&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;healthcare_link_solutions_navbar&quot;}" href="/solutions/industry/healthcare">
      Healthcare

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;financial_services&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;financial_services_link_solutions_navbar&quot;}" href="/solutions/industry/financial-services">
      Financial services

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;manufacturing&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;manufacturing_link_solutions_navbar&quot;}" href="/solutions/industry/manufacturing">
      Manufacturing

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;government&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;government_link_solutions_navbar&quot;}" href="/solutions/industry/government">
      Government

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;view_all_industries&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;view_all_industries_link_solutions_navbar&quot;}" href="/solutions/industry">
      View all industries

    
</a></li>

                  </ul>
                </div>
            </div>
        </div>

          <div class="HeaderMenu-trailing-link rounded-bottom-2 mt-lg-4 px-lg-4 py-4 py-lg-3 f5 text-semibold">
            <a data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;view_all_solutions&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;view_all_solutions_link_solutions_navbar&quot;}" href="/solutions">
              View all solutions
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-chevron-right HeaderMenu-trailing-link-icon">
    <path d="M6.22 3.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L9.94 8 6.22 4.28a.75.75 0 0 1 0-1.06Z"></path>
</svg>
</a>          </div>
      </div>
</li>


                <li class="HeaderMenu-item position-relative flex-wrap flex-justify-between flex-items-center d-block d-lg-flex flex-lg-nowrap flex-lg-items-center js-details-container js-header-menu-item">
      <button type="button" class="HeaderMenu-link border-0 width-full width-lg-auto px-0 px-lg-2 py-lg-2 no-wrap d-flex flex-items-center flex-justify-between js-details-target" aria-expanded="false">
        Resources
        <svg opacity="0.5" aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-chevron-down HeaderMenu-icon ml-1">
    <path d="M12.78 5.22a.749.749 0 0 1 0 1.06l-4.25 4.25a.749.749 0 0 1-1.06 0L3.22 6.28a.749.749 0 1 1 1.06-1.06L8 8.939l3.72-3.719a.749.749 0 0 1 1.06 0Z"></path>
</svg>
      </button>

      <div class="HeaderMenu-dropdown dropdown-menu rounded m-0 p-0 pt-2 pt-lg-4 position-relative position-lg-absolute left-0 left-lg-n3 pb-2 pb-lg-4 dropdown-menu-wide">
        <div class="d-lg-flex dropdown-menu-wide">
            <div class="HeaderMenu-column px-lg-4 pb-3 pb-lg-0 border-lg-right">
                <div class="border-bottom border-lg-bottom-0 pb-lg-0 pb-3">

                      <span class="d-block h4 color-fg-default my-1" id="resources-topics-heading">Topics</span>

                  <ul class="list-style-none f5" aria-labelledby="resources-topics-heading">
                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;ai&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;ai_link_resources_navbar&quot;}" href="/resources/articles?topic=ai">
      AI

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;devops&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;devops_link_resources_navbar&quot;}" href="/resources/articles?topic=devops">
      DevOps

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;security&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;security_link_resources_navbar&quot;}" href="/resources/articles?topic=security">
      Security

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;software_development&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;software_development_link_resources_navbar&quot;}" href="/resources/articles?topic=software-development">
      Software Development

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;view_all&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;view_all_link_resources_navbar&quot;}" href="/resources/articles">
      View all

    
</a></li>

                  </ul>
                </div>
            </div>
            <div class="HeaderMenu-column px-lg-4">
                <div class="border-bottom border-lg-bottom-0 pb-lg-0 border-bottom-0">

                      <span class="d-block h4 color-fg-default my-1" id="resources-explore-heading">Explore</span>

                  <ul class="list-style-none f5" aria-labelledby="resources-explore-heading">
                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary Link--external" target="_blank" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;learning_pathways&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;learning_pathways_link_resources_navbar&quot;}" href="https://resources.github.com/learn/pathways">
      Learning Pathways

    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-link-external HeaderMenu-external-icon color-fg-subtle">
    <path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path>
</svg>
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;events_amp_webinars&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;events_amp_webinars_link_resources_navbar&quot;}" href="https://github.com/resources/events">
      Events &amp; Webinars

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;ebooks_amp_whitepapers&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;ebooks_amp_whitepapers_link_resources_navbar&quot;}" href="https://github.com/resources/whitepapers">
      Ebooks &amp; Whitepapers

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;customer_stories&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;customer_stories_link_resources_navbar&quot;}" href="https://github.com/customer-stories">
      Customer Stories

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;partners&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;partners_link_resources_navbar&quot;}" href="https://github.com/partners">
      Partners

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;executive_insights&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;executive_insights_link_resources_navbar&quot;}" href="https://github.com/solutions/executive-insights">
      Executive Insights

    
</a></li>

                  </ul>
                </div>
            </div>
        </div>

      </div>
</li>


                <li class="HeaderMenu-item position-relative flex-wrap flex-justify-between flex-items-center d-block d-lg-flex flex-lg-nowrap flex-lg-items-center js-details-container js-header-menu-item">
      <button type="button" class="HeaderMenu-link border-0 width-full width-lg-auto px-0 px-lg-2 py-lg-2 no-wrap d-flex flex-items-center flex-justify-between js-details-target" aria-expanded="false">
        Open Source
        <svg opacity="0.5" aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-chevron-down HeaderMenu-icon ml-1">
    <path d="M12.78 5.22a.749.749 0 0 1 0 1.06l-4.25 4.25a.749.749 0 0 1-1.06 0L3.22 6.28a.749.749 0 1 1 1.06-1.06L8 8.939l3.72-3.719a.749.749 0 0 1 1.06 0Z"></path>
</svg>
      </button>

      <div class="HeaderMenu-dropdown dropdown-menu rounded m-0 p-0 pt-2 pt-lg-4 position-relative position-lg-absolute left-0 left-lg-n3 pb-2 pb-lg-4">
        <div class="d-lg-flex dropdown-menu-wide">
            <div class="HeaderMenu-column px-lg-4">
                <div class="border-bottom mb-3 mb-lg-3 pb-3">

                  <ul class="list-style-none f5" >
                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;github_sponsors&quot;,&quot;context&quot;:&quot;open_source&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;github_sponsors_link_open_source_navbar&quot;}" href="/sponsors">
      
      <div>
        <div class="color-fg-default h4">
          GitHub Sponsors

        </div>

        Fund open source developers
      </div>

    
</a></li>

                  </ul>
                </div>
                <div class="border-bottom mb-3 mb-lg-3 pb-3">

                  <ul class="list-style-none f5" >
                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;the_readme_project&quot;,&quot;context&quot;:&quot;open_source&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;the_readme_project_link_open_source_navbar&quot;}" href="https://github.com/readme">
      
      <div>
        <div class="color-fg-default h4">
          The ReadME Project

        </div>

        GitHub community articles
      </div>

    
</a></li>

                  </ul>
                </div>
                <div class="border-bottom border-bottom-0">

                      <span class="d-block h4 color-fg-default my-1" id="open-source-repositories-heading">Repositories</span>

                  <ul class="list-style-none f5" aria-labelledby="open-source-repositories-heading">
                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;topics&quot;,&quot;context&quot;:&quot;open_source&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;topics_link_open_source_navbar&quot;}" href="https://github.com/topics">
      Topics

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;trending&quot;,&quot;context&quot;:&quot;open_source&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;trending_link_open_source_navbar&quot;}" href="https://github.com/trending">
      Trending

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;collections&quot;,&quot;context&quot;:&quot;open_source&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;collections_link_open_source_navbar&quot;}" href="https://github.com/collections">
      Collections

    
</a></li>

                  </ul>
                </div>
            </div>
        </div>

      </div>
</li>


                <li class="HeaderMenu-item position-relative flex-wrap flex-justify-between flex-items-center d-block d-lg-flex flex-lg-nowrap flex-lg-items-center js-details-container js-header-menu-item">
      <button type="button" class="HeaderMenu-link border-0 width-full width-lg-auto px-0 px-lg-2 py-lg-2 no-wrap d-flex flex-items-center flex-justify-between js-details-target" aria-expanded="false">
        Enterprise
        <svg opacity="0.5" aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-chevron-down HeaderMenu-icon ml-1">
    <path d="M12.78 5.22a.749.749 0 0 1 0 1.06l-4.25 4.25a.749.749 0 0 1-1.06 0L3.22 6.28a.749.749 0 1 1 1.06-1.06L8 8.939l3.72-3.719a.749.749 0 0 1 1.06 0Z"></path>
</svg>
      </button>

      <div class="HeaderMenu-dropdown dropdown-menu rounded m-0 p-0 pt-2 pt-lg-4 position-relative position-lg-absolute left-0 left-lg-n3 pb-2 pb-lg-4">
        <div class="d-lg-flex dropdown-menu-wide">
            <div class="HeaderMenu-column px-lg-4">
                <div class="border-bottom mb-3 mb-lg-3 pb-3">

                  <ul class="list-style-none f5" >
                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;enterprise_platform&quot;,&quot;context&quot;:&quot;enterprise&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;enterprise_platform_link_enterprise_navbar&quot;}" href="/enterprise">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-stack color-fg-subtle mr-3">
    <path d="M11.063 1.456a1.749 1.749 0 0 1 1.874 0l8.383 5.316a1.751 1.751 0 0 1 0 2.956l-8.383 5.316a1.749 1.749 0 0 1-1.874 0L2.68 9.728a1.751 1.751 0 0 1 0-2.956Zm1.071 1.267a.25.25 0 0 0-.268 0L3.483 8.039a.25.25 0 0 0 0 .422l8.383 5.316a.25.25 0 0 0 .268 0l8.383-5.316a.25.25 0 0 0 0-.422Z"></path><path d="M1.867 12.324a.75.75 0 0 1 1.035-.232l8.964 5.685a.25.25 0 0 0 .268 0l8.964-5.685a.75.75 0 0 1 .804 1.267l-8.965 5.685a1.749 1.749 0 0 1-1.874 0l-8.965-5.685a.75.75 0 0 1-.231-1.035Z"></path><path d="M1.867 16.324a.75.75 0 0 1 1.035-.232l8.964 5.685a.25.25 0 0 0 .268 0l8.964-5.685a.75.75 0 0 1 .804 1.267l-8.965 5.685a1.749 1.749 0 0 1-1.874 0l-8.965-5.685a.75.75 0 0 1-.231-1.035Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">
          Enterprise platform

        </div>

        AI-powered developer platform
      </div>

    
</a></li>

                  </ul>
                </div>
                <div class="border-bottom border-bottom-0">

                      <span class="d-block h4 color-fg-default my-1" id="enterprise-available-add-ons-heading">Available add-ons</span>

                  <ul class="list-style-none f5" aria-labelledby="enterprise-available-add-ons-heading">
                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description mb-lg-3" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;github_advanced_security&quot;,&quot;context&quot;:&quot;enterprise&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;github_advanced_security_link_enterprise_navbar&quot;}" href="https://github.com/security/advanced-security">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-shield-check color-fg-subtle mr-3">
    <path d="M16.53 9.78a.75.75 0 0 0-1.06-1.06L11 13.19l-1.97-1.97a.75.75 0 0 0-1.06 1.06l2.5 2.5a.75.75 0 0 0 1.06 0l5-5Z"></path><path d="m12.54.637 8.25 2.675A1.75 1.75 0 0 1 22 4.976V10c0 6.19-3.771 10.704-9.401 12.83a1.704 1.704 0 0 1-1.198 0C5.77 20.705 2 16.19 2 10V4.976c0-.758.489-1.43 1.21-1.664L11.46.637a1.748 1.748 0 0 1 1.08 0Zm-.617 1.426-8.25 2.676a.249.249 0 0 0-.173.237V10c0 5.46 3.28 9.483 8.43 11.426a.199.199 0 0 0 .14 0C17.22 19.483 20.5 15.461 20.5 10V4.976a.25.25 0 0 0-.173-.237l-8.25-2.676a.253.253 0 0 0-.154 0Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">
          GitHub Advanced Security

        </div>

        Enterprise-grade security features
      </div>

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description mb-lg-3" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;copilot_for_business&quot;,&quot;context&quot;:&quot;enterprise&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;copilot_for_business_link_enterprise_navbar&quot;}" href="/features/copilot/copilot-business">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-copilot color-fg-subtle mr-3">
    <path d="M23.922 16.992c-.861 1.495-5.859 5.023-11.922 5.023-6.063 0-11.061-3.528-11.922-5.023A.641.641 0 0 1 0 16.736v-2.869a.841.841 0 0 1 .053-.22c.372-.935 1.347-2.292 2.605-2.656.167-.429.414-1.055.644-1.517a10.195 10.195 0 0 1-.052-1.086c0-1.331.282-2.499 1.132-3.368.397-.406.89-.717 1.474-.952 1.399-1.136 3.392-2.093 6.122-2.093 2.731 0 4.767.957 6.166 2.093.584.235 1.077.546 1.474.952.85.869 1.132 2.037 1.132 3.368 0 .368-.014.733-.052 1.086.23.462.477 1.088.644 1.517 1.258.364 2.233 1.721 2.605 2.656a.832.832 0 0 1 .053.22v2.869a.641.641 0 0 1-.078.256ZM12.172 11h-.344a4.323 4.323 0 0 1-.355.508C10.703 12.455 9.555 13 7.965 13c-1.725 0-2.989-.359-3.782-1.259a2.005 2.005 0 0 1-.085-.104L4 11.741v6.585c1.435.779 4.514 2.179 8 2.179 3.486 0 6.565-1.4 8-2.179v-6.585l-.098-.104s-.033.045-.085.104c-.793.9-2.057 1.259-3.782 1.259-1.59 0-2.738-.545-3.508-1.492a4.323 4.323 0 0 1-.355-.508h-.016.016Zm.641-2.935c.136 1.057.403 1.913.878 2.497.442.544 1.134.938 2.344.938 1.573 0 2.292-.337 2.657-.751.384-.435.558-1.15.558-2.361 0-1.14-.243-1.847-.705-2.319-.477-.488-1.319-.862-2.824-1.025-1.487-.161-2.192.138-2.533.529-.269.307-.437.808-.438 1.578v.021c0 .265.021.562.063.893Zm-1.626 0c.042-.331.063-.628.063-.894v-.02c-.001-.77-.169-1.271-.438-1.578-.341-.391-1.046-.69-2.533-.529-1.505.163-2.347.537-2.824 1.025-.462.472-.705 1.179-.705 2.319 0 1.211.175 1.926.558 2.361.365.414 1.084.751 2.657.751 1.21 0 1.902-.394 2.344-.938.475-.584.742-1.44.878-2.497Z"></path><path d="M14.5 14.25a1 1 0 0 1 1 1v2a1 1 0 0 1-2 0v-2a1 1 0 0 1 1-1Zm-5 0a1 1 0 0 1 1 1v2a1 1 0 0 1-2 0v-2a1 1 0 0 1 1-1Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">
          Copilot for business

        </div>

        Enterprise-grade AI features
      </div>

    
</a></li>

                      <li>
  <a class="HeaderMenu-dropdown-link d-block no-underline position-relative py-2 Link--secondary d-flex flex-items-center Link--has-description" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;premium_support&quot;,&quot;context&quot;:&quot;enterprise&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;premium_support_link_enterprise_navbar&quot;}" href="/premium-support">
      <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-comment-discussion color-fg-subtle mr-3">
    <path d="M1.75 1h12.5c.966 0 1.75.784 1.75 1.75v9.5A1.75 1.75 0 0 1 14.25 14H8.061l-2.574 2.573A1.458 1.458 0 0 1 3 15.543V14H1.75A1.75 1.75 0 0 1 0 12.25v-9.5C0 1.784.784 1 1.75 1ZM1.5 2.75v9.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h6.5a.25.25 0 0 0 .25-.25v-9.5a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25Z"></path><path d="M22.5 8.75a.25.25 0 0 0-.25-.25h-3.5a.75.75 0 0 1 0-1.5h3.5c.966 0 1.75.784 1.75 1.75v9.5A1.75 1.75 0 0 1 22.25 20H21v1.543a1.457 1.457 0 0 1-2.487 1.03L15.939 20H10.75A1.75 1.75 0 0 1 9 18.25v-1.465a.75.75 0 0 1 1.5 0v1.465c0 .138.112.25.25.25h5.5a.75.75 0 0 1 .53.22l2.72 2.72v-2.19a.75.75 0 0 1 .75-.75h2a.25.25 0 0 0 .25-.25v-9.5Z"></path>
</svg>
      <div>
        <div class="color-fg-default h4">
          Premium Support

        </div>

        Enterprise-grade 24/7 support
      </div>

    
</a></li>

                  </ul>
                </div>
            </div>
        </div>

      </div>
</li>


                <li class="HeaderMenu-item position-relative flex-wrap flex-justify-between flex-items-center d-block d-lg-flex flex-lg-nowrap flex-lg-items-center js-details-container js-header-menu-item">
    <a class="HeaderMenu-link no-underline px-0 px-lg-2 py-3 py-lg-2 d-block d-lg-inline-block" data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;platform&quot;,&quot;context&quot;:&quot;global&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;platform_link_global_navbar&quot;}" href="https://github.com/pricing">Pricing</a>
</li>

            </ul>
          </nav>

        <div class="d-flex flex-column flex-lg-row width-full flex-justify-end flex-lg-items-center text-center mt-3 mt-lg-0 text-lg-left ml-lg-3">
                


<qbsearch-input class="search-input" data-scope="repo:fedi-e2ee/public-key-directory-specification" data-custom-scopes-path="/search/custom_scopes" data-delete-custom-scopes-csrf="PPqQQiUZlTrgQ03Mu9EA3H9yPW2-dsOwQrMmXCV-L3XXFCbDagXgdAlGVX7Xw_PWXrQfIQMuOBN79mwGnOL_pQ" data-max-custom-scopes="10" data-header-redesign-enabled="false" data-initial-value="" data-blackbird-suggestions-path="/search/suggestions" data-jump-to-suggestions-path="/_graphql/GetSuggestedNavigationDestinations" data-current-repository="fedi-e2ee/public-key-directory-specification" data-current-org="fedi-e2ee" data-current-owner="" data-logged-in="false" data-copilot-chat-enabled="false" data-nl-search-enabled="false" data-retain-scroll-position="true">
  <div
    class="search-input-container search-with-dialog position-relative d-flex flex-row flex-items-center mr-4 rounded"
    data-action="click:qbsearch-input#searchInputContainerClicked"
  >
      <button
        type="button"
        class="header-search-button placeholder  input-button form-control d-flex flex-1 flex-self-stretch flex-items-center no-wrap width-full py-0 pl-2 pr-0 text-left border-0 box-shadow-none"
        data-target="qbsearch-input.inputButton"
        aria-label="Search or jump to…"
        aria-haspopup="dialog"
        placeholder="Search or jump to..."
        data-hotkey=s,/
        autocapitalize="off"
        data-analytics-event="{&quot;location&quot;:&quot;navbar&quot;,&quot;action&quot;:&quot;searchbar&quot;,&quot;context&quot;:&quot;global&quot;,&quot;tag&quot;:&quot;input&quot;,&quot;label&quot;:&quot;searchbar_input_global_navbar&quot;}"
        data-action="click:qbsearch-input#handleExpand"
      >
        <div class="mr-2 color-fg-muted">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-search">
    <path d="M10.68 11.74a6 6 0 0 1-7.922-8.982 6 6 0 0 1 8.982 7.922l3.04 3.04a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215ZM11.5 7a4.499 4.499 0 1 0-8.997 0A4.499 4.499 0 0 0 11.5 7Z"></path>
</svg>
        </div>
        <span class="flex-1" data-target="qbsearch-input.inputButtonText">Search or jump to...</span>
          <div class="d-flex" data-target="qbsearch-input.hotkeyIndicator">
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="20" aria-hidden="true" class="mr-1"><path fill="none" stroke="#979A9C" opacity=".4" d="M3.5.5h12c1.7 0 3 1.3 3 3v13c0 1.7-1.3 3-3 3h-12c-1.7 0-3-1.3-3-3v-13c0-1.7 1.3-3 3-3z"></path><path fill="#979A9C" d="M11.8 6L8 15.1h-.9L10.8 6h1z"></path></svg>
          </div>
      </button>

    <input type="hidden" name="type" class="js-site-search-type-field">

    
<div class="Overlay--hidden " data-modal-dialog-overlay>
  <modal-dialog data-action="close:qbsearch-input#handleClose cancel:qbsearch-input#handleClose" data-target="qbsearch-input.searchSuggestionsDialog" role="dialog" id="search-suggestions-dialog" aria-modal="true" aria-labelledby="search-suggestions-dialog-header" data-view-component="true" class="Overlay Overlay--width-large Overlay--height-auto">
      <h1 id="search-suggestions-dialog-header" class="sr-only">Search code, repositories, users, issues, pull requests...</h1>
    <div class="Overlay-body Overlay-body--paddingNone">
      
          <div data-view-component="true">        <div class="search-suggestions position-fixed width-full color-shadow-large border color-fg-default color-bg-default overflow-hidden d-flex flex-column query-builder-container"
          style="border-radius: 12px;"
          data-target="qbsearch-input.queryBuilderContainer"
          hidden
        >
          <!-- '"` --><!-- </textarea></xmp> --></option></form><form id="query-builder-test-form" action="" accept-charset="UTF-8" method="get">
  <query-builder data-target="qbsearch-input.queryBuilder" id="query-builder-query-builder-test" data-filter-key=":" data-view-component="true" class="QueryBuilder search-query-builder">
    <div class="FormControl FormControl--fullWidth">
      <label id="query-builder-test-label" for="query-builder-test" class="FormControl-label sr-only">
        Search
      </label>
      <div
        class="QueryBuilder-StyledInput width-fit "
        data-target="query-builder.styledInput"
      >
          <span id="query-builder-test-leadingvisual-wrap" class="FormControl-input-leadingVisualWrap QueryBuilder-leadingVisualWrap">
            <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-search FormControl-input-leadingVisual">
    <path d="M10.68 11.74a6 6 0 0 1-7.922-8.982 6 6 0 0 1 8.982 7.922l3.04 3.04a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215ZM11.5 7a4.499 4.499 0 1 0-8.997 0A4.499 4.499 0 0 0 11.5 7Z"></path>
</svg>
          </span>
        <div data-target="query-builder.styledInputContainer" class="QueryBuilder-StyledInputContainer">
          <div
            aria-hidden="true"
            class="QueryBuilder-StyledInputContent"
            data-target="query-builder.styledInputContent"
          ></div>
          <div class="QueryBuilder-InputWrapper">
            <div aria-hidden="true" class="QueryBuilder-Sizer" data-target="query-builder.sizer"></div>
            <input id="query-builder-test" name="query-builder-test" value="" autocomplete="off" type="text" role="combobox" spellcheck="false" aria-expanded="false" aria-describedby="validation-8a5bbcad-7162-4ddd-9be0-640ad7b16441" data-target="query-builder.input" data-action="
          input:query-builder#inputChange
          blur:query-builder#inputBlur
          keydown:query-builder#inputKeydown
          focus:query-builder#inputFocus
        " data-view-component="true" class="FormControl-input QueryBuilder-Input FormControl-medium" />
          </div>
        </div>
          <span class="sr-only" id="query-builder-test-clear">Clear</span>
          <button role="button" id="query-builder-test-clear-button" aria-labelledby="query-builder-test-clear query-builder-test-label" data-target="query-builder.clearButton" data-action="
                click:query-builder#clear
                focus:query-builder#clearButtonFocus
                blur:query-builder#clearButtonBlur
              " variant="small" hidden="hidden" type="button" data-view-component="true" class="Button Button--iconOnly Button--invisible Button--medium mr-1 px-2 py-0 d-flex flex-items-center rounded-1 color-fg-muted">  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x-circle-fill Button-visual">
    <path d="M2.343 13.657A8 8 0 1 1 13.658 2.343 8 8 0 0 1 2.343 13.657ZM6.03 4.97a.751.751 0 0 0-1.042.018.751.751 0 0 0-.018 1.042L6.94 8 4.97 9.97a.749.749 0 0 0 .326 1.275.749.749 0 0 0 .734-.215L8 9.06l1.97 1.97a.749.749 0 0 0 1.275-.326.749.749 0 0 0-.215-.734L9.06 8l1.97-1.97a.749.749 0 0 0-.326-1.275.749.749 0 0 0-.734.215L8 6.94Z"></path>
</svg>
</button>

      </div>
      <template id="search-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-search">
    <path d="M10.68 11.74a6 6 0 0 1-7.922-8.982 6 6 0 0 1 8.982 7.922l3.04 3.04a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215ZM11.5 7a4.499 4.499 0 1 0-8.997 0A4.499 4.499 0 0 0 11.5 7Z"></path>
</svg>
</template>

<template id="code-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-code">
    <path d="m11.28 3.22 4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734L13.94 8l-3.72-3.72a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215Zm-6.56 0a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042L2.06 8l3.72 3.72a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L.47 8.53a.75.75 0 0 1 0-1.06Z"></path>
</svg>
</template>

<template id="file-code-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-file-code">
    <path d="M4 1.75C4 .784 4.784 0 5.75 0h5.586c.464 0 .909.184 1.237.513l2.914 2.914c.329.328.513.773.513 1.237v8.586A1.75 1.75 0 0 1 14.25 15h-9a.75.75 0 0 1 0-1.5h9a.25.25 0 0 0 .25-.25V6h-2.75A1.75 1.75 0 0 1 10 4.25V1.5H5.75a.25.25 0 0 0-.25.25v2.5a.75.75 0 0 1-1.5 0Zm1.72 4.97a.75.75 0 0 1 1.06 0l2 2a.75.75 0 0 1 0 1.06l-2 2a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734l1.47-1.47-1.47-1.47a.75.75 0 0 1 0-1.06ZM3.28 7.78 1.81 9.25l1.47 1.47a.751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018l-2-2a.75.75 0 0 1 0-1.06l2-2a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042Zm8.22-6.218V4.25c0 .138.112.25.25.25h2.688l-.011-.013-2.914-2.914-.013-.011Z"></path>
</svg>
</template>

<template id="history-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-history">
    <path d="m.427 1.927 1.215 1.215a8.002 8.002 0 1 1-1.6 5.685.75.75 0 1 1 1.493-.154 6.5 6.5 0 1 0 1.18-4.458l1.358 1.358A.25.25 0 0 1 3.896 6H.25A.25.25 0 0 1 0 5.75V2.104a.25.25 0 0 1 .427-.177ZM7.75 4a.75.75 0 0 1 .75.75v2.992l2.028.812a.75.75 0 0 1-.557 1.392l-2.5-1A.751.751 0 0 1 7 8.25v-3.5A.75.75 0 0 1 7.75 4Z"></path>
</svg>
</template>

<template id="repo-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-repo">
    <path d="M2 2.5A2.5 2.5 0 0 1 4.5 0h8.75a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h1.75v-2h-8a1 1 0 0 0-.714 1.7.75.75 0 1 1-1.072 1.05A2.495 2.495 0 0 1 2 11.5Zm10.5-1h-8a1 1 0 0 0-1 1v6.708A2.486 2.486 0 0 1 4.5 9h8ZM5 12.25a.25.25 0 0 1 .25-.25h3.5a.25.25 0 0 1 .25.25v3.25a.25.25 0 0 1-.4.2l-1.45-1.087a.249.249 0 0 0-.3 0L5.4 15.7a.25.25 0 0 1-.4-.2Z"></path>
</svg>
</template>

<template id="bookmark-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-bookmark">
    <path d="M3 2.75C3 1.784 3.784 1 4.75 1h6.5c.966 0 1.75.784 1.75 1.75v11.5a.75.75 0 0 1-1.227.579L8 11.722l-3.773 3.107A.751.751 0 0 1 3 14.25Zm1.75-.25a.25.25 0 0 0-.25.25v9.91l3.023-2.489a.75.75 0 0 1 .954 0l3.023 2.49V2.75a.25.25 0 0 0-.25-.25Z"></path>
</svg>
</template>

<template id="plus-circle-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-plus-circle">
    <path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Zm7.25-3.25v2.5h2.5a.75.75 0 0 1 0 1.5h-2.5v2.5a.75.75 0 0 1-1.5 0v-2.5h-2.5a.75.75 0 0 1 0-1.5h2.5v-2.5a.75.75 0 0 1 1.5 0Z"></path>
</svg>
</template>

<template id="circle-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-dot-fill">
    <path d="M8 4a4 4 0 1 1 0 8 4 4 0 0 1 0-8Z"></path>
</svg>
</template>

<template id="trash-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-trash">
    <path d="M11 1.75V3h2.25a.75.75 0 0 1 0 1.5H2.75a.75.75 0 0 1 0-1.5H5V1.75C5 .784 5.784 0 6.75 0h2.5C10.216 0 11 .784 11 1.75ZM4.496 6.675l.66 6.6a.25.25 0 0 0 .249.225h5.19a.25.25 0 0 0 .249-.225l.66-6.6a.75.75 0 0 1 1.492.149l-.66 6.6A1.748 1.748 0 0 1 10.595 15h-5.19a1.75 1.75 0 0 1-1.741-1.575l-.66-6.6a.75.75 0 1 1 1.492-.15ZM6.5 1.75V3h3V1.75a.25.25 0 0 0-.25-.25h-2.5a.25.25 0 0 0-.25.25Z"></path>
</svg>
</template>

<template id="team-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-people">
    <path d="M2 5.5a3.5 3.5 0 1 1 5.898 2.549 5.508 5.508 0 0 1 3.034 4.084.75.75 0 1 1-1.482.235 4 4 0 0 0-7.9 0 .75.75 0 0 1-1.482-.236A5.507 5.507 0 0 1 3.102 8.05 3.493 3.493 0 0 1 2 5.5ZM11 4a3.001 3.001 0 0 1 2.22 5.018 5.01 5.01 0 0 1 2.56 3.012.749.749 0 0 1-.885.954.752.752 0 0 1-.549-.514 3.507 3.507 0 0 0-2.522-2.372.75.75 0 0 1-.574-.73v-.352a.75.75 0 0 1 .416-.672A1.5 1.5 0 0 0 11 5.5.75.75 0 0 1 11 4Zm-5.5-.5a2 2 0 1 0-.001 3.999A2 2 0 0 0 5.5 3.5Z"></path>
</svg>
</template>

<template id="project-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-project">
    <path d="M1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25V1.75C0 .784.784 0 1.75 0ZM1.5 1.75v12.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25V1.75a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25ZM11.75 3a.75.75 0 0 1 .75.75v7.5a.75.75 0 0 1-1.5 0v-7.5a.75.75 0 0 1 .75-.75Zm-8.25.75a.75.75 0 0 1 1.5 0v5.5a.75.75 0 0 1-1.5 0ZM8 3a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5A.75.75 0 0 1 8 3Z"></path>
</svg>
</template>

<template id="pencil-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-pencil">
    <path d="M11.013 1.427a1.75 1.75 0 0 1 2.474 0l1.086 1.086a1.75 1.75 0 0 1 0 2.474l-8.61 8.61c-.21.21-.47.364-.756.445l-3.251.93a.75.75 0 0 1-.927-.928l.929-3.25c.081-.286.235-.547.445-.758l8.61-8.61Zm.176 4.823L9.75 4.81l-6.286 6.287a.253.253 0 0 0-.064.108l-.558 1.953 1.953-.558a.253.253 0 0 0 .108-.064Zm1.238-3.763a.25.25 0 0 0-.354 0L10.811 3.75l1.439 1.44 1.263-1.263a.25.25 0 0 0 0-.354Z"></path>
</svg>
</template>

<template id="copilot-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copilot">
    <path d="M7.998 15.035c-4.562 0-7.873-2.914-7.998-3.749V9.338c.085-.628.677-1.686 1.588-2.065.013-.07.024-.143.036-.218.029-.183.06-.384.126-.612-.201-.508-.254-1.084-.254-1.656 0-.87.128-1.769.693-2.484.579-.733 1.494-1.124 2.724-1.261 1.206-.134 2.262.034 2.944.765.05.053.096.108.139.165.044-.057.094-.112.143-.165.682-.731 1.738-.899 2.944-.765 1.23.137 2.145.528 2.724 1.261.566.715.693 1.614.693 2.484 0 .572-.053 1.148-.254 1.656.066.228.098.429.126.612.012.076.024.148.037.218.924.385 1.522 1.471 1.591 2.095v1.872c0 .766-3.351 3.795-8.002 3.795Zm0-1.485c2.28 0 4.584-1.11 5.002-1.433V7.862l-.023-.116c-.49.21-1.075.291-1.727.291-1.146 0-2.059-.327-2.71-.991A3.222 3.222 0 0 1 8 6.303a3.24 3.24 0 0 1-.544.743c-.65.664-1.563.991-2.71.991-.652 0-1.236-.081-1.727-.291l-.023.116v4.255c.419.323 2.722 1.433 5.002 1.433ZM6.762 2.83c-.193-.206-.637-.413-1.682-.297-1.019.113-1.479.404-1.713.7-.247.312-.369.789-.369 1.554 0 .793.129 1.171.308 1.371.162.181.519.379 1.442.379.853 0 1.339-.235 1.638-.54.315-.322.527-.827.617-1.553.117-.935-.037-1.395-.241-1.614Zm4.155-.297c-1.044-.116-1.488.091-1.681.297-.204.219-.359.679-.242 1.614.091.726.303 1.231.618 1.553.299.305.784.54 1.638.54.922 0 1.28-.198 1.442-.379.179-.2.308-.578.308-1.371 0-.765-.123-1.242-.37-1.554-.233-.296-.693-.587-1.713-.7Z"></path><path d="M6.25 9.037a.75.75 0 0 1 .75.75v1.501a.75.75 0 0 1-1.5 0V9.787a.75.75 0 0 1 .75-.75Zm4.25.75v1.501a.75.75 0 0 1-1.5 0V9.787a.75.75 0 0 1 1.5 0Z"></path>
</svg>
</template>

<template id="copilot-error-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copilot-error">
    <path d="M16 11.24c0 .112-.072.274-.21.467L13 9.688V7.862l-.023-.116c-.49.21-1.075.291-1.727.291-.198 0-.388-.009-.571-.029L6.833 5.226a4.01 4.01 0 0 0 .17-.782c.117-.935-.037-1.395-.241-1.614-.193-.206-.637-.413-1.682-.297-.683.076-1.115.231-1.395.415l-1.257-.91c.579-.564 1.413-.877 2.485-.996 1.206-.134 2.262.034 2.944.765.05.053.096.108.139.165.044-.057.094-.112.143-.165.682-.731 1.738-.899 2.944-.765 1.23.137 2.145.528 2.724 1.261.566.715.693 1.614.693 2.484 0 .572-.053 1.148-.254 1.656.066.228.098.429.126.612.012.076.024.148.037.218.924.385 1.522 1.471 1.591 2.095Zm-5.083-8.707c-1.044-.116-1.488.091-1.681.297-.204.219-.359.679-.242 1.614.091.726.303 1.231.618 1.553.299.305.784.54 1.638.54.922 0 1.28-.198 1.442-.379.179-.2.308-.578.308-1.371 0-.765-.123-1.242-.37-1.554-.233-.296-.693-.587-1.713-.7Zm2.511 11.074c-1.393.776-3.272 1.428-5.43 1.428-4.562 0-7.873-2.914-7.998-3.749V9.338c.085-.628.677-1.686 1.588-2.065.013-.07.024-.143.036-.218.029-.183.06-.384.126-.612-.18-.455-.241-.963-.252-1.475L.31 4.107A.747.747 0 0 1 0 3.509V3.49a.748.748 0 0 1 .625-.73c.156-.026.306.047.435.139l14.667 10.578a.592.592 0 0 1 .227.264.752.752 0 0 1 .046.249v.022a.75.75 0 0 1-1.19.596Zm-1.367-.991L5.635 7.964a5.128 5.128 0 0 1-.889.073c-.652 0-1.236-.081-1.727-.291l-.023.116v4.255c.419.323 2.722 1.433 5.002 1.433 1.539 0 3.089-.505 4.063-.934Z"></path>
</svg>
</template>

<template id="workflow-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-workflow">
    <path d="M0 1.75C0 .784.784 0 1.75 0h3.5C6.216 0 7 .784 7 1.75v3.5A1.75 1.75 0 0 1 5.25 7H4v4a1 1 0 0 0 1 1h4v-1.25C9 9.784 9.784 9 10.75 9h3.5c.966 0 1.75.784 1.75 1.75v3.5A1.75 1.75 0 0 1 14.25 16h-3.5A1.75 1.75 0 0 1 9 14.25v-.75H5A2.5 2.5 0 0 1 2.5 11V7h-.75A1.75 1.75 0 0 1 0 5.25Zm1.75-.25a.25.25 0 0 0-.25.25v3.5c0 .138.112.25.25.25h3.5a.25.25 0 0 0 .25-.25v-3.5a.25.25 0 0 0-.25-.25Zm9 9a.25.25 0 0 0-.25.25v3.5c0 .138.112.25.25.25h3.5a.25.25 0 0 0 .25-.25v-3.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
</template>

<template id="book-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-book">
    <path d="M0 1.75A.75.75 0 0 1 .75 1h4.253c1.227 0 2.317.59 3 1.501A3.743 3.743 0 0 1 11.006 1h4.245a.75.75 0 0 1 .75.75v10.5a.75.75 0 0 1-.75.75h-4.507a2.25 2.25 0 0 0-1.591.659l-.622.621a.75.75 0 0 1-1.06 0l-.622-.621A2.25 2.25 0 0 0 5.258 13H.75a.75.75 0 0 1-.75-.75Zm7.251 10.324.004-5.073-.002-2.253A2.25 2.25 0 0 0 5.003 2.5H1.5v9h3.757a3.75 3.75 0 0 1 1.994.574ZM8.755 4.75l-.004 7.322a3.752 3.752 0 0 1 1.992-.572H14.5v-9h-3.495a2.25 2.25 0 0 0-2.25 2.25Z"></path>
</svg>
</template>

<template id="code-review-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-code-review">
    <path d="M1.75 1h12.5c.966 0 1.75.784 1.75 1.75v8.5A1.75 1.75 0 0 1 14.25 13H8.061l-2.574 2.573A1.458 1.458 0 0 1 3 14.543V13H1.75A1.75 1.75 0 0 1 0 11.25v-8.5C0 1.784.784 1 1.75 1ZM1.5 2.75v8.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h6.5a.25.25 0 0 0 .25-.25v-8.5a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25Zm5.28 1.72a.75.75 0 0 1 0 1.06L5.31 7l1.47 1.47a.751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018l-2-2a.75.75 0 0 1 0-1.06l2-2a.75.75 0 0 1 1.06 0Zm2.44 0a.75.75 0 0 1 1.06 0l2 2a.75.75 0 0 1 0 1.06l-2 2a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L10.69 7 9.22 5.53a.75.75 0 0 1 0-1.06Z"></path>
</svg>
</template>

<template id="codespaces-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-codespaces">
    <path d="M0 11.25c0-.966.784-1.75 1.75-1.75h12.5c.966 0 1.75.784 1.75 1.75v3A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25Zm2-9.5C2 .784 2.784 0 3.75 0h8.5C13.216 0 14 .784 14 1.75v5a1.75 1.75 0 0 1-1.75 1.75h-8.5A1.75 1.75 0 0 1 2 6.75Zm1.75-.25a.25.25 0 0 0-.25.25v5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-5a.25.25 0 0 0-.25-.25Zm-2 9.5a.25.25 0 0 0-.25.25v3c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25v-3a.25.25 0 0 0-.25-.25Z"></path><path d="M7 12.75a.75.75 0 0 1 .75-.75h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1-.75-.75Zm-4 0a.75.75 0 0 1 .75-.75h.5a.75.75 0 0 1 0 1.5h-.5a.75.75 0 0 1-.75-.75Z"></path>
</svg>
</template>

<template id="comment-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-comment">
    <path d="M1 2.75C1 1.784 1.784 1 2.75 1h10.5c.966 0 1.75.784 1.75 1.75v7.5A1.75 1.75 0 0 1 13.25 12H9.06l-2.573 2.573A1.458 1.458 0 0 1 4 13.543V12H2.75A1.75 1.75 0 0 1 1 10.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h4.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
</template>

<template id="comment-discussion-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-comment-discussion">
    <path d="M1.75 1h8.5c.966 0 1.75.784 1.75 1.75v5.5A1.75 1.75 0 0 1 10.25 10H7.061l-2.574 2.573A1.458 1.458 0 0 1 2 11.543V10h-.25A1.75 1.75 0 0 1 0 8.25v-5.5C0 1.784.784 1 1.75 1ZM1.5 2.75v5.5c0 .138.112.25.25.25h1a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h3.5a.25.25 0 0 0 .25-.25v-5.5a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25Zm13 2a.25.25 0 0 0-.25-.25h-.5a.75.75 0 0 1 0-1.5h.5c.966 0 1.75.784 1.75 1.75v5.5A1.75 1.75 0 0 1 14.25 12H14v1.543a1.458 1.458 0 0 1-2.487 1.03L9.22 12.28a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215l2.22 2.22v-2.19a.75.75 0 0 1 .75-.75h1a.25.25 0 0 0 .25-.25Z"></path>
</svg>
</template>

<template id="organization-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-organization">
    <path d="M1.75 16A1.75 1.75 0 0 1 0 14.25V1.75C0 .784.784 0 1.75 0h8.5C11.216 0 12 .784 12 1.75v12.5c0 .085-.006.168-.018.25h2.268a.25.25 0 0 0 .25-.25V8.285a.25.25 0 0 0-.111-.208l-1.055-.703a.749.749 0 1 1 .832-1.248l1.055.703c.487.325.779.871.779 1.456v5.965A1.75 1.75 0 0 1 14.25 16h-3.5a.766.766 0 0 1-.197-.026c-.099.017-.2.026-.303.026h-3a.75.75 0 0 1-.75-.75V14h-1v1.25a.75.75 0 0 1-.75.75Zm-.25-1.75c0 .138.112.25.25.25H4v-1.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 .75.75v1.25h2.25a.25.25 0 0 0 .25-.25V1.75a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25ZM3.75 6h.5a.75.75 0 0 1 0 1.5h-.5a.75.75 0 0 1 0-1.5ZM3 3.75A.75.75 0 0 1 3.75 3h.5a.75.75 0 0 1 0 1.5h-.5A.75.75 0 0 1 3 3.75Zm4 3A.75.75 0 0 1 7.75 6h.5a.75.75 0 0 1 0 1.5h-.5A.75.75 0 0 1 7 6.75ZM7.75 3h.5a.75.75 0 0 1 0 1.5h-.5a.75.75 0 0 1 0-1.5ZM3 9.75A.75.75 0 0 1 3.75 9h.5a.75.75 0 0 1 0 1.5h-.5A.75.75 0 0 1 3 9.75ZM7.75 9h.5a.75.75 0 0 1 0 1.5h-.5a.75.75 0 0 1 0-1.5Z"></path>
</svg>
</template>

<template id="rocket-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-rocket">
    <path d="M14.064 0h.186C15.216 0 16 .784 16 1.75v.186a8.752 8.752 0 0 1-2.564 6.186l-.458.459c-.314.314-.641.616-.979.904v3.207c0 .608-.315 1.172-.833 1.49l-2.774 1.707a.749.749 0 0 1-1.11-.418l-.954-3.102a1.214 1.214 0 0 1-.145-.125L3.754 9.816a1.218 1.218 0 0 1-.124-.145L.528 8.717a.749.749 0 0 1-.418-1.11l1.71-2.774A1.748 1.748 0 0 1 3.31 4h3.204c.288-.338.59-.665.904-.979l.459-.458A8.749 8.749 0 0 1 14.064 0ZM8.938 3.623h-.002l-.458.458c-.76.76-1.437 1.598-2.02 2.5l-1.5 2.317 2.143 2.143 2.317-1.5c.902-.583 1.74-1.26 2.499-2.02l.459-.458a7.25 7.25 0 0 0 2.123-5.127V1.75a.25.25 0 0 0-.25-.25h-.186a7.249 7.249 0 0 0-5.125 2.123ZM3.56 14.56c-.732.732-2.334 1.045-3.005 1.148a.234.234 0 0 1-.201-.064.234.234 0 0 1-.064-.201c.103-.671.416-2.273 1.15-3.003a1.502 1.502 0 1 1 2.12 2.12Zm6.94-3.935c-.088.06-.177.118-.266.175l-2.35 1.521.548 1.783 1.949-1.2a.25.25 0 0 0 .119-.213ZM3.678 8.116 5.2 5.766c.058-.09.117-.178.176-.266H3.309a.25.25 0 0 0-.213.119l-1.2 1.95ZM12 5a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
</template>

<template id="shield-check-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-shield-check">
    <path d="m8.533.133 5.25 1.68A1.75 1.75 0 0 1 15 3.48V7c0 1.566-.32 3.182-1.303 4.682-.983 1.498-2.585 2.813-5.032 3.855a1.697 1.697 0 0 1-1.33 0c-2.447-1.042-4.049-2.357-5.032-3.855C1.32 10.182 1 8.566 1 7V3.48a1.75 1.75 0 0 1 1.217-1.667l5.25-1.68a1.748 1.748 0 0 1 1.066 0Zm-.61 1.429.001.001-5.25 1.68a.251.251 0 0 0-.174.237V7c0 1.36.275 2.666 1.057 3.859.784 1.194 2.121 2.342 4.366 3.298a.196.196 0 0 0 .154 0c2.245-.957 3.582-2.103 4.366-3.297C13.225 9.666 13.5 8.358 13.5 7V3.48a.25.25 0 0 0-.174-.238l-5.25-1.68a.25.25 0 0 0-.153 0ZM11.28 6.28l-3.5 3.5a.75.75 0 0 1-1.06 0l-1.5-1.5a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215l.97.97 2.97-2.97a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042Z"></path>
</svg>
</template>

<template id="heart-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-heart">
    <path d="m8 14.25.345.666a.75.75 0 0 1-.69 0l-.008-.004-.018-.01a7.152 7.152 0 0 1-.31-.17 22.055 22.055 0 0 1-3.434-2.414C2.045 10.731 0 8.35 0 5.5 0 2.836 2.086 1 4.25 1 5.797 1 7.153 1.802 8 3.02 8.847 1.802 10.203 1 11.75 1 13.914 1 16 2.836 16 5.5c0 2.85-2.045 5.231-3.885 6.818a22.066 22.066 0 0 1-3.744 2.584l-.018.01-.006.003h-.002ZM4.25 2.5c-1.336 0-2.75 1.164-2.75 3 0 2.15 1.58 4.144 3.365 5.682A20.58 20.58 0 0 0 8 13.393a20.58 20.58 0 0 0 3.135-2.211C12.92 9.644 14.5 7.65 14.5 5.5c0-1.836-1.414-3-2.75-3-1.373 0-2.609.986-3.029 2.456a.749.749 0 0 1-1.442 0C6.859 3.486 5.623 2.5 4.25 2.5Z"></path>
</svg>
</template>

<template id="server-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-server">
    <path d="M1.75 1h12.5c.966 0 1.75.784 1.75 1.75v4c0 .372-.116.717-.314 1 .198.283.314.628.314 1v4a1.75 1.75 0 0 1-1.75 1.75H1.75A1.75 1.75 0 0 1 0 12.75v-4c0-.358.109-.707.314-1a1.739 1.739 0 0 1-.314-1v-4C0 1.784.784 1 1.75 1ZM1.5 2.75v4c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25v-4a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25Zm.25 5.75a.25.25 0 0 0-.25.25v4c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25v-4a.25.25 0 0 0-.25-.25ZM7 4.75A.75.75 0 0 1 7.75 4h4.5a.75.75 0 0 1 0 1.5h-4.5A.75.75 0 0 1 7 4.75ZM7.75 10h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM3 4.75A.75.75 0 0 1 3.75 4h.5a.75.75 0 0 1 0 1.5h-.5A.75.75 0 0 1 3 4.75ZM3.75 10h.5a.75.75 0 0 1 0 1.5h-.5a.75.75 0 0 1 0-1.5Z"></path>
</svg>
</template>

<template id="globe-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-globe">
    <path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM5.78 8.75a9.64 9.64 0 0 0 1.363 4.177c.255.426.542.832.857 1.215.245-.296.551-.705.857-1.215A9.64 9.64 0 0 0 10.22 8.75Zm4.44-1.5a9.64 9.64 0 0 0-1.363-4.177c-.307-.51-.612-.919-.857-1.215a9.927 9.927 0 0 0-.857 1.215A9.64 9.64 0 0 0 5.78 7.25Zm-5.944 1.5H1.543a6.507 6.507 0 0 0 4.666 5.5c-.123-.181-.24-.365-.352-.552-.715-1.192-1.437-2.874-1.581-4.948Zm-2.733-1.5h2.733c.144-2.074.866-3.756 1.58-4.948.12-.197.237-.381.353-.552a6.507 6.507 0 0 0-4.666 5.5Zm10.181 1.5c-.144 2.074-.866 3.756-1.58 4.948-.12.197-.237.381-.353.552a6.507 6.507 0 0 0 4.666-5.5Zm2.733-1.5a6.507 6.507 0 0 0-4.666-5.5c.123.181.24.365.353.552.714 1.192 1.436 2.874 1.58 4.948Z"></path>
</svg>
</template>

<template id="issue-opened-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-issue-opened">
    <path d="M8 9.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path><path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Z"></path>
</svg>
</template>

<template id="device-mobile-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-device-mobile">
    <path d="M3.75 0h8.5C13.216 0 14 .784 14 1.75v12.5A1.75 1.75 0 0 1 12.25 16h-8.5A1.75 1.75 0 0 1 2 14.25V1.75C2 .784 2.784 0 3.75 0ZM3.5 1.75v12.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25V1.75a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25ZM8 13a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path>
</svg>
</template>

<template id="package-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-package">
    <path d="m8.878.392 5.25 3.045c.54.314.872.89.872 1.514v6.098a1.75 1.75 0 0 1-.872 1.514l-5.25 3.045a1.75 1.75 0 0 1-1.756 0l-5.25-3.045A1.75 1.75 0 0 1 1 11.049V4.951c0-.624.332-1.201.872-1.514L7.122.392a1.75 1.75 0 0 1 1.756 0ZM7.875 1.69l-4.63 2.685L8 7.133l4.755-2.758-4.63-2.685a.248.248 0 0 0-.25 0ZM2.5 5.677v5.372c0 .09.047.171.125.216l4.625 2.683V8.432Zm6.25 8.271 4.625-2.683a.25.25 0 0 0 .125-.216V5.677L8.75 8.432Z"></path>
</svg>
</template>

<template id="credit-card-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-credit-card">
    <path d="M10.75 9a.75.75 0 0 0 0 1.5h1.5a.75.75 0 0 0 0-1.5h-1.5Z"></path><path d="M0 3.75C0 2.784.784 2 1.75 2h12.5c.966 0 1.75.784 1.75 1.75v8.5A1.75 1.75 0 0 1 14.25 14H1.75A1.75 1.75 0 0 1 0 12.25ZM14.5 6.5h-13v5.75c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25Zm0-2.75a.25.25 0 0 0-.25-.25H1.75a.25.25 0 0 0-.25.25V5h13Z"></path>
</svg>
</template>

<template id="play-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-play">
    <path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Zm4.879-2.773 4.264 2.559a.25.25 0 0 1 0 .428l-4.264 2.559A.25.25 0 0 1 6 10.559V5.442a.25.25 0 0 1 .379-.215Z"></path>
</svg>
</template>

<template id="gift-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-gift">
    <path d="M2 2.75A2.75 2.75 0 0 1 4.75 0c.983 0 1.873.42 2.57 1.232.268.318.497.668.68 1.042.183-.375.411-.725.68-1.044C9.376.42 10.266 0 11.25 0a2.75 2.75 0 0 1 2.45 4h.55c.966 0 1.75.784 1.75 1.75v2c0 .698-.409 1.301-1 1.582v4.918A1.75 1.75 0 0 1 13.25 16H2.75A1.75 1.75 0 0 1 1 14.25V9.332C.409 9.05 0 8.448 0 7.75v-2C0 4.784.784 4 1.75 4h.55c-.192-.375-.3-.8-.3-1.25ZM7.25 9.5H2.5v4.75c0 .138.112.25.25.25h4.5Zm1.5 0v5h4.5a.25.25 0 0 0 .25-.25V9.5Zm0-4V8h5.5a.25.25 0 0 0 .25-.25v-2a.25.25 0 0 0-.25-.25Zm-7 0a.25.25 0 0 0-.25.25v2c0 .138.112.25.25.25h5.5V5.5h-5.5Zm3-4a1.25 1.25 0 0 0 0 2.5h2.309c-.233-.818-.542-1.401-.878-1.793-.43-.502-.915-.707-1.431-.707ZM8.941 4h2.309a1.25 1.25 0 0 0 0-2.5c-.516 0-1 .205-1.43.707-.337.392-.646.975-.879 1.793Z"></path>
</svg>
</template>

<template id="code-square-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-code-square">
    <path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25Zm1.75-.25a.25.25 0 0 0-.25.25v12.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25V1.75a.25.25 0 0 0-.25-.25Zm7.47 3.97a.75.75 0 0 1 1.06 0l2 2a.75.75 0 0 1 0 1.06l-2 2a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734L10.69 8 9.22 6.53a.75.75 0 0 1 0-1.06ZM6.78 6.53 5.31 8l1.47 1.47a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215l-2-2a.75.75 0 0 1 0-1.06l2-2a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042Z"></path>
</svg>
</template>

<template id="device-desktop-icon">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-device-desktop">
    <path d="M14.25 1c.966 0 1.75.784 1.75 1.75v7.5A1.75 1.75 0 0 1 14.25 12h-3.727c.099 1.041.52 1.872 1.292 2.757A.752.752 0 0 1 11.25 16h-6.5a.75.75 0 0 1-.565-1.243c.772-.885 1.192-1.716 1.292-2.757H1.75A1.75 1.75 0 0 1 0 10.25v-7.5C0 1.784.784 1 1.75 1ZM1.75 2.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h12.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25ZM9.018 12H6.982a5.72 5.72 0 0 1-.765 2.5h3.566a5.72 5.72 0 0 1-.765-2.5Z"></path>
</svg>
</template>

        <div class="position-relative">
                <ul
                  role="listbox"
                  class="ActionListWrap QueryBuilder-ListWrap"
                  aria-label="Suggestions"
                  data-action="
                    combobox-commit:query-builder#comboboxCommit
                    mousedown:query-builder#resultsMousedown
                  "
                  data-target="query-builder.resultsList"
                  data-persist-list=false
                  id="query-builder-test-results"
                  tabindex="-1"
                ></ul>
        </div>
      <div class="FormControl-inlineValidation" id="validation-8a5bbcad-7162-4ddd-9be0-640ad7b16441" hidden="hidden">
        <span class="FormControl-inlineValidation--visual">
          <svg aria-hidden="true" height="12" viewBox="0 0 12 12" version="1.1" width="12" data-view-component="true" class="octicon octicon-alert-fill">
    <path d="M4.855.708c.5-.896 1.79-.896 2.29 0l4.675 8.351a1.312 1.312 0 0 1-1.146 1.954H1.33A1.313 1.313 0 0 1 .183 9.058ZM7 7V3H5v4Zm-1 3a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z"></path>
</svg>
        </span>
        <span></span>
</div>    </div>
    <div data-target="query-builder.screenReaderFeedback" aria-live="polite" aria-atomic="true" class="sr-only"></div>
</query-builder></form>
          <div class="d-flex flex-row color-fg-muted px-3 text-small color-bg-default search-feedback-prompt">
            <a target="_blank" href="https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax" data-view-component="true" class="Link color-fg-accent text-normal ml-2">Search syntax tips</a>            <div class="d-flex flex-1"></div>
          </div>
        </div>
</div>

    </div>
</modal-dialog></div>
  </div>
  <div data-action="click:qbsearch-input#retract" class="dark-backdrop position-fixed" hidden data-target="qbsearch-input.darkBackdrop"></div>
  <div class="color-fg-default">
    
<dialog-helper>
  <dialog data-target="qbsearch-input.feedbackDialog" data-action="close:qbsearch-input#handleDialogClose cancel:qbsearch-input#handleDialogClose" id="feedback-dialog" aria-modal="true" aria-labelledby="feedback-dialog-title" aria-describedby="feedback-dialog-description" data-view-component="true" class="Overlay Overlay-whenNarrow Overlay--size-medium Overlay--motion-scaleFade Overlay--disableScroll">
    <div data-view-component="true" class="Overlay-header">
  <div class="Overlay-headerContentWrap">
    <div class="Overlay-titleWrap">
      <h1 class="Overlay-title " id="feedback-dialog-title">
        Provide feedback
      </h1>
        
    </div>
    <div class="Overlay-actionWrap">
      <button data-close-dialog-id="feedback-dialog" aria-label="Close" aria-label="Close" type="button" data-view-component="true" class="close-button Overlay-closeButton"><svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg></button>
    </div>
  </div>
  
</div>
      <scrollable-region data-labelled-by="feedback-dialog-title">
        <div data-view-component="true" class="Overlay-body">        <!-- '"` --><!-- </textarea></xmp> --></option></form><form id="code-search-feedback-form" data-turbo="false" action="/search/feedback" accept-charset="UTF-8" method="post"><input type="hidden" data-csrf="true" name="authenticity_token" value="D+TLDErA97qZ4QWrt1gyIkqWsNc63lXZ4LU0JbInpUbjqA3ra9zq+B2UrPDVRluUaiy2J7uqnLAWZ8vVGuQHVw==" />
          <p>We read every piece of feedback, and take your input very seriously.</p>
          <textarea name="feedback" class="form-control width-full mb-2" style="height: 120px" id="feedback"></textarea>
          <input name="include_email" id="include_email" aria-label="Include my email address so I can be contacted" class="form-control mr-2" type="checkbox">
          <label for="include_email" style="font-weight: normal">Include my email address so I can be contacted</label>
</form></div>
      </scrollable-region>
      <div data-view-component="true" class="Overlay-footer Overlay-footer--alignEnd">          <button data-close-dialog-id="feedback-dialog" type="button" data-view-component="true" class="btn">    Cancel
</button>
          <button form="code-search-feedback-form" data-action="click:qbsearch-input#submitFeedback" type="submit" data-view-component="true" class="btn-primary btn">    Submit feedback
</button>
</div>
</dialog></dialog-helper>

    <custom-scopes data-target="qbsearch-input.customScopesManager">
    
<dialog-helper>
  <dialog data-target="custom-scopes.customScopesModalDialog" data-action="close:qbsearch-input#handleDialogClose cancel:qbsearch-input#handleDialogClose" id="custom-scopes-dialog" aria-modal="true" aria-labelledby="custom-scopes-dialog-title" aria-describedby="custom-scopes-dialog-description" data-view-component="true" class="Overlay Overlay-whenNarrow Overlay--size-medium Overlay--motion-scaleFade Overlay--disableScroll">
    <div data-view-component="true" class="Overlay-header Overlay-header--divided">
  <div class="Overlay-headerContentWrap">
    <div class="Overlay-titleWrap">
      <h1 class="Overlay-title " id="custom-scopes-dialog-title">
        Saved searches
      </h1>
        <h2 id="custom-scopes-dialog-description" class="Overlay-description">Use saved searches to filter your results more quickly</h2>
    </div>
    <div class="Overlay-actionWrap">
      <button data-close-dialog-id="custom-scopes-dialog" aria-label="Close" aria-label="Close" type="button" data-view-component="true" class="close-button Overlay-closeButton"><svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg></button>
    </div>
  </div>
  
</div>
      <scrollable-region data-labelled-by="custom-scopes-dialog-title">
        <div data-view-component="true" class="Overlay-body">        <div data-target="custom-scopes.customScopesModalDialogFlash"></div>

        <div hidden class="create-custom-scope-form" data-target="custom-scopes.createCustomScopeForm">
        <!-- '"` --><!-- </textarea></xmp> --></option></form><form id="custom-scopes-dialog-form" data-turbo="false" action="/search/custom_scopes" accept-charset="UTF-8" method="post"><input type="hidden" data-csrf="true" name="authenticity_token" value="B7QhVWuywyu/Phe48jKnN6aZJJtbydfgv8+sHw0IrQK/R8NwZfjYZhGWSa+0IOMjdtH2PapUMGexlgy4Qgdd3g==" />
          <div data-target="custom-scopes.customScopesModalDialogFlash"></div>

          <input type="hidden" id="custom_scope_id" name="custom_scope_id" data-target="custom-scopes.customScopesIdField">

          <div class="form-group">
            <label for="custom_scope_name">Name</label>
            <auto-check src="/search/custom_scopes/check_name" required>
              <input
                type="text"
                name="custom_scope_name"
                id="custom_scope_name"
                data-target="custom-scopes.customScopesNameField"
                class="form-control"
                autocomplete="off"
                placeholder="github-ruby"
                required
                maxlength="50">
              <input type="hidden" data-csrf="true" value="JtEVeDnumbIvhtdtWrLXOvrC/mitds3ph5VJH/OWhFA1XypOyxjHefowbRJhUmaKl13UvmOnlgQuChKPRTRN4w==" />
            </auto-check>
          </div>

          <div class="form-group">
            <label for="custom_scope_query">Query</label>
            <input
              type="text"
              name="custom_scope_query"
              id="custom_scope_query"
              data-target="custom-scopes.customScopesQueryField"
              class="form-control"
              autocomplete="off"
              placeholder="(repo:mona/a OR repo:mona/b) AND lang:python"
              required
              maxlength="500">
          </div>

          <p class="text-small color-fg-muted">
            To see all available qualifiers, see our <a class="Link--inTextBlock" href="https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax">documentation</a>.
          </p>
</form>        </div>

        <div data-target="custom-scopes.manageCustomScopesForm">
          <div data-target="custom-scopes.list"></div>
        </div>

</div>
      </scrollable-region>
      <div data-view-component="true" class="Overlay-footer Overlay-footer--alignEnd Overlay-footer--divided">          <button data-action="click:custom-scopes#customScopesCancel" type="button" data-view-component="true" class="btn">    Cancel
</button>
          <button form="custom-scopes-dialog-form" data-action="click:custom-scopes#customScopesSubmit" data-target="custom-scopes.customScopesSubmitButton" type="submit" data-view-component="true" class="btn-primary btn">    Create saved search
</button>
</div>
</dialog></dialog-helper>
    </custom-scopes>
  </div>
</qbsearch-input>


            <div class="position-relative HeaderMenu-link-wrap d-lg-inline-block">
              <a
                href="/login?return_to=https%3A%2F%2Fgithub.com%2Ffedi-e2ee%2Fpublic-key-directory-specification%2Fblob%2Fmain%2FSpecification.md"
                class="HeaderMenu-link HeaderMenu-link--sign-in HeaderMenu-button flex-shrink-0 no-underline d-none d-lg-inline-flex border border-lg-0 rounded px-2 py-1"
                style="margin-left: 12px;"
                data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;site header menu&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;SIGN_UP&quot;,&quot;originating_url&quot;:&quot;https://github.com/fedi-e2ee/public-key-directory-specification/blob/main/Specification.md&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="bdc4ea9572fe079183fe5885c9de48bde7abc4925963509402c71f9a9c17622d"
                data-analytics-event="{&quot;category&quot;:&quot;Marketing nav&quot;,&quot;action&quot;:&quot;click to go to homepage&quot;,&quot;label&quot;:&quot;ref_page:Marketing;ref_cta:Sign in;ref_loc:Header&quot;}"
              >
                Sign in
              </a>
            </div>

              <a href="/signup?ref_cta=Sign+up&amp;ref_loc=header+logged+out&amp;ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&amp;source=header-repo&amp;source_repo=fedi-e2ee%2Fpublic-key-directory-specification"
                class="HeaderMenu-link HeaderMenu-link--sign-up HeaderMenu-button flex-shrink-0 d-flex d-lg-inline-flex no-underline border color-border-default rounded px-2 py-1"
                data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;site header menu&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;SIGN_UP&quot;,&quot;originating_url&quot;:&quot;https://github.com/fedi-e2ee/public-key-directory-specification/blob/main/Specification.md&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="bdc4ea9572fe079183fe5885c9de48bde7abc4925963509402c71f9a9c17622d"
                data-analytics-event="{&quot;category&quot;:&quot;Sign up&quot;,&quot;action&quot;:&quot;click to sign up for account&quot;,&quot;label&quot;:&quot;ref_page:/&lt;user-name&gt;/&lt;repo-name&gt;/blob/show;ref_cta:Sign up;ref_loc:header logged out&quot;}"
              >
                Sign up
              </a>

                <div class="AppHeader-appearanceSettings">
    <react-partial-anchor>
      <button data-target="react-partial-anchor.anchor" id="icon-button-82036b77-45d8-4805-afc7-47e603bb072a" aria-labelledby="tooltip-9f4a399e-c08b-4d06-92af-1545b0f9817d" type="button" disabled="disabled" data-view-component="true" class="Button Button--iconOnly Button--invisible Button--medium AppHeader-button HeaderMenu-link border cursor-wait">  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-sliders Button-visual">
    <path d="M15 2.75a.75.75 0 0 1-.75.75h-4a.75.75 0 0 1 0-1.5h4a.75.75 0 0 1 .75.75Zm-8.5.75v1.25a.75.75 0 0 0 1.5 0v-4a.75.75 0 0 0-1.5 0V2H1.75a.75.75 0 0 0 0 1.5H6.5Zm1.25 5.25a.75.75 0 0 0 0-1.5h-6a.75.75 0 0 0 0 1.5h6ZM15 8a.75.75 0 0 1-.75.75H11.5V10a.75.75 0 1 1-1.5 0V6a.75.75 0 0 1 1.5 0v1.25h2.75A.75.75 0 0 1 15 8Zm-9 5.25v-2a.75.75 0 0 0-1.5 0v1.25H1.75a.75.75 0 0 0 0 1.5H4.5v1.25a.75.75 0 0 0 1.5 0v-2Zm9 0a.75.75 0 0 1-.75.75h-6a.75.75 0 0 1 0-1.5h6a.75.75 0 0 1 .75.75Z"></path>
</svg>
</button><tool-tip id="tooltip-9f4a399e-c08b-4d06-92af-1545b0f9817d" for="icon-button-82036b77-45d8-4805-afc7-47e603bb072a" popover="manual" data-direction="s" data-type="label" data-view-component="true" class="sr-only position-absolute">Appearance settings</tool-tip>

      <template data-target="react-partial-anchor.template">
        <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-react.c916beccff42f23950ab.module.css" />
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/appearance-settings.6c63a6de228d6520804d.module.css" />

<react-partial
  partial-name="appearance-settings"
  data-ssr="false"
  data-attempted-ssr="false"
  data-react-profiling="false"
>
  
  <script type="application/json" data-target="react-partial.embeddedData">{"props":{}}</script>
  <div data-target="react-partial.reactRoot"></div>
</react-partial>


      </template>
    </react-partial-anchor>
  </div>

          <button type="button" class="sr-only js-header-menu-focus-trap d-block d-lg-none">Resetting focus</button>
        </div>
      </div>
    </div>
  </div>
</header>

      <div hidden="hidden" data-view-component="true" class="js-stale-session-flash stale-session-flash flash flash-warn flash-full">
  
        <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
        <span class="js-stale-session-flash-signed-in" hidden>You signed in with another tab or window. <a class="Link--inTextBlock" href="">Reload</a> to refresh your session.</span>
        <span class="js-stale-session-flash-signed-out" hidden>You signed out in another tab or window. <a class="Link--inTextBlock" href="">Reload</a> to refresh your session.</span>
        <span class="js-stale-session-flash-switched" hidden>You switched accounts on another tab or window. <a class="Link--inTextBlock" href="">Reload</a> to refresh your session.</span>

    <button id="icon-button-331fffd7-2e70-4175-bdc3-3204b383130b" aria-labelledby="tooltip-36393c79-3fd5-4a52-9b13-971d5ac4cfd3" type="button" data-view-component="true" class="Button Button--iconOnly Button--invisible Button--medium flash-close js-flash-close">  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x Button-visual">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
</button><tool-tip id="tooltip-36393c79-3fd5-4a52-9b13-971d5ac4cfd3" for="icon-button-331fffd7-2e70-4175-bdc3-3204b383130b" popover="manual" data-direction="s" data-type="label" data-view-component="true" class="sr-only position-absolute">Dismiss alert</tool-tip>


  
</div>
    </div>

  <div id="start-of-content" class="show-on-focus"></div>








    <div id="js-flash-container" class="flash-container" data-turbo-replace>




  <template class="js-flash-template">
    
<div class="flash flash-full   {{ className }}">
  <div >
    <button autofocus class="flash-close js-flash-close" type="button" aria-label="Dismiss this message">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
    </button>
    <div aria-atomic="true" role="alert" class="js-flash-alert">
      
      <div>{{ message }}</div>

    </div>
  </div>
</div>
  </template>
</div>


    






  <div
    class="application-main "
    data-commit-hovercards-enabled
    data-discussion-hovercards-enabled
    data-issue-and-pr-hovercards-enabled
    data-project-hovercards-enabled
  >
        <div itemscope itemtype="http://schema.org/SoftwareSourceCode" class="">
    <main id="js-repo-pjax-container" >
      
      
    

    






  
  <div id="repository-container-header"  class="pt-3 hide-full-screen" style="background-color: var(--page-header-bgColor, var(--color-page-header-bg));" data-turbo-replace>

      <div class="d-flex flex-nowrap flex-justify-end mb-3  px-3 px-lg-5" style="gap: 1rem;">

        <div class="flex-auto min-width-0 width-fit">
            
  <div class=" d-flex flex-wrap flex-items-center wb-break-word f3 text-normal">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-repo color-fg-muted mr-2">
    <path d="M2 2.5A2.5 2.5 0 0 1 4.5 0h8.75a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h1.75v-2h-8a1 1 0 0 0-.714 1.7.75.75 0 1 1-1.072 1.05A2.495 2.495 0 0 1 2 11.5Zm10.5-1h-8a1 1 0 0 0-1 1v6.708A2.486 2.486 0 0 1 4.5 9h8ZM5 12.25a.25.25 0 0 1 .25-.25h3.5a.25.25 0 0 1 .25.25v3.25a.25.25 0 0 1-.4.2l-1.45-1.087a.249.249 0 0 0-.3 0L5.4 15.7a.25.25 0 0 1-.4-.2Z"></path>
</svg>
    
    <span class="author flex-self-stretch" itemprop="author">
      <a class="url fn" rel="author" data-hovercard-type="organization" data-hovercard-url="/orgs/fedi-e2ee/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="/fedi-e2ee">
        fedi-e2ee
</a>    </span>
    <span class="mx-1 flex-self-stretch color-fg-muted">/</span>
    <strong itemprop="name" class="mr-2 flex-self-stretch">
      <a data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" href="/fedi-e2ee/public-key-directory-specification">public-key-directory-specification</a>
    </strong>

    <span></span><span class="Label Label--secondary v-align-middle mr-1">Public</span>
  </div>


        </div>

        <div id="repository-details-container" class="flex-shrink-0" data-turbo-replace style="max-width: 70%;">
            <ul class="pagehead-actions flex-shrink-0 d-none d-md-inline" style="padding: 2px 0;">
    
      

  <li>
            <a href="/login?return_to=%2Ffedi-e2ee%2Fpublic-key-directory-specification" rel="nofollow" id="repository-details-watch-button" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;notification subscription menu watch&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;LOG_IN&quot;,&quot;originating_url&quot;:&quot;https://github.com/fedi-e2ee/public-key-directory-specification/blob/main/Specification.md&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="32ca521da82d54856c08c4cb2a2d4813b7791daccd1d0580cf2fe7f4856b6115" aria-label="You must be signed in to change notification settings" data-view-component="true" class="btn-sm btn">    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-bell mr-2">
    <path d="M8 16a2 2 0 0 0 1.985-1.75c.017-.137-.097-.25-.235-.25h-3.5c-.138 0-.252.113-.235.25A2 2 0 0 0 8 16ZM3 5a5 5 0 0 1 10 0v2.947c0 .05.015.098.042.139l1.703 2.555A1.519 1.519 0 0 1 13.482 13H2.518a1.516 1.516 0 0 1-1.263-2.36l1.703-2.554A.255.255 0 0 0 3 7.947Zm5-3.5A3.5 3.5 0 0 0 4.5 5v2.947c0 .346-.102.683-.294.97l-1.703 2.556a.017.017 0 0 0-.003.01l.001.006c0 .002.002.004.004.006l.006.004.007.001h10.964l.007-.001.006-.004.004-.006.001-.007a.017.017 0 0 0-.003-.01l-1.703-2.554a1.745 1.745 0 0 1-.294-.97V5A3.5 3.5 0 0 0 8 1.5Z"></path>
</svg>Notifications
</a>    <tool-tip id="tooltip-53d10b90-aa0e-480a-9d45-68bcb9e4e3bb" for="repository-details-watch-button" popover="manual" data-direction="s" data-type="description" data-view-component="true" class="sr-only position-absolute">You must be signed in to change notification settings</tool-tip>

  </li>

  <li>
          <a icon="repo-forked" id="fork-button" href="/login?return_to=%2Ffedi-e2ee%2Fpublic-key-directory-specification" rel="nofollow" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;repo details fork button&quot;,&quot;repository_id&quot;:812178125,&quot;auth_type&quot;:&quot;LOG_IN&quot;,&quot;originating_url&quot;:&quot;https://github.com/fedi-e2ee/public-key-directory-specification/blob/main/Specification.md&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="c3c5118708b30fc97489c5508f91b49ea23d60242f407677b1c97b55737550ac" data-view-component="true" class="btn-sm btn">    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-repo-forked mr-2">
    <path d="M5 5.372v.878c0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75v-.878a2.25 2.25 0 1 1 1.5 0v.878a2.25 2.25 0 0 1-2.25 2.25h-1.5v2.128a2.251 2.251 0 1 1-1.5 0V8.5h-1.5A2.25 2.25 0 0 1 3.5 6.25v-.878a2.25 2.25 0 1 1 1.5 0ZM5 3.25a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Zm6.75.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Zm-3 8.75a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Z"></path>
</svg>Fork
    <span id="repo-network-counter" data-pjax-replace="true" data-turbo-replace="true" title="3" data-view-component="true" class="Counter">3</span>
</a>
  </li>

  <li>
        <div data-view-component="true" class="BtnGroup d-flex">
        <a href="/login?return_to=%2Ffedi-e2ee%2Fpublic-key-directory-specification" rel="nofollow" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;star button&quot;,&quot;repository_id&quot;:812178125,&quot;auth_type&quot;:&quot;LOG_IN&quot;,&quot;originating_url&quot;:&quot;https://github.com/fedi-e2ee/public-key-directory-specification/blob/main/Specification.md&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="90d37c77172a2023d95d00307b2ba47e4d00781fc691554025558dda635f9011" aria-label="You must be signed in to star a repository" data-view-component="true" class="tooltipped tooltipped-sw btn-sm btn">    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-star v-align-text-bottom d-inline-block mr-2">
    <path d="M8 .25a.75.75 0 0 1 .673.418l1.882 3.815 4.21.612a.75.75 0 0 1 .416 1.279l-3.046 2.97.719 4.192a.751.751 0 0 1-1.088.791L8 12.347l-3.766 1.98a.75.75 0 0 1-1.088-.79l.72-4.194L.818 6.374a.75.75 0 0 1 .416-1.28l4.21-.611L7.327.668A.75.75 0 0 1 8 .25Zm0 2.445L6.615 5.5a.75.75 0 0 1-.564.41l-3.097.45 2.24 2.184a.75.75 0 0 1 .216.664l-.528 3.084 2.769-1.456a.75.75 0 0 1 .698 0l2.77 1.456-.53-3.084a.75.75 0 0 1 .216-.664l2.24-2.183-3.096-.45a.75.75 0 0 1-.564-.41L8 2.694Z"></path>
</svg><span data-view-component="true" class="d-inline">
          Star
</span>          <span id="repo-stars-counter-star" aria-label="122 users starred this repository" data-singular-suffix="user starred this repository" data-plural-suffix="users starred this repository" data-turbo-replace="true" title="122" data-view-component="true" class="Counter js-social-count">122</span>
</a></div>
  </li>

</ul>

        </div>
      </div>

        <div id="responsive-meta-container" data-turbo-replace>
</div>


          <nav data-pjax="#js-repo-pjax-container" aria-label="Repository" data-view-component="true" class="js-repo-nav js-sidenav-container-pjax js-responsive-underlinenav overflow-hidden UnderlineNav px-3 px-md-4 px-lg-5">

  <ul data-view-component="true" class="UnderlineNav-body list-style-none">
      <li data-view-component="true" class="d-inline-flex">
  <a id="code-tab" href="/fedi-e2ee/public-key-directory-specification" data-tab-item="i0code-tab" data-selected-links="repo_source repo_downloads repo_commits repo_releases repo_tags repo_branches repo_packages repo_deployments repo_attestations /fedi-e2ee/public-key-directory-specification" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-hotkey="g c" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Code&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" aria-current="page" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item selected">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-code UnderlineNav-octicon d-none d-sm-inline">
    <path d="m11.28 3.22 4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734L13.94 8l-3.72-3.72a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215Zm-6.56 0a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042L2.06 8l3.72 3.72a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L.47 8.53a.75.75 0 0 1 0-1.06Z"></path>
</svg>
        <span data-content="Code">Code</span>
          <span id="code-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="Not available" data-view-component="true" class="Counter"></span>


    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="issues-tab" href="/fedi-e2ee/public-key-directory-specification/issues" data-tab-item="i1issues-tab" data-selected-links="repo_issues repo_labels repo_milestones /fedi-e2ee/public-key-directory-specification/issues" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-hotkey="g i" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Issues&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-issue-opened UnderlineNav-octicon d-none d-sm-inline">
    <path d="M8 9.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path><path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Z"></path>
</svg>
        <span data-content="Issues">Issues</span>
          <span id="issues-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="12" data-view-component="true" class="Counter">12</span>


    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="pull-requests-tab" href="/fedi-e2ee/public-key-directory-specification/pulls" data-tab-item="i2pull-requests-tab" data-selected-links="repo_pulls checks /fedi-e2ee/public-key-directory-specification/pulls" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-hotkey="g p" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Pull requests&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-git-pull-request UnderlineNav-octicon d-none d-sm-inline">
    <path d="M1.5 3.25a2.25 2.25 0 1 1 3 2.122v5.256a2.251 2.251 0 1 1-1.5 0V5.372A2.25 2.25 0 0 1 1.5 3.25Zm5.677-.177L9.573.677A.25.25 0 0 1 10 .854V2.5h1A2.5 2.5 0 0 1 13.5 5v5.628a2.251 2.251 0 1 1-1.5 0V5a1 1 0 0 0-1-1h-1v1.646a.25.25 0 0 1-.427.177L7.177 3.427a.25.25 0 0 1 0-.354ZM3.75 2.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Zm0 9.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Zm8.25.75a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0Z"></path>
</svg>
        <span data-content="Pull requests">Pull requests</span>
          <span id="pull-requests-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="0" hidden="hidden" data-view-component="true" class="Counter">0</span>


    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="actions-tab" href="/fedi-e2ee/public-key-directory-specification/actions" data-tab-item="i3actions-tab" data-selected-links="repo_actions /fedi-e2ee/public-key-directory-specification/actions" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-hotkey="g a" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Actions&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-play UnderlineNav-octicon d-none d-sm-inline">
    <path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Zm4.879-2.773 4.264 2.559a.25.25 0 0 1 0 .428l-4.264 2.559A.25.25 0 0 1 6 10.559V5.442a.25.25 0 0 1 .379-.215Z"></path>
</svg>
        <span data-content="Actions">Actions</span>
          <span id="actions-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="Not available" data-view-component="true" class="Counter"></span>


    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="projects-tab" href="/fedi-e2ee/public-key-directory-specification/projects" data-tab-item="i4projects-tab" data-selected-links="repo_projects new_repo_project repo_project /fedi-e2ee/public-key-directory-specification/projects" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-hotkey="g b" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Projects&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-table UnderlineNav-octicon d-none d-sm-inline">
    <path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25ZM6.5 6.5v8h7.75a.25.25 0 0 0 .25-.25V6.5Zm8-1.5V1.75a.25.25 0 0 0-.25-.25H6.5V5Zm-13 1.5v7.75c0 .138.112.25.25.25H5v-8ZM5 5V1.5H1.75a.25.25 0 0 0-.25.25V5Z"></path>
</svg>
        <span data-content="Projects">Projects</span>
          <span id="projects-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="0" hidden="hidden" data-view-component="true" class="Counter">0</span>


    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="security-tab" href="/fedi-e2ee/public-key-directory-specification/security" data-tab-item="i5security-tab" data-selected-links="security overview alerts policy token_scanning code_scanning /fedi-e2ee/public-key-directory-specification/security" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-hotkey="g s" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Security&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-shield UnderlineNav-octicon d-none d-sm-inline">
    <path d="M7.467.133a1.748 1.748 0 0 1 1.066 0l5.25 1.68A1.75 1.75 0 0 1 15 3.48V7c0 1.566-.32 3.182-1.303 4.682-.983 1.498-2.585 2.813-5.032 3.855a1.697 1.697 0 0 1-1.33 0c-2.447-1.042-4.049-2.357-5.032-3.855C1.32 10.182 1 8.566 1 7V3.48a1.75 1.75 0 0 1 1.217-1.667Zm.61 1.429a.25.25 0 0 0-.153 0l-5.25 1.68a.25.25 0 0 0-.174.238V7c0 1.358.275 2.666 1.057 3.86.784 1.194 2.121 2.34 4.366 3.297a.196.196 0 0 0 .154 0c2.245-.956 3.582-2.104 4.366-3.298C13.225 9.666 13.5 8.36 13.5 7V3.48a.251.251 0 0 0-.174-.237l-5.25-1.68ZM8.75 4.75v3a.75.75 0 0 1-1.5 0v-3a.75.75 0 0 1 1.5 0ZM9 10.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
        <span data-content="Security">Security</span>
          <include-fragment src="/fedi-e2ee/public-key-directory-specification/security/overall-count" accept="text/fragment+html" data-nonce="v2:bd676494-8a7e-4a70-afcd-fad71956b5c1" data-view-component="true">
  
  <div data-show-on-forbidden-error hidden>
    <div class="Box">
  <div class="blankslate-container">
    <div data-view-component="true" class="blankslate blankslate-spacious color-bg-default rounded-2">
      

      <h3 data-view-component="true" class="blankslate-heading">        Uh oh!
</h3>
      <p data-view-component="true">        <p class="color-fg-muted my-2 mb-2 ws-normal">There was an error while loading. <a class="Link--inTextBlock" data-turbo="false" href="" aria-label="Please reload this page">Please reload this page</a>.</p>
</p>

</div>  </div>
</div>  </div>
</include-fragment>

    
</a></li>
      <li data-view-component="true" class="d-inline-flex">
  <a id="insights-tab" href="/fedi-e2ee/public-key-directory-specification/pulse" data-tab-item="i6insights-tab" data-selected-links="repo_graphs repo_contributors dependency_graph dependabot_updates pulse people community /fedi-e2ee/public-key-directory-specification/pulse" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame" data-analytics-event="{&quot;category&quot;:&quot;Underline navbar&quot;,&quot;action&quot;:&quot;Click tab&quot;,&quot;label&quot;:&quot;Insights&quot;,&quot;target&quot;:&quot;UNDERLINE_NAV.TAB&quot;}" data-view-component="true" class="UnderlineNav-item no-wrap js-responsive-underlinenav-item js-selected-navigation-item">
    
              <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-graph UnderlineNav-octicon d-none d-sm-inline">
    <path d="M1.5 1.75V13.5h13.75a.75.75 0 0 1 0 1.5H.75a.75.75 0 0 1-.75-.75V1.75a.75.75 0 0 1 1.5 0Zm14.28 2.53-5.25 5.25a.75.75 0 0 1-1.06 0L7 7.06 4.28 9.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.25-3.25a.75.75 0 0 1 1.06 0L10 7.94l4.72-4.72a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042Z"></path>
</svg>
        <span data-content="Insights">Insights</span>
          <span id="insights-repo-tab-count" data-pjax-replace="" data-turbo-replace="" title="Not available" data-view-component="true" class="Counter"></span>


    
</a></li>
</ul>
    <div style="visibility:hidden;" data-view-component="true" class="UnderlineNav-actions js-responsive-underlinenav-overflow position-absolute pr-3 pr-md-4 pr-lg-5 right-0">      <action-menu data-select-variant="none" data-view-component="true">
  <focus-group direction="vertical" mnemonics retain>
    <button id="action-menu-bc884639-bb36-4cc9-81e8-0f2205228fe2-button" popovertarget="action-menu-bc884639-bb36-4cc9-81e8-0f2205228fe2-overlay" aria-controls="action-menu-bc884639-bb36-4cc9-81e8-0f2205228fe2-list" aria-haspopup="true" aria-labelledby="tooltip-8222a13c-8ff0-40f1-bd5a-bfcc59bfa93e" type="button" data-view-component="true" class="Button Button--iconOnly Button--secondary Button--medium UnderlineNav-item">  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-kebab-horizontal Button-visual">
    <path d="M8 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3ZM1.5 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm13 0a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path>
</svg>
</button><tool-tip id="tooltip-8222a13c-8ff0-40f1-bd5a-bfcc59bfa93e" for="action-menu-bc884639-bb36-4cc9-81e8-0f2205228fe2-button" popover="manual" data-direction="s" data-type="label" data-view-component="true" class="sr-only position-absolute">Additional navigation options</tool-tip>


<anchored-position data-target="action-menu.overlay" id="action-menu-bc884639-bb36-4cc9-81e8-0f2205228fe2-overlay" anchor="action-menu-bc884639-bb36-4cc9-81e8-0f2205228fe2-button" align="start" side="outside-bottom" anchor-offset="normal" popover="auto" data-view-component="true">
  <div data-view-component="true" class="Overlay Overlay--size-auto">
    
      <div data-view-component="true" class="Overlay-body Overlay-body--paddingNone">          <action-list>
  <div data-view-component="true">
    <ul aria-labelledby="action-menu-bc884639-bb36-4cc9-81e8-0f2205228fe2-button" id="action-menu-bc884639-bb36-4cc9-81e8-0f2205228fe2-list" role="menu" data-view-component="true" class="ActionListWrap--inset ActionListWrap">
        <li hidden="hidden" data-menu-item="i0code-tab" data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <a tabindex="-1" id="item-03f1660f-71f7-4fc0-a503-4f3db90116ec" href="/fedi-e2ee/public-key-directory-specification" role="menuitem" data-view-component="true" class="ActionListContent ActionListContent--visual16">
        <span class="ActionListItem-visual ActionListItem-visual--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-code">
    <path d="m11.28 3.22 4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.749.749 0 0 1-1.275-.326.749.749 0 0 1 .215-.734L13.94 8l-3.72-3.72a.749.749 0 0 1 .326-1.275.749.749 0 0 1 .734.215Zm-6.56 0a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042L2.06 8l3.72 3.72a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L.47 8.53a.75.75 0 0 1 0-1.06Z"></path>
</svg>
        </span>
      
        <span data-view-component="true" class="ActionListItem-label">
          Code
</span>      
</a>
  
</li>
        <li hidden="hidden" data-menu-item="i1issues-tab" data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <a tabindex="-1" id="item-212a3fe0-49be-41e6-9004-79ca2d79eeae" href="/fedi-e2ee/public-key-directory-specification/issues" role="menuitem" data-view-component="true" class="ActionListContent ActionListContent--visual16">
        <span class="ActionListItem-visual ActionListItem-visual--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-issue-opened">
    <path d="M8 9.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path><path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Z"></path>
</svg>
        </span>
      
        <span data-view-component="true" class="ActionListItem-label">
          Issues
</span>      
</a>
  
</li>
        <li hidden="hidden" data-menu-item="i2pull-requests-tab" data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <a tabindex="-1" id="item-9c8c8a24-b873-47cd-8852-2fd2cc6ce672" href="/fedi-e2ee/public-key-directory-specification/pulls" role="menuitem" data-view-component="true" class="ActionListContent ActionListContent--visual16">
        <span class="ActionListItem-visual ActionListItem-visual--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-git-pull-request">
    <path d="M1.5 3.25a2.25 2.25 0 1 1 3 2.122v5.256a2.251 2.251 0 1 1-1.5 0V5.372A2.25 2.25 0 0 1 1.5 3.25Zm5.677-.177L9.573.677A.25.25 0 0 1 10 .854V2.5h1A2.5 2.5 0 0 1 13.5 5v5.628a2.251 2.251 0 1 1-1.5 0V5a1 1 0 0 0-1-1h-1v1.646a.25.25 0 0 1-.427.177L7.177 3.427a.25.25 0 0 1 0-.354ZM3.75 2.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Zm0 9.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Zm8.25.75a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0Z"></path>
</svg>
        </span>
      
        <span data-view-component="true" class="ActionListItem-label">
          Pull requests
</span>      
</a>
  
</li>
        <li hidden="hidden" data-menu-item="i3actions-tab" data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <a tabindex="-1" id="item-498585bf-25d8-4536-a049-d0f72880900f" href="/fedi-e2ee/public-key-directory-specification/actions" role="menuitem" data-view-component="true" class="ActionListContent ActionListContent--visual16">
        <span class="ActionListItem-visual ActionListItem-visual--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-play">
    <path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0ZM1.5 8a6.5 6.5 0 1 0 13 0 6.5 6.5 0 0 0-13 0Zm4.879-2.773 4.264 2.559a.25.25 0 0 1 0 .428l-4.264 2.559A.25.25 0 0 1 6 10.559V5.442a.25.25 0 0 1 .379-.215Z"></path>
</svg>
        </span>
      
        <span data-view-component="true" class="ActionListItem-label">
          Actions
</span>      
</a>
  
</li>
        <li hidden="hidden" data-menu-item="i4projects-tab" data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <a tabindex="-1" id="item-abbe61ca-e0c1-407e-98ab-0ff4f241f49c" href="/fedi-e2ee/public-key-directory-specification/projects" role="menuitem" data-view-component="true" class="ActionListContent ActionListContent--visual16">
        <span class="ActionListItem-visual ActionListItem-visual--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-table">
    <path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v12.5A1.75 1.75 0 0 1 14.25 16H1.75A1.75 1.75 0 0 1 0 14.25ZM6.5 6.5v8h7.75a.25.25 0 0 0 .25-.25V6.5Zm8-1.5V1.75a.25.25 0 0 0-.25-.25H6.5V5Zm-13 1.5v7.75c0 .138.112.25.25.25H5v-8ZM5 5V1.5H1.75a.25.25 0 0 0-.25.25V5Z"></path>
</svg>
        </span>
      
        <span data-view-component="true" class="ActionListItem-label">
          Projects
</span>      
</a>
  
</li>
        <li hidden="hidden" data-menu-item="i5security-tab" data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <a tabindex="-1" id="item-27bb8c7e-238d-4250-a62e-c917c4dee18f" href="/fedi-e2ee/public-key-directory-specification/security" role="menuitem" data-view-component="true" class="ActionListContent ActionListContent--visual16">
        <span class="ActionListItem-visual ActionListItem-visual--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-shield">
    <path d="M7.467.133a1.748 1.748 0 0 1 1.066 0l5.25 1.68A1.75 1.75 0 0 1 15 3.48V7c0 1.566-.32 3.182-1.303 4.682-.983 1.498-2.585 2.813-5.032 3.855a1.697 1.697 0 0 1-1.33 0c-2.447-1.042-4.049-2.357-5.032-3.855C1.32 10.182 1 8.566 1 7V3.48a1.75 1.75 0 0 1 1.217-1.667Zm.61 1.429a.25.25 0 0 0-.153 0l-5.25 1.68a.25.25 0 0 0-.174.238V7c0 1.358.275 2.666 1.057 3.86.784 1.194 2.121 2.34 4.366 3.297a.196.196 0 0 0 .154 0c2.245-.956 3.582-2.104 4.366-3.298C13.225 9.666 13.5 8.36 13.5 7V3.48a.251.251 0 0 0-.174-.237l-5.25-1.68ZM8.75 4.75v3a.75.75 0 0 1-1.5 0v-3a.75.75 0 0 1 1.5 0ZM9 10.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
        </span>
      
        <span data-view-component="true" class="ActionListItem-label">
          Security
</span>      
</a>
  
</li>
        <li hidden="hidden" data-menu-item="i6insights-tab" data-targets="action-list.items" role="none" data-view-component="true" class="ActionListItem">
    
    
    <a tabindex="-1" id="item-38027e2e-f80b-4d58-952e-afd1a56b1e12" href="/fedi-e2ee/public-key-directory-specification/pulse" role="menuitem" data-view-component="true" class="ActionListContent ActionListContent--visual16">
        <span class="ActionListItem-visual ActionListItem-visual--leading">
          <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-graph">
    <path d="M1.5 1.75V13.5h13.75a.75.75 0 0 1 0 1.5H.75a.75.75 0 0 1-.75-.75V1.75a.75.75 0 0 1 1.5 0Zm14.28 2.53-5.25 5.25a.75.75 0 0 1-1.06 0L7 7.06 4.28 9.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.25-3.25a.75.75 0 0 1 1.06 0L10 7.94l4.72-4.72a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042Z"></path>
</svg>
        </span>
      
        <span data-view-component="true" class="ActionListItem-label">
          Insights
</span>      
</a>
  
</li>
</ul>    
</div></action-list>


</div>
      
</div></anchored-position>  </focus-group>
</action-menu></div>
</nav>

  </div>

  



<turbo-frame id="repo-content-turbo-frame" target="_top" data-turbo-action="advance" class="">
    <div id="repo-content-pjax-container" class="repository-content " >
    



    
      
    








<react-app
  app-name="react-code-view"
  initial-path="/fedi-e2ee/public-key-directory-specification/blob/main/Specification.md"
    style="display: block; min-height: calc(100vh - 64px);"
  data-attempted-ssr="false"
  data-ssr="false"
  data-lazy="false"
  data-alternate="false"
  data-data-router-enabled="false"
  data-react-profiling="false"
>
  
  <script type="application/json" data-target="react-app.embeddedData">{"payload":{"allShortcutsEnabled":false,"fileTree":{"":{"items":[{"name":"test-code","path":"test-code","contentType":"directory"},{"name":".gitignore","path":".gitignore","contentType":"file"},{"name":"Architecture.md","path":"Architecture.md","contentType":"file"},{"name":"LICENSE.md","path":"LICENSE.md","contentType":"file"},{"name":"README.md","path":"README.md","contentType":"file"},{"name":"Specification.md","path":"Specification.md","contentType":"file"},{"name":"Test-Vectors.md","path":"Test-Vectors.md","contentType":"file"}],"totalCount":7}},"fileTreeProcessingTime":3.477561,"foldersToFetch":[],"incompleteFileTree":false,"repo":{"id":812178125,"defaultBranch":"main","name":"public-key-directory-specification","ownerLogin":"fedi-e2ee","currentUserCanPush":false,"isFork":false,"isEmpty":false,"createdAt":"2024-06-08T06:50:01.000Z","ownerAvatar":"https://avatars.githubusercontent.com/u/172102947?v=4","public":true,"private":false,"isOrgOwned":true},"codeLineWrapEnabled":false,"symbolsExpanded":false,"treeExpanded":true,"refInfo":{"name":"main","listCacheKey":"v0:1743353700.0","canEdit":false,"refType":"branch","currentOid":"d55eb4efc1cbcb3be86f5b79a5a5c892626006e4","canEditOnDefaultBranch":false,"fileExistsOnDefault":true},"path":"Specification.md","currentUser":null,"blob":{"rawLines":null,"stylingDirectives":null,"colorizedLines":null,"csv":null,"csvError":null,"copilotSWEAgentEnabled":false,"dependabotInfo":{"showConfigurationBanner":false,"configFilePath":null,"networkDependabotPath":"/fedi-e2ee/public-key-directory-specification/network/updates","dismissConfigurationNoticePath":"/settings/dismiss-notice/dependabot_configuration_notice","configurationNoticeDismissed":null},"displayName":"Specification.md","displayUrl":"https://github.com/fedi-e2ee/public-key-directory-specification/blob/main/Specification.md?raw=true","headerInfo":{"blobSize":"143 KB","deleteTooltip":"You must be signed in to make or propose changes","editTooltip":"You must be signed in to make or propose changes","ghDesktopPath":"https://desktop.github.com","isGitLfs":false,"onBranch":true,"shortPath":"67d144f","siteNavLoginPath":"/login?return_to=https%3A%2F%2Fgithub.com%2Ffedi-e2ee%2Fpublic-key-directory-specification%2Fblob%2Fmain%2FSpecification.md","isCSV":false,"isRichtext":true,"toc":[{"level":1,"text":"Public Key Directory Specification","anchor":"public-key-directory-specification","htmlText":"Public Key Directory Specification"},{"level":2,"text":"Introduction","anchor":"introduction","htmlText":"Introduction"},{"level":3,"text":"Motivation","anchor":"motivation","htmlText":"Motivation"},{"level":4,"text":"Public Key Infrastructures","anchor":"public-key-infrastructures","htmlText":"Public Key Infrastructures"},{"level":4,"text":"Use Case","anchor":"use-case","htmlText":"Use Case"},{"level":3,"text":"This Document","anchor":"this-document","htmlText":"This Document"},{"level":3,"text":"Out Of Scope","anchor":"out-of-scope","htmlText":"Out Of Scope"},{"level":3,"text":"Notation and Conventions","anchor":"notation-and-conventions","htmlText":"Notation and Conventions"},{"level":2,"text":"Concepts","anchor":"concepts","htmlText":"Concepts"},{"level":3,"text":"Identity Binding","anchor":"identity-binding","htmlText":"Identity Binding"},{"level":3,"text":"Message Blocks","anchor":"message-blocks","htmlText":"Message Blocks"},{"level":3,"text":"Public Key Encoding","anchor":"public-key-encoding","htmlText":"Public Key Encoding"},{"level":3,"text":"Merkle Root Encoding","anchor":"merkle-root-encoding","htmlText":"Merkle Root Encoding"},{"level":3,"text":"Protocol Signatures","anchor":"protocol-signatures","htmlText":"Protocol Signatures"},{"level":3,"text":"Key Identifiers","anchor":"key-identifiers","htmlText":"Key Identifiers"},{"level":3,"text":"Revocation Tokens","anchor":"revocation-tokens","htmlText":"Revocation Tokens"},{"level":3,"text":"Auxiliary Data","anchor":"auxiliary-data","htmlText":"Auxiliary Data"},{"level":4,"text":"Auxiliary Data Identifiers","anchor":"auxiliary-data-identifiers","htmlText":"Auxiliary Data Identifiers"},{"level":4,"text":"Requirements for Auxiliary Data Extensions","anchor":"requirements-for-auxiliary-data-extensions","htmlText":"Requirements for Auxiliary Data Extensions"},{"level":3,"text":"Message Attribute Shreddability","anchor":"message-attribute-shreddability","htmlText":"Message Attribute Shreddability"},{"level":3,"text":"Timestamps","anchor":"timestamps","htmlText":"Timestamps"},{"level":2,"text":"Threat Model","anchor":"threat-model","htmlText":"Threat Model"},{"level":3,"text":"Assumptions","anchor":"assumptions","htmlText":"Assumptions"},{"level":3,"text":"Assets","anchor":"assets","htmlText":"Assets"},{"level":3,"text":"Actors","anchor":"actors","htmlText":"Actors"},{"level":3,"text":"Risks","anchor":"risks","htmlText":"Risks"},{"level":4,"text":"Attackers seek to change history.","anchor":"attackers-seek-to-change-history","htmlText":"Attackers seek to change history."},{"level":4,"text":"Attackers seek to selectively censor historical records.","anchor":"attackers-seek-to-selectively-censor-historical-records","htmlText":"Attackers seek to selectively censor historical records."},{"level":4,"text":"Attackers seek to replace public key mappings without altering the ledger.","anchor":"attackers-seek-to-replace-public-key-mappings-without-altering-the-ledger","htmlText":"Attackers seek to replace public key mappings without altering the ledger."},{"level":4,"text":"Attackers seek to leverage plaintext commitment to recover encrypted records whose keys were wiped.","anchor":"attackers-seek-to-leverage-plaintext-commitment-to-recover-encrypted-records-whose-keys-were-wiped","htmlText":"Attackers seek to leverage plaintext commitment to recover encrypted records whose keys were wiped."},{"level":4,"text":"Instance administrator enrolls a public key on behalf of an un-enrolled user.","anchor":"instance-administrator-enrolls-a-public-key-on-behalf-of-an-un-enrolled-user","htmlText":"Instance administrator enrolls a public key on behalf of an un-enrolled user."},{"level":4,"text":"Instance administrator attempts to enroll a new public key for a previously enrolled user.","anchor":"instance-administrator-attempts-to-enroll-a-new-public-key-for-a-previously-enrolled-user","htmlText":"Instance administrator attempts to enroll a new public key for a previously enrolled user."},{"level":4,"text":"Instance administrator attempts to reset the public keys for a previously enrolled user.","anchor":"instance-administrator-attempts-to-reset-the-public-keys-for-a-previously-enrolled-user","htmlText":"Instance administrator attempts to reset the public keys for a previously enrolled user."},{"level":4,"text":"Race condition between successful BurnDown and subsequent AddKey.","anchor":"race-condition-between-successful-burndown-and-subsequent-addkey","htmlText":"Race condition between successful BurnDown and subsequent AddKey."},{"level":4,"text":"Hostile nation state demands their public key be added to an existing actor under a gag order.","anchor":"hostile-nation-state-demands-their-public-key-be-added-to-an-existing-actor-under-a-gag-order","htmlText":"Hostile nation state demands their public key be added to an existing actor under a gag order."},{"level":4,"text":"Hostile nation state seeks to abuse Right To Be Forgotten mechanisms to cover up an unlawful intrusion.","anchor":"hostile-nation-state-seeks-to-abuse-right-to-be-forgotten-mechanisms-to-cover-up-an-unlawful-intrusion","htmlText":"Hostile nation state seeks to abuse Right To Be Forgotten mechanisms to cover up an unlawful intrusion."},{"level":4,"text":"Instance administrator loses all their signing keys.","anchor":"instance-administrator-loses-all-their-signing-keys","htmlText":"Instance administrator loses all their signing keys."},{"level":4,"text":"Attacker sends spoofed messages on behalf of another server.","anchor":"attacker-sends-spoofed-messages-on-behalf-of-another-server","htmlText":"Attacker sends spoofed messages on behalf of another server."},{"level":4,"text":"Attacker sends spoofed messages from a compromised Fediverse server.","anchor":"attacker-sends-spoofed-messages-from-a-compromised-fediverse-server","htmlText":"Attacker sends spoofed messages from a compromised Fediverse server."},{"level":4,"text":"Cosmic ray causes a bit-flip on stored data or the result of a computation.","anchor":"cosmic-ray-causes-a-bit-flip-on-stored-data-or-the-result-of-a-computation","htmlText":"Cosmic ray causes a bit-flip on stored data or the result of a computation."},{"level":4,"text":"Malicious instance administrator attempts to censor Fireproof messages to retain control.","anchor":"malicious-instance-administrator-attempts-to-censor-fireproof-messages-to-retain-control","htmlText":"Malicious instance administrator attempts to censor Fireproof messages to retain control."},{"level":4,"text":"Malicious instance administrator also controls the Public Key Directory.","anchor":"malicious-instance-administrator-also-controls-the-public-key-directory","htmlText":"Malicious instance administrator also controls the Public Key Directory."},{"level":4,"text":"Attacker uses a decoy Public Key Directory that publishes a dishonest history.","anchor":"attacker-uses-a-decoy-public-key-directory-that-publishes-a-dishonest-history","htmlText":"Attacker uses a decoy Public Key Directory that publishes a dishonest history."},{"level":4,"text":"Attacker submits contraband as auxiliary data.","anchor":"attacker-submits-contraband-as-auxiliary-data","htmlText":"Attacker submits contraband as auxiliary data."},{"level":4,"text":"Sharing Accounts","anchor":"sharing-accounts","htmlText":"Sharing Accounts"},{"level":5,"text":"Sharing an  account by sharing the secret key","anchor":"sharing-an--account-by-sharing-the-secret-key","htmlText":"Sharing an  account by sharing the secret key"},{"level":5,"text":"Shared accounts by adding two keys","anchor":"shared-accounts-by-adding-two-keys","htmlText":"Shared accounts by adding two keys"},{"level":2,"text":"Protocol Messages","anchor":"protocol-messages","htmlText":"Protocol Messages"},{"level":3,"text":"AddKey","anchor":"addkey","htmlText":"AddKey"},{"level":4,"text":"AddKey Attributes","anchor":"addkey-attributes","htmlText":"AddKey Attributes"},{"level":4,"text":"AddKey Validation Steps","anchor":"addkey-validation-steps","htmlText":"AddKey Validation Steps"},{"level":3,"text":"RevokeKey","anchor":"revokekey","htmlText":"RevokeKey"},{"level":4,"text":"RevokeKey Attributes","anchor":"revokekey-attributes","htmlText":"RevokeKey Attributes"},{"level":4,"text":"RevokeKey Validation Steps","anchor":"revokekey-validation-steps","htmlText":"RevokeKey Validation Steps"},{"level":3,"text":"RevokeKeyThirdParty","anchor":"revokekeythirdparty","htmlText":"RevokeKeyThirdParty"},{"level":4,"text":"RevokeKeyThirdParty Attributes","anchor":"revokekeythirdparty-attributes","htmlText":"RevokeKeyThirdParty Attributes"},{"level":4,"text":"RevokeKeyThirdParty Validation Steps","anchor":"revokekeythirdparty-validation-steps","htmlText":"RevokeKeyThirdParty Validation Steps"},{"level":3,"text":"MoveIdentity","anchor":"moveidentity","htmlText":"MoveIdentity"},{"level":4,"text":"MoveIdentity Attributes","anchor":"moveidentity-attributes","htmlText":"MoveIdentity Attributes"},{"level":4,"text":"MoveIdentity Validation Steps","anchor":"moveidentity-validation-steps","htmlText":"MoveIdentity Validation Steps"},{"level":3,"text":"BurnDown","anchor":"burndown","htmlText":"BurnDown"},{"level":4,"text":"BurnDown Attributes","anchor":"burndown-attributes","htmlText":"BurnDown Attributes"},{"level":4,"text":"BurnDown Validation Steps","anchor":"burndown-validation-steps","htmlText":"BurnDown Validation Steps"},{"level":3,"text":"Fireproof","anchor":"fireproof","htmlText":"Fireproof"},{"level":4,"text":"Fireproof Attributes","anchor":"fireproof-attributes","htmlText":"Fireproof Attributes"},{"level":4,"text":"Fireproof Validation Steps","anchor":"fireproof-validation-steps","htmlText":"Fireproof Validation Steps"},{"level":3,"text":"UndoFireproof","anchor":"undofireproof","htmlText":"UndoFireproof"},{"level":4,"text":"UndoFireproof Attributes","anchor":"undofireproof-attributes","htmlText":"UndoFireproof Attributes"},{"level":4,"text":"UndoFireproof Validation Steps","anchor":"undofireproof-validation-steps","htmlText":"UndoFireproof Validation Steps"},{"level":3,"text":"AddAuxData","anchor":"addauxdata","htmlText":"AddAuxData"},{"level":4,"text":"AddAuxData Attributes","anchor":"addauxdata-attributes","htmlText":"AddAuxData Attributes"},{"level":4,"text":"AddAuxData Validation Steps","anchor":"addauxdata-validation-steps","htmlText":"AddAuxData Validation Steps"},{"level":3,"text":"RevokeAuxData","anchor":"revokeauxdata","htmlText":"RevokeAuxData"},{"level":4,"text":"RevokeAuxData Attributes","anchor":"revokeauxdata-attributes","htmlText":"RevokeAuxData Attributes"},{"level":4,"text":"RevokeAuxData Validation Steps","anchor":"revokeauxdata-validation-steps","htmlText":"RevokeAuxData Validation Steps"},{"level":3,"text":"Checkpoint","anchor":"checkpoint","htmlText":"Checkpoint"},{"level":4,"text":"Checkpoint Attributes","anchor":"checkpoint-attributes","htmlText":"Checkpoint Attributes"},{"level":4,"text":"Checkpoint Validation Steps","anchor":"checkpoint-validation-steps","htmlText":"Checkpoint Validation Steps"},{"level":2,"text":"The Federated Public Key Directory","anchor":"the-federated-public-key-directory","htmlText":"The Federated Public Key Directory"},{"level":3,"text":"Encryption of Protocol Messages","anchor":"encryption-of-protocol-messages","htmlText":"Encryption of Protocol Messages"},{"level":4,"text":"Protocol Message Encryption","anchor":"protocol-message-encryption","htmlText":"Protocol Message Encryption"},{"level":4,"text":"Protocol Message Decryption","anchor":"protocol-message-decryption","htmlText":"Protocol Message Decryption"},{"level":3,"text":"Protocol Message Processing","anchor":"protocol-message-processing","htmlText":"Protocol Message Processing"},{"level":4,"text":"Rate-Limiting Bad Requests","anchor":"rate-limiting-bad-requests","htmlText":"Rate-Limiting Bad Requests"},{"level":4,"text":"Protocol Message Parsing","anchor":"protocol-message-parsing","htmlText":"Protocol Message Parsing"},{"level":4,"text":"Handling Protocol Messages","anchor":"handling-protocol-messages","htmlText":"Handling Protocol Messages"},{"level":3,"text":"TOTP","anchor":"totp","htmlText":"TOTP"},{"level":4,"text":"TOTP Configuration","anchor":"totp-configuration","htmlText":"TOTP Configuration"},{"level":4,"text":"TOTP Enrollment","anchor":"totp-enrollment","htmlText":"TOTP Enrollment"},{"level":4,"text":"TOTP Disenrollment","anchor":"totp-disenrollment","htmlText":"TOTP Disenrollment"},{"level":4,"text":"TOTP Rotation","anchor":"totp-rotation","htmlText":"TOTP Rotation"},{"level":4,"text":"TOTP Signatures","anchor":"totp-signatures","htmlText":"TOTP Signatures"},{"level":4,"text":"TOTP Verification","anchor":"totp-verification","htmlText":"TOTP Verification"},{"level":3,"text":"JSON REST API","anchor":"json-rest-api","htmlText":"JSON REST API"},{"level":4,"text":"GET api/actor/:actor_id","anchor":"get-apiactoractor_id","htmlText":"GET api/actor/:actor_id"},{"level":4,"text":"GET api/actor/:actor_id/keys","anchor":"get-apiactoractor_idkeys","htmlText":"GET api/actor/:actor_id/keys"},{"level":4,"text":"GET api/actor/:actor_id/key/:key_id","anchor":"get-apiactoractor_idkeykey_id","htmlText":"GET api/actor/:actor_id/key/:key_id"},{"level":4,"text":"GET api/actor/:actor_id/auxiliary","anchor":"get-apiactoractor_idauxiliary","htmlText":"GET api/actor/:actor_id/auxiliary"},{"level":4,"text":"GET api/actor/:actor_id/auxiliary/:aux_data_id","anchor":"get-apiactoractor_idauxiliaryaux_data_id","htmlText":"GET api/actor/:actor_id/auxiliary/:aux_data_id"},{"level":4,"text":"GET api/history","anchor":"get-apihistory","htmlText":"GET api/history"},{"level":4,"text":"GET api/history/since/:last_hash","anchor":"get-apihistorysincelast_hash","htmlText":"GET api/history/since/:last_hash"},{"level":4,"text":"GET api/history/view/:hash","anchor":"get-apihistoryviewhash","htmlText":"GET api/history/view/:hash"},{"level":4,"text":"GET api/extensions","anchor":"get-apiextensions","htmlText":"GET api/extensions"},{"level":4,"text":"GET api/replicas","anchor":"get-apireplicas","htmlText":"GET api/replicas"},{"level":4,"text":"GET api/replica/:replica_id/{...}","anchor":"get-apireplicareplica_id","htmlText":"GET api/replica/:replica_id/{...}"},{"level":4,"text":"GET api/server-public-key","anchor":"get-apiserver-public-key","htmlText":"GET api/server-public-key"},{"level":4,"text":"POST api/revoke","anchor":"post-apirevoke","htmlText":"POST api/revoke"},{"level":4,"text":"POST api/totp/disenroll","anchor":"post-apitotpdisenroll","htmlText":"POST api/totp/disenroll"},{"level":4,"text":"POST api/totp/enroll","anchor":"post-apitotpenroll","htmlText":"POST api/totp/enroll"},{"level":4,"text":"POST api/totp/rotate","anchor":"post-apitotprotate","htmlText":"POST api/totp/rotate"},{"level":3,"text":"Gossip Protocol","anchor":"gossip-protocol","htmlText":"Gossip Protocol"},{"level":4,"text":"Gossip Protocol Background","anchor":"gossip-protocol-background","htmlText":"Gossip Protocol Background"},{"level":4,"text":"Active Gossip (Checkpoints)","anchor":"active-gossip-checkpoints","htmlText":"Active Gossip (Checkpoints)"},{"level":4,"text":"Passive Gossip (Mirroring)","anchor":"passive-gossip-mirroring","htmlText":"Passive Gossip (Mirroring)"},{"level":5,"text":"Recursive Replication","anchor":"recursive-replication","htmlText":"Recursive Replication"},{"level":5,"text":"Trusted Mirrors","anchor":"trusted-mirrors","htmlText":"Trusted Mirrors"},{"level":4,"text":"Mirror Plaintext Cache Invalidation","anchor":"mirror-plaintext-cache-invalidation","htmlText":"Mirror Plaintext Cache Invalidation"},{"level":3,"text":"Sigsum Integration","anchor":"sigsum-integration","htmlText":"Sigsum Integration"},{"level":4,"text":"Witness Co-Signing","anchor":"witness-co-signing","htmlText":"Witness Co-Signing"},{"level":3,"text":"Auxiliary Data Extensions","anchor":"auxiliary-data-extensions","htmlText":"Auxiliary Data Extensions"},{"level":2,"text":"Cryptography Protocols","anchor":"cryptography-protocols","htmlText":"Cryptography Protocols"},{"level":3,"text":"Protocol Message Encryption","anchor":"protocol-message-encryption-1","htmlText":"Protocol Message Encryption"},{"level":3,"text":"Encrypting Message Attributes to Enable Crypto Shredding","anchor":"encrypting-message-attributes-to-enable-crypto-shredding","htmlText":"Encrypting Message Attributes to Enable Crypto Shredding"},{"level":4,"text":"Recent Merkle Root Included in Plaintext Commitments","anchor":"recent-merkle-root-included-in-plaintext-commitments","htmlText":"Recent Merkle Root Included in Plaintext Commitments"},{"level":3,"text":"Algorithm Suite Versions","anchor":"algorithm-suite-versions","htmlText":"Algorithm Suite Versions"},{"level":4,"text":"Version 1","anchor":"version-1","htmlText":"Version 1"},{"level":5,"text":"Version 1 Constants","anchor":"version-1-constants","htmlText":"Version 1 Constants"},{"level":5,"text":"Version 1 Functions","anchor":"version-1-functions","htmlText":"Version 1 Functions"},{"level":4,"text":"Message Attribute Plaintext Commitment Algorithm","anchor":"message-attribute-plaintext-commitment-algorithm","htmlText":"Message Attribute Plaintext Commitment Algorithm"},{"level":4,"text":"Message Attribute Encryption Algorithm","anchor":"message-attribute-encryption-algorithm","htmlText":"Message Attribute Encryption Algorithm"},{"level":4,"text":"Message Attribute Decryption Algorithm","anchor":"message-attribute-decryption-algorithm","htmlText":"Message Attribute Decryption Algorithm"},{"level":3,"text":"HPKE Cipher Suites","anchor":"hpke-cipher-suites","htmlText":"HPKE Cipher Suites"},{"level":2,"text":"Security Considerations","anchor":"security-considerations","htmlText":"Security Considerations"},{"level":3,"text":"Rules For Cryptography Implementors","anchor":"rules-for-cryptography-implementors","htmlText":"Rules For Cryptography Implementors"},{"level":3,"text":"Cryptographic Agility","anchor":"cryptographic-agility","htmlText":"Cryptographic Agility"},{"level":3,"text":"Interoperability As A Non-Goal","anchor":"interoperability-as-a-non-goal","htmlText":"Interoperability As A Non-Goal"},{"level":3,"text":"Encryption of Protocol Message Attributes","anchor":"encryption-of-protocol-message-attributes","htmlText":"Encryption of Protocol Message Attributes"},{"level":4,"text":"Plaintext Commitment","anchor":"plaintext-commitment","htmlText":"Plaintext Commitment"},{"level":3,"text":"Revocation and Account Recovery","anchor":"revocation-and-account-recovery","htmlText":"Revocation and Account Recovery"},{"level":3,"text":"Minimal Trust of Instance Operators","anchor":"minimal-trust-of-instance-operators","htmlText":"Minimal Trust of Instance Operators"},{"level":4,"text":"Position Statement From the Authors","anchor":"position-statement-from-the-authors","htmlText":"Position Statement From the Authors"},{"level":3,"text":"Availability","anchor":"availability","htmlText":"Availability"},{"level":3,"text":"Reasoning for Encryption of Protocol Messages from Clients","anchor":"reasoning-for-encryption-of-protocol-messages-from-clients","htmlText":"Reasoning for Encryption of Protocol Messages from Clients"},{"level":3,"text":"Quantifying the Trustworthiness of the Public Key Directory","anchor":"quantifying-the-trustworthiness-of-the-public-key-directory","htmlText":"Quantifying the Trustworthiness of the Public Key Directory"}],"lineInfo":{"truncatedLoc":"2599","truncatedSloc":"1886"},"mode":"file"},"image":false,"isCodeownersFile":null,"isPlain":false,"isValidLegacyIssueTemplate":false,"issueTemplate":null,"discussionTemplate":null,"language":"Markdown","languageID":222,"large":false,"planSupportInfo":{"repoIsFork":null,"repoOwnedByCurrentUser":null,"requestFullPath":"/fedi-e2ee/public-key-directory-specification/blob/main/Specification.md","showFreeOrgGatedFeatureMessage":null,"showPlanSupportBanner":null,"upgradeDataAttributes":null,"upgradePath":null},"publishBannersInfo":{"dismissActionNoticePath":"/settings/dismiss-notice/publish_action_from_dockerfile","releasePath":"/fedi-e2ee/public-key-directory-specification/releases/new?marketplace=true","showPublishActionBanner":false},"rawBlobUrl":"https://github.com/fedi-e2ee/public-key-directory-specification/raw/refs/heads/main/Specification.md","renderImageOrRaw":false,"richText":"\u003carticle class=\"markdown-body entry-content container-lg\" itemprop=\"text\"\u003e\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch1 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003ePublic Key Directory Specification\u003c/h1\u003e\u003ca id=\"user-content-public-key-directory-specification\" class=\"anchor\" aria-label=\"Permalink: Public Key Directory Specification\" href=\"#public-key-directory-specification\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThis document defines the Fediverse End-to-End Encryption Public Key Directory (FediE2EE-PKD), which consists of\nActivityPub-enabled directory server software, a protocol for communicating with the directory server, and integration\nwith a transparent, append-only data structure (e.g., based on Merkle trees).\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eCurrent version: v0.1.0\u003c/li\u003e\n\u003cli\u003eAuthors: \u003ca href=\"https://github.com/soatok\"\u003eSoatok Dreamseeker\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eIntroduction\u003c/h2\u003e\u003ca id=\"user-content-introduction\" class=\"anchor\" aria-label=\"Permalink: Introduction\" href=\"#introduction\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eMotivation\u003c/h3\u003e\u003ca id=\"user-content-motivation\" class=\"anchor\" aria-label=\"Permalink: Motivation\" href=\"#motivation\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eOne of the challenges for building any cryptographic protocol in federated or peer-to-peer protocols is establishing\nsome sort of identity for the other parties. This is as true of systems for signing Git commits as it is for\nend-to-end encryption.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThis challenge is not unique to federated systems and is usually solved by some sort of Public Key Infrastructure (PKI).\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003ePublic Key Infrastructures\u003c/h4\u003e\u003ca id=\"user-content-public-key-infrastructures\" class=\"anchor\" aria-label=\"Permalink: Public Key Infrastructures\" href=\"#public-key-infrastructures\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThe classic SSH approach to addressing this problem is \"Trust On First Use\". Simple yet effective in many threat models.\nThe obvious downside of \"Trust On First Use\" is that it creates a race condition that an attacker can exploit to get\ntheir substitute public key trusted first.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe earliest designs for SSL/TLS required the use of Certificate Authorities, whose public keys would be provided by\nthe Operating System as a root of trust. Each CA's public key would then be used to sign a cadre of intermediate\ncertificates, which could in turn be used to sign individual servers' public keys (in the form of Certificates).\nThe downside is that if any of these Certificate Authorities were compromised (as \u003ca href=\"https://www.wired.com/2012/05/flame/\" rel=\"nofollow\"\u003ehas happened with nation states\u003c/a\u003e),\nthe downstream security consequences are immense.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe OpenPGP solution to this problem is called Web of Trust, which involves a long chain of folks signing each other's\npublic keys. The reasoning goes, if your friend's public key was signed by Linus Torvalds, they're probably a legitimate\nLinux kernel contributor. However, if you're trying to establish the identity of someone without strong pre-existing\nsocial ties, this is not a very helpful system.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThis historical context is an oversimplification, of course. It's possible to use SSH with certificate authorities, for\nexample.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIn recent years, the cryptography community has moved towards transparency ledgers for important cryptographic designs.\nTLS certificates are now required to be published in a Certificate Transparency ledger. WhatsApp now uses a mechanism\ncalled \u003ca href=\"https://engineering.fb.com/2023/04/13/security/whatsapp-key-transparency/\" rel=\"nofollow\"\u003eKey Transparency\u003c/a\u003e to secure their\nEnd-to-End Encryption.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eTo that end, we hope to build a PKI for the Fediverse primarily focused on transparency logs. It's important that our\nsolution does not rely on trusted third parties (i.e., Certificate Authorities) for the PKI to be secure.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eUse Case\u003c/h4\u003e\u003ca id=\"user-content-use-case\" class=\"anchor\" aria-label=\"Permalink: Use Case\" href=\"#use-case\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThe primary use case is to support End-to-End Encryption for ActivityPub direct messages between users.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eHowever, we also want to support developers seeking supplemental use cases (e.g., exchanging \u003ca href=\"https://github.com/FiloSottile/age\"\u003eage\u003c/a\u003e\npublic keys for encrypted file sharing).\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eThis Document\u003c/h3\u003e\u003ca id=\"user-content-this-document\" class=\"anchor\" aria-label=\"Permalink: This Document\" href=\"#this-document\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eWe propose a specification for a Public Key Directory server, which acts as both a storage layer and shim for a Merkle\nTree-based append-only data ledger.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eWe specify a protocol for communicating with the Public Key Directory server, which will mostly be performed in the\ncontext of a Fediverse server.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eWe further specify a public JSON REST API for reading public keys for specific Fediverse users, that the Public Key\nDirectory software will implement.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eFinally, we discuss some security considerations for building atop our Public Key Directory server.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eOut Of Scope\u003c/h3\u003e\u003ca id=\"user-content-out-of-scope\" class=\"anchor\" aria-label=\"Permalink: Out Of Scope\" href=\"#out-of-scope\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eClient software behavior is not in scope for this document.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eFediverse server behavior is largely out of scope for this document, provided it correctly implements the protocol to\ncommunicate with the Public Key Directory.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eBackwards compatibility with existing systems (i.e., the PGP ecosystem) is a non-goal.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eLegal compliance frameworks (e.g., GDPR) are largely out of scope. We make some design considerations that aim to\nalleviate specific technical issues that would otherwise \u003cem\u003eintroduce\u003c/em\u003e compliance obstacles, but go no further.\nWe are not lawyers; this document does not contain legal advice.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eNotation and Conventions\u003c/h3\u003e\u003ca id=\"user-content-notation-and-conventions\" class=\"anchor\" aria-label=\"Permalink: Notation and Conventions\" href=\"#notation-and-conventions\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThe key words \"\u003cstrong\u003eMUST\u003c/strong\u003e\", \"\u003cstrong\u003eMUST NOT\u003c/strong\u003e\", \"\u003cstrong\u003eREQUIRED\u003c/strong\u003e\", \"\u003cstrong\u003eSHALL\u003c/strong\u003e\", \"\u003cstrong\u003eSHALL NOT\u003c/strong\u003e\", \"\u003cstrong\u003eSHOULD\u003c/strong\u003e\", \"\u003cstrong\u003eSHOULD NOT\u003c/strong\u003e\",\n\"\u003cstrong\u003eRECOMMENDED\u003c/strong\u003e\", \"\u003cstrong\u003eMAY\u003c/strong\u003e\", and \"\u003cstrong\u003eOPTIONAL\u003c/strong\u003e\" in this document are to be interpreted as described in\n\u003ca href=\"https://datatracker.ietf.org/doc/html/rfc2119\" rel=\"nofollow\"\u003eRFC 2119\u003c/a\u003e.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eConcepts\u003c/h2\u003e\u003ca id=\"user-content-concepts\" class=\"anchor\" aria-label=\"Permalink: Concepts\" href=\"#concepts\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eIdentity Binding\u003c/h3\u003e\u003ca id=\"user-content-identity-binding\" class=\"anchor\" aria-label=\"Permalink: Identity Binding\" href=\"#identity-binding\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThis project will map ActivityPub Actor IDs to a set of one or more Public Keys. Optionally, some number of\nAuxiliary Data records may also be supported, in order for other protocols to build atop the Public Key Directory (PKD).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe task of resolving aliases to Actor IDs is left to the client software.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eMessage Blocks\u003c/h3\u003e\u003ca id=\"user-content-message-blocks\" class=\"anchor\" aria-label=\"Permalink: Message Blocks\" href=\"#message-blocks\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThis project is built atop an append-only transparency log. Each Protocol Message will be processed and appended to the\nledger. The Public Key Directory software will maintain a current state of which public keys and auxiliary data are\ncurrently valid for a given Actor.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAny other machine \u003cstrong\u003eMUST\u003c/strong\u003e be able to reproduce the same state as the Public Key Directory by replaying the entire\nmessage history from the first block to the current one. Any deviation from this behavior is considered an attempted\nattack on the system.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThis means that history is immutable, with one exception: \u003ca href=\"#message-attribute-shreddability\"\u003ethe ability for the protocol to forget users\u003c/a\u003e.\nThis is achieved by committing encrypted fields to the Merkle tree, and storing an encryption key on the Public Key\nDirectory server until the encryption key's erasure is legally requested.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eEach Protocol Message \u003cstrong\u003eMUST\u003c/strong\u003e be unique. Public Key Directory servers \u003cstrong\u003eMUST\u003c/strong\u003e reject any replayed Protocol Message,\neven if it's otherwise valid.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eImplementations \u003cstrong\u003eSHOULD\u003c/strong\u003e provide a distinct error message for when a unique message has already been accepted and\nprocessed by the system in a very recent period of time. This \u003cstrong\u003eMUST\u003c/strong\u003e be distinct from an error condition.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003ePublic Key Encoding\u003c/h3\u003e\u003ca id=\"user-content-public-key-encoding\" class=\"anchor\" aria-label=\"Permalink: Public Key Encoding\" href=\"#public-key-encoding\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eEach public key will be encoded as an unpadded \u003ca href=\"https://datatracker.ietf.org/doc/html/rfc4648#section-5\" rel=\"nofollow\"\u003ebase64url\u003c/a\u003e\nstring prefixed by the cryptography protocol name followed by a colon.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eFor example: \u003ccode\u003eed25519:Tm2XBvb0mAb4ldVubCzvz0HMTczR8VGF44sv478VFLM\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eMerkle Root Encoding\u003c/h3\u003e\u003ca id=\"user-content-merkle-root-encoding\" class=\"anchor\" aria-label=\"Permalink: Merkle Root Encoding\" href=\"#merkle-root-encoding\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eEach Merkle Root will be encoded as an unpadded \u003ca href=\"https://datatracker.ietf.org/doc/html/rfc4648#section-5\" rel=\"nofollow\"\u003ebase64url\u003c/a\u003e\nstring, prefixed with a distinct prefix for the current protocol version followed by a colon (currently, \u003ccode\u003epkd-mr-v1:\u003c/code\u003e).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eFor example: \u003ccode\u003epkd-mr-v1:7TwKAbkiKCCQuCpDBV2GbkkkIDfMg2AmG7TMHqXBDJU\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eProtocol Signatures\u003c/h3\u003e\u003ca id=\"user-content-protocol-signatures\" class=\"anchor\" aria-label=\"Permalink: Protocol Signatures\" href=\"#protocol-signatures\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eEvery \u003ca href=\"#protocol-messages\"\u003eProtocol Message\u003c/a\u003e will contain a digital signature. Unless otherwise specified, these\nsignatures will always be calculated the same way:\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eEach digital signature will be calculated over the following information (in this order):\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eThe value of the top-level \u003ccode\u003e!pkd-context\u003c/code\u003e attribute.\u003c/li\u003e\n\u003cli\u003eThe value of the top-level \u003ccode\u003eaction\u003c/code\u003e attribute.\u003c/li\u003e\n\u003cli\u003eThe JSON serialization of the top-level \u003ccode\u003emessage\u003c/code\u003e attribute.\nObject keys \u003cstrong\u003eMUST\u003c/strong\u003e be sorted in ASCII byte order, and there \u003cstrong\u003eMUST\u003c/strong\u003e be no duplicate keys.\u003c/li\u003e\n\u003cli\u003eThe value of the top-level \u003ccode\u003erecent-merkle-root\u003c/code\u003e attribute.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp dir=\"auto\"\u003eTo ensure domain separation, we will use \u003ca href=\"https://github.com/paseto-standard/paseto-spec/blob/master/docs/01-Protocol-Versions/Common.md#pae-definition\"\u003ePASETO's PAE()\u003c/a\u003e\nfunction, with a tweak: We will insert the top-level key (\u003ccode\u003e!pkd-context\u003c/code\u003e, \u003ccode\u003eaction\u003c/code\u003e, \u003ccode\u003emessage\u003c/code\u003e, \u003ccode\u003erecent-merkle-root\u003c/code\u003e)\nbefore each piece.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eFor example, a Python function might look like this:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-python notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"def signPayload(secret_key, payload):\n    payloadToSign = preAuthEncode([\n        b'!pkd-context',\n        payload['!pkd-context'],\n        b'action',\n        payload['action'],\n        b'message',\n        json_stringify(sort_by_key(payload['message'])),\n        b'recent-merkle-root',\n        payload['recent-merkle-root'],\n    ])\n    return base64url(crypto_sign(secret_key, payloadToSign))\"\u003e\u003cpre\u003e\u003cspan class=\"pl-k\"\u003edef\u003c/span\u003e \u003cspan class=\"pl-en\"\u003esignPayload\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003esecret_key\u003c/span\u003e, \u003cspan class=\"pl-s1\"\u003epayload\u003c/span\u003e):\n    \u003cspan class=\"pl-s1\"\u003epayloadToSign\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-en\"\u003epreAuthEncode\u003c/span\u003e([\n        \u003cspan class=\"pl-s\"\u003eb'!pkd-context'\u003c/span\u003e,\n        \u003cspan class=\"pl-s1\"\u003epayload\u003c/span\u003e[\u003cspan class=\"pl-s\"\u003e'!pkd-context'\u003c/span\u003e],\n        \u003cspan class=\"pl-s\"\u003eb'action'\u003c/span\u003e,\n        \u003cspan class=\"pl-s1\"\u003epayload\u003c/span\u003e[\u003cspan class=\"pl-s\"\u003e'action'\u003c/span\u003e],\n        \u003cspan class=\"pl-s\"\u003eb'message'\u003c/span\u003e,\n        \u003cspan class=\"pl-en\"\u003ejson_stringify\u003c/span\u003e(\u003cspan class=\"pl-en\"\u003esort_by_key\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003epayload\u003c/span\u003e[\u003cspan class=\"pl-s\"\u003e'message'\u003c/span\u003e])),\n        \u003cspan class=\"pl-s\"\u003eb'recent-merkle-root'\u003c/span\u003e,\n        \u003cspan class=\"pl-s1\"\u003epayload\u003c/span\u003e[\u003cspan class=\"pl-s\"\u003e'recent-merkle-root'\u003c/span\u003e],\n    ])\n    \u003cspan class=\"pl-k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"pl-en\"\u003ebase64url\u003c/span\u003e(\u003cspan class=\"pl-en\"\u003ecrypto_sign\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003esecret_key\u003c/span\u003e, \u003cspan class=\"pl-s1\"\u003epayloadToSign\u003c/span\u003e))\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThe \u003ccode\u003e!pkd-context\u003c/code\u003e strings are intended to provide domain separation.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eRaw hashes and signatures without any domain separation in the direct scope of this specification are considered a\nsecurity vulnerability.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eRaw hashes or signatures in the Merkle Tree, or in protocols built atop the Public Key Directory, are not considered\nsecurity vulnerabilities in our specification.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eKey Identifiers\u003c/h3\u003e\u003ca id=\"user-content-key-identifiers\" class=\"anchor\" aria-label=\"Permalink: Key Identifiers\" href=\"#key-identifiers\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eEvery time an \u003ccode\u003eAddKey\u003c/code\u003e message is accepted by the Public Key Directory, the PKD will generate a 256-bit random unique\n\u003ccode\u003ekey-id\u003c/code\u003e for that public key. This value is not secret or sensitive in any way, and is only used to point to an existing\npublic key to reduce the amount of rejected signatures software must publish.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eEvery message except revocations and the first \u003ccode\u003eAddKey\u003c/code\u003e for an Actor \u003cstrong\u003eSHOULD\u003c/strong\u003e include a \u003ccode\u003ekey-id\u003c/code\u003e value.\nEach \u003ccode\u003ekey-id\u003c/code\u003e is encoded as an unpadded \u003ca href=\"https://datatracker.ietf.org/doc/html/rfc4648#section-5\" rel=\"nofollow\"\u003ebase64url\u003c/a\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe \u003ccode\u003ekey-id\u003c/code\u003e attribute \u003cstrong\u003eMUST NOT\u003c/strong\u003e be an encoded representation of the public key. The motivation for this restriction\nis to prevent accidental misuse (i.e., someone just decoding the public key from a message and trusting it blindly).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe \u003ccode\u003ekey-id\u003c/code\u003e is not covered in the protocol messages being signed. Instead, it is a hint to the signature validation\nsoftware which public key to select when there is more than one option. Their values are totally arbitrary and, aside\nfrom uniqueness, serve no other purpose.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eRevocation Tokens\u003c/h3\u003e\u003ca id=\"user-content-revocation-tokens\" class=\"anchor\" aria-label=\"Permalink: Revocation Tokens\" href=\"#revocation-tokens\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eA revocation token is a compact token that a user can issue at any time to revoke an existing public key. If they issue\na revocation against their only public key, the Public Key Directory will treat it as a \u003ccode\u003eBurnDown\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eRevocation tokens are \u003ca href=\"https://datatracker.ietf.org/doc/html/rfc4648#section-5\" rel=\"nofollow\"\u003ebase64url\u003c/a\u003e-encoded strings in the\nfollowing format:\u003c/p\u003e\n\u003cdiv class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"tmp := version || REVOCATION_CONSTANT || public_key \nrevocation_token := base64url_encode(tmp || Sign(secret_key, tmp))\"\u003e\u003cpre class=\"notranslate\"\u003e\u003ccode\u003etmp := version || REVOCATION_CONSTANT || public_key \nrevocation_token := base64url_encode(tmp || Sign(secret_key, tmp))\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eWhere:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003eversion\u003c/code\u003e is the version of the protocol being used (currently, \u003ccode\u003eFediPKD1\u003c/code\u003e).\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eREVOCATION_CONSTANT\u003c/code\u003e is a domain-separated constant for revoking an existing key. Its current value is\nthe \u003ccode\u003e0xFE\u003c/code\u003e byte repeated 32 times followed by \u003ccode\u003erevoke-public-key\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eSign(sk, m)\u003c/code\u003e performs the digital signature algorithm corresponding to the current protocol version.\n(Currently, Ed25519.)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eThese values \u003cstrong\u003eMAY\u003c/strong\u003e be encrypted and stored in case of emergency. There is no temporal or random component to the\nmessage format, so they can be issued at any time.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIf you stumble upon another user's secret key, generating a revocation token should be straightforward.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eSecurity researchers are encouraged to push revocation tokens whenever another person's secret key is compromised, and\nsaid security researcher has deemed it necessary to do so to minimize harm.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eAuxiliary Data\u003c/h3\u003e\u003ca id=\"user-content-auxiliary-data\" class=\"anchor\" aria-label=\"Permalink: Auxiliary Data\" href=\"#auxiliary-data\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThe Public Key Directory will advertise a list of Auxiliary Extensions, which can be developed at a later time, that\ndefine the types and formats of Auxiliary Data that will be accepted by a particular PKD server.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eFor example, a PKD Server may include \u003ccode\u003eage-v1\u003c/code\u003e in its list of Auxiliary Extensions, which in turn allows users to submit\n\u003ccode\u003eAddAuxData\u003c/code\u003e and \u003ccode\u003eRevokeAuxData\u003c/code\u003e messages that include an \u003ca href=\"https://github.com/FiloSottile/age\"\u003eage v1\u003c/a\u003e public key.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe intent of Auxiliary Data is to allow developers to build their PKD extensions in order to integrate  with their own\nsystems without interfering with the normal operation of the PKD server. This also allows us to be stricter about our\ncryptography primitive choices.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eFor example, if someone wanted to build a protocol that used \u003ccode\u003essh-rsa\u003c/code\u003e public keys, they can without us needing to\nnatively support RSA at all. They'll just need to shove them into Auxiliary Data.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eAuxiliary Data Identifiers\u003c/h4\u003e\u003ca id=\"user-content-auxiliary-data-identifiers\" class=\"anchor\" aria-label=\"Permalink: Auxiliary Data Identifiers\" href=\"#auxiliary-data-identifiers\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eEvery Auxiliary Data will have a deterministic unique identifier based on the extension and the contents of the data.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIt can be calculated as follows, using the \u003ccode\u003epreAuthEncode\u003c/code\u003e function from PASETO (PAE):\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-python notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"def getAuxDataId(aux_type, data):\n    return hmac_sha256(\n        b'FediPKD1-Auxiliary-Data-IDKeyGen', # this key is a constant for v1 of this protocol specification\n        PAE([\n            b'aux_type',\n            aux_type,\n            b'data',\n            data\n        ])\n    )\"\u003e\u003cpre\u003e\u003cspan class=\"pl-k\"\u003edef\u003c/span\u003e \u003cspan class=\"pl-en\"\u003egetAuxDataId\u003c/span\u003e(\u003cspan class=\"pl-s1\"\u003eaux_type\u003c/span\u003e, \u003cspan class=\"pl-s1\"\u003edata\u003c/span\u003e):\n    \u003cspan class=\"pl-k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"pl-en\"\u003ehmac_sha256\u003c/span\u003e(\n        \u003cspan class=\"pl-s\"\u003eb'FediPKD1-Auxiliary-Data-IDKeyGen'\u003c/span\u003e, \u003cspan class=\"pl-c\"\u003e# this key is a constant for v1 of this protocol specification\u003c/span\u003e\n        \u003cspan class=\"pl-en\"\u003ePAE\u003c/span\u003e([\n            \u003cspan class=\"pl-s\"\u003eb'aux_type'\u003c/span\u003e,\n            \u003cspan class=\"pl-s1\"\u003eaux_type\u003c/span\u003e,\n            \u003cspan class=\"pl-s\"\u003eb'data'\u003c/span\u003e,\n            \u003cspan class=\"pl-s1\"\u003edata\u003c/span\u003e\n        ])\n    )\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eRequirements for Auxiliary Data Extensions\u003c/h4\u003e\u003ca id=\"user-content-requirements-for-auxiliary-data-extensions\" class=\"anchor\" aria-label=\"Permalink: Requirements for Auxiliary Data Extensions\" href=\"#requirements-for-auxiliary-data-extensions\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eBeing very strict about the format of the data accepted by a given extension is highly \u003cstrong\u003eRECOMMENDED\u003c/strong\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eSee \u003ca href=\"#attacker-submits-contraband-as-auxiliary-data\"\u003ethe relevant threat model entry\u003c/a\u003e_\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eMessage Attribute Shreddability\u003c/h3\u003e\u003ca id=\"user-content-message-attribute-shreddability\" class=\"anchor\" aria-label=\"Permalink: Message Attribute Shreddability\" href=\"#message-attribute-shreddability\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eWhile the security benefits of a public immutable append-only ledger are enormous, some jurisdictions may rule that an\nActor ID is in scope of some legislation; e.g., the European Union's Right to be Forgotten (part of the GDPR). The\nintroduction of an append-only immutable data ledger is not logically compatible with these laws (which stipulate that\na person can request their history be deleted on demand).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003ePresently, there is no clear legal guidance on how to best navigate this issue. There are untested legal theories, but\nnone backed up by case law. Additionally, using a totally anonymous look-up-table introduces the risk of rewritten\non-the-fly by the Public Key Directory administrators. This is an unacceptable risk.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAs a best-effort, good faith design decision, we will introduce the technical capability to \"shred\" Actor IDs and other\nmessage attributes (which may contain usernames, and usernames are definitely personal data in scope of the \u003cem\u003eRight\nto be Forgotten\u003c/em\u003e).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eConsequently, we will add a layer of indirection to the underlying Message storage and Sigsum integration, for handling\nsensitive attributes (e.g., Actor ID):\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eEvery Message will have a unique 256-bit random key per sensitive attribute. These can be generated client-side or provided by the Public Key\nDirectory, so long as the keys never repeat. The Public Key Directory will include a key-generation API endpoint for\ngenerating 256-bit keys for this purpose.\u003c/li\u003e\n\u003cli\u003eEach attribute will be encrypted with the corresponding key from (1), using a committing authenticated encryption mode.\nThe encryption steps are described in \u003ca href=\"#message-attribute-encryption-algorithm\"\u003ea later section\u003c/a\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp dir=\"auto\"\u003eDuring insert, of an attribute clients will provide both an encrypted representation of the attributes value in \u003ccode\u003emessage.\u0026lt;attribute\u0026gt;\u003c/code\u003e, and disclose\nthe accompanying key in the \u003ccode\u003esymmetric-keys.\u0026lt;attribute\u0026gt;\u003c/code\u003e (outside of \u003ccode\u003emessage.\u003c/code\u003e, and not covered by the signature).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eWhen requesting data from the ledger, the Message will be returned as-is (i.e., ciphertext), along with the decrypted\nMessage (provided the key has not been shredded yet).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eTo ensure the link between the encrypted message and plaintext message is provable, clients will also generate and\npublish a commitment of the plaintext. This prevents a server from serving the wrong plaintext alongside a given\nciphertext and fooling clients into believing it.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe keys are not included in the Sigsum data, but stored alongside the record in a separate editable database.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe decrypted message is also not included in the Sigsum data.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eTo satisfy a \"right to be forgotten\" request, the key for the relevant blocks will be erased. The ciphertext will\npersist forever, but without the correct key, the contents will be indistinguishable from randomness. Thus, the system\nwill irrevocably forget the Actor ID or other message attribute for those records.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIt's important to note that this is not a security feature, it's meant to eliminate a compliance obstacle.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eCrypto-shredding and message attribute encryption are intended to allow the system to forget how to read a specific\nrecord while still maintaining an immutable history.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eNote: We considered using a zero-knowledge proof for this purpose, but couldn't justify the additional protocol\ncomplexity. For the curious, one of the authors of this specification\n\u003ca href=\"https://soatok.blog/2024/11/21/key-transparency-and-the-right-to-be-forgotten/\" rel=\"nofollow\"\u003eblogged about this topic in depth\u003c/a\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003eIt does not guarantee that other clients and servers did not persist the key necessary to comprehend the contents of the\ndeleted records, since it's generated client-side, and we cannot control the behavior of client software. However, it\ndoes mean that the liability is with those other clients and servers rather than our ledger, and that is sufficient for\nde-risking our use case.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eTimestamps\u003c/h3\u003e\u003ca id=\"user-content-timestamps\" class=\"anchor\" aria-label=\"Permalink: Timestamps\" href=\"#timestamps\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAll timestamps must be a string representing a 64-bit UNIX Timestamp, encoded in base-10. For example, \u003ccode\u003e\"1724364843\"\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eWe choose strings here to allow implementations to parse it as a BigInt (or equivalent) in their respective programming\nlanguage without the JSON parser automatically losing precision for large values (e.g., larger than 2^{53} in\nJavaScript).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eImplementations \u003cstrong\u003eMUST NOT\u003c/strong\u003e truncate UNIX timestamps to 32 bits.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eThreat Model\u003c/h2\u003e\u003ca id=\"user-content-threat-model\" class=\"anchor\" aria-label=\"Permalink: Threat Model\" href=\"#threat-model\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIn order to understand the security goals of this system, it is important to assess our assumptions, assets, actors, and\nthe risks; both the risks that this system is designed to mitigate and the ones it cannot.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eAssumptions\u003c/h3\u003e\u003ca id=\"user-content-assumptions\" class=\"anchor\" aria-label=\"Permalink: Assumptions\" href=\"#assumptions\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eThe operating system's random number generator is secure.\u003c/li\u003e\n\u003cli\u003eThe hardware that our software is running on has not been tampered with to render its operation insecure.\u003c/li\u003e\n\u003cli\u003eThe elliptic curve discrete logarithm problem is computationally hard.\u003c/li\u003e\n\u003cli\u003eThe SHA-2 family of hash functions (SHA-256, SHA-384, SHA-512) are secure.\u003c/li\u003e\n\u003cli\u003eHMAC, used with a SHA-2 family hash function, offers PRF security congruent to the size of the hash function.\u003c/li\u003e\n\u003cli\u003eAES is a secure block cipher (which can be modeled as a secure permutation) that offers a security level congruent\nto the length of its key.\u003c/li\u003e\n\u003cli\u003eEdDSA, as defined over the Edwards25519 curve, provides strong existential forgery under chosen message attack\n(SUF-CMA) security, at a security level in excess of 120 bits.\u003c/li\u003e\n\u003cli\u003eArgon2id is a secure, memory-hard password-based key derivation function.\u003c/li\u003e\n\u003cli\u003eHKDF with HMAC and a SHA-2 family hash function, with a static salt and variable info parameters, provides KDF\nsecurity (which is a stronger notion than PRF security that makes no assumptions about the distribution of IKM bits).\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://datatracker.ietf.org/doc/rfc9180/\" rel=\"nofollow\"\u003eHPKE (RFC 9180)\u003c/a\u003e--when instantiated as\n\u003ca href=\"#hpke-cipher-suites\"\u003eCurve25519_SHA256_ChachaPoly\u003c/a\u003e--provides IND-CCA2 security against adversaries not in\npossession of the X25519 secret key.\u003c/li\u003e\n\u003cli\u003eAES in Counter Mode can be used to encrypt up to 2^{36} successive bytes under the same (key, initial counter),\nand the resulting ciphertext will be indistinguishable an encryption of NUL (\u003ccode\u003e0x00\u003c/code\u003e) bytes.\u003c/li\u003e\n\u003cli\u003eMerkle trees based on a secure hash function (assumption 4) provide a secure verifiable data structure.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eAssets\u003c/h3\u003e\u003ca id=\"user-content-assets\" class=\"anchor\" aria-label=\"Permalink: Assets\" href=\"#assets\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eJSON REST API, available over HTTPS.\u003c/li\u003e\n\u003cli\u003eActivityPub integration.\u003c/li\u003e\n\u003cli\u003eSigsum integration.\u003c/li\u003e\n\u003cli\u003eShreddable symmetric-key storage.\u003c/li\u003e\n\u003cli\u003eLocal relational database.\u003c/li\u003e\n\u003cli\u003eMapping of Actor IDs to associated data.\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003ePublic Keys\u003c/li\u003e\n\u003cli\u003eAuxiliary Data\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eActivityPub instance software. (\u003cstrong\u003eOut of scope.\u003c/strong\u003e)\u003c/li\u003e\n\u003cli\u003eClient-side software. (\u003cstrong\u003eOut of scope.\u003c/strong\u003e)\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eActors\u003c/h3\u003e\u003ca id=\"user-content-actors\" class=\"anchor\" aria-label=\"Permalink: Actors\" href=\"#actors\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIn this section, Actors does not refer specifically to ActivityPub Actors. Rather, they are placeholders for\nparticipants in our system. This includes legitimate users and various types of attackers. These actors' names are\ndefined in alphabetical order within each classification.\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003e\u003cstrong\u003eHonest users\u003c/strong\u003e that wish to communicate. We will use four examples when discussing threats.\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003cstrong\u003eAlice\u003c/strong\u003e is a Fediverse user and instance administrator.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eBob\u003c/strong\u003e is a Fediverse user hosted by Alice's instance.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCarol\u003c/strong\u003e is a self-hosted Fediverse user who runs her own instance.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eDave\u003c/strong\u003e is a Fediverse user on Richard's instance. (Richard is defined below.)\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAttackers\u003c/strong\u003e are motivated individuals that seek to damage or impair the normal operation of the system.\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003cstrong\u003eGrace\u003c/strong\u003e is a government representative for a hostile nation-state that does not want citizens to have privacy.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHarry\u003c/strong\u003e is a cyber-stalker that seeks to harass one or more of the honest users.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eKaren\u003c/strong\u003e is a Troy (defined below) that pretends to be a Eugene and goes directly to the legal system to cause\noperator distress.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eMallory\u003c/strong\u003e wishes to replace one of the honest users' public keys with her own.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRichard\u003c/strong\u003e is an instance administrator that wishes to eavesdrop on his users' private communications.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTroy\u003c/strong\u003e is an Internet troll that wants to wreak havoc for the lulz.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eYvonne\u003c/strong\u003e has privileged access to a Public Key Directory server.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eOther Participants\u003c/strong\u003e do not fall into either of the previous attackers.\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003cstrong\u003eEugene\u003c/strong\u003e used to be an honest user, but now seeks to have the system forget he ever existed. When Eugene is\nsecretly actually a Troy that escalates to the legal system early, we consider them Karen instead.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eRisks\u003c/h3\u003e\u003ca id=\"user-content-risks\" class=\"anchor\" aria-label=\"Permalink: Risks\" href=\"#risks\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThis section seeks to outline specific risks and whether they are prevented, mitigated, addressable, or open.\u003c/p\u003e\n\u003cmarkdown-accessiblity-table\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eRisk\u003c/th\u003e\n\u003cth\u003eStatus\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ca href=\"#attackers-seek-to-change-history\"\u003eAttackers seek to change history.\u003c/a\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cstrong\u003ePrevented by design\u003c/strong\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ca href=\"#attackers-seek-to-selectively-censor-historical-records\"\u003eAttackers seek to selectively censor historical records.\u003c/a\u003e\u003c/td\u003e\n\u003ctd\u003eAddressable\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ca href=\"#attackers-seek-to-replace-public-key-mappings-without-altering-the-ledger\"\u003eAttackers seek to replace public key mappings without altering the ledger.\u003c/a\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cstrong\u003ePrevented by design\u003c/strong\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ca href=\"#attackers-seek-to-leverage-plaintext-commitment-to-recover-encrypted-records-whose-keys-were-wiped\"\u003eAttackers seek to leverage plaintext commitment to recover encrypted records whose keys were wiped.\u003c/a\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cstrong\u003ePrevented by design\u003c/strong\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ca href=\"#instance-administrator-enrolls-a-public-key-on-behalf-of-an-un-enrolled-user\"\u003eInstance administrator enrolls a public key on behalf of an un-enrolled user.\u003c/a\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cem\u003eOpen\u003c/em\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ca href=\"#instance-administrator-attempts-to-enroll-a-new-public-key-for-a-previously-enrolled-user\"\u003eInstance administrator attempts to enroll a new public key for a previously enrolled user.\u003c/a\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cstrong\u003ePrevented by design\u003c/strong\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ca href=\"#instance-administrator-attempts-to-reset-the-public-keys-for-a-previously-enrolled-user\"\u003eInstance administrator attempts to reset the public keys for a previously enrolled user.\u003c/a\u003e\u003c/td\u003e\n\u003ctd\u003eAddressable\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ca href=\"#race-condition-between-successful-burndown-and-subsequent-addkey\"\u003eRace condition between successful BurnDown and subsequent AddKey.\u003c/a\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cem\u003eOpen\u003c/em\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ca href=\"#hostile-nation-state-demands-their-public-key-be-added-to-an-existing-actor-under-a-gag-order\"\u003eHostile nation state demands their public key be added to an existing actor under a gag order.\u003c/a\u003e\u003c/td\u003e\n\u003ctd\u003eMitigated\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ca href=\"#hostile-nation-state-seeks-to-abuse-right-to-be-forgotten-mechanisms-to-cover-up-an-unlawful-intrusion\"\u003eHostile nation state seeks to abuse Right To Be Forgotten mechanisms to cover up an unlawful intrusion.\u003c/a\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cem\u003eOpen\u003c/em\u003e / Addressable\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ca href=\"#instance-administrator-loses-all-their-signing-keys\"\u003eInstance administrator loses all their signing keys.\u003c/a\u003e\u003c/td\u003e\n\u003ctd\u003eMitigated\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ca href=\"#attacker-sends-spoofed-messages-on-behalf-of-another-server\"\u003eAttacker sends spoofed messages on behalf of another server.\u003c/a\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cstrong\u003ePrevented by design\u003c/strong\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ca href=\"#attacker-sends-spoofed-messages-from-a-compromised-fediverse-server\"\u003eAttacker sends spoofed messages from a compromised Fediverse server.\u003c/a\u003e\u003c/td\u003e\n\u003ctd\u003eAddressable\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ca href=\"#cosmic-ray-causes-a-bit-flip-on-stored-data-or-the-result-of-a-computation\"\u003eCosmic ray causes a bit-flip on stored data or the result of a computation.\u003c/a\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cem\u003eOpen\u003c/em\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ca href=\"#malicious-instance-administrator-attempts-to-censor-fireproof-messages-to-retain-control\"\u003eMalicious instance administrator attempts to censor Fireproof messages to retain control.\u003c/a\u003e\u003c/td\u003e\n\u003ctd\u003eMitigated\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ca href=\"#malicious-instance-administrator-also-controls-the-public-key-directory\"\u003eMalicious instance administrator also controls the Public Key Directory.\u003c/a\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cem\u003eOpen\u003c/em\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ca href=\"#attacker-uses-a-decoy-public-key-directory-that-publishes-a-dishonest-history\"\u003eAttacker uses a decoy Public Key Directory that publishes a dishonest history.\u003c/a\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cem\u003eOpen\u003c/em\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ca href=\"#attacker-submits-contraband-as-auxiliary-data\"\u003eAttacker submits contraband as auxiliary data.\u003c/a\u003e\u003c/td\u003e\n\u003ctd\u003eAddressable\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/markdown-accessiblity-table\u003e\n\u003cp dir=\"auto\"\u003eEach status is defined as follows:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003cstrong\u003ePrevented by design\u003c/strong\u003e: This risk is prevented (provided our assumptions above hold true) by our specification.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eMitigated\u003c/strong\u003e: This risk is not totally prevented, but its useful consequences for attackers are.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAddressable\u003c/strong\u003e: This risk can be mitigated, but requires another precondition to be true. If it's not true, then this\nrisk is actually Open. The truth value of this precondition may vary from user to user.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eOpen\u003c/strong\u003e: This is a risk that we have not prevented.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eAttackers seek to change history.\u003c/h4\u003e\u003ca id=\"user-content-attackers-seek-to-change-history\" class=\"anchor\" aria-label=\"Permalink: Attackers seek to change history.\" href=\"#attackers-seek-to-change-history\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eStatus\u003c/strong\u003e: Prevented by design.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eMallory seeks to replace one of the honest users' public keys with one she controls so that she can impersonate them\nwhen talking to their friends.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eShe is thwarted from updating old records by the append-only nature of Merkle trees.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eAttackers seek to selectively censor historical records.\u003c/h4\u003e\u003ca id=\"user-content-attackers-seek-to-selectively-censor-historical-records\" class=\"anchor\" aria-label=\"Permalink: Attackers seek to selectively censor historical records.\" href=\"#attackers-seek-to-selectively-censor-historical-records\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eStatus\u003c/strong\u003e: Addressable (can be mitigated; requires diligence).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThere are two variants of this risk.\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eEugene legitimately wishes to have his username and historical public keys wiped from public memory, and asserts his\nrights as a citizenship of a European Union Member State.\u003c/li\u003e\n\u003cli\u003eHarry or Troy seek to disable a legitimate user's ability to use end-to-end encryption by wiping their public keys\nfrom the ledger, thereby forcing them to communicate in plaintext until re-enrolled.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp dir=\"auto\"\u003eEugene is not an attacker. Several design decisions were made to ensure Eugene's request to be forgotten is actually\npossible to enforce in our system.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eMaliciously attempting to censor historical records on behalf of another user is an attack that cannot be mitigated by\ndesign. The operators of Public Key Database instances are responsible for ensuring \u003cem\u003eRight To Be Forgotten\u003c/em\u003e requests are\nlegitimate to prevent this sort of misbehavior.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eAttackers seek to replace public key mappings without altering the ledger.\u003c/h4\u003e\u003ca id=\"user-content-attackers-seek-to-replace-public-key-mappings-without-altering-the-ledger\" class=\"anchor\" aria-label=\"Permalink: Attackers seek to replace public key mappings without altering the ledger.\" href=\"#attackers-seek-to-replace-public-key-mappings-without-altering-the-ledger\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eStatus\u003c/strong\u003e: Prevented by design.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eYvonne, who has privileged access to the Public Key Directory server, wants to replace the plaintext public key that a\nparticular encrypted public key maps to. She wants to do this without altering history.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIn one variant of the attack, she simply updates the plaintext value served by the server. In another, she tries to\nreplace the key used to decrypt the ciphertext with another key.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIn both instances, she is defeated by the \u003ca href=\"#plaintext-commitment\"\u003eplaintext commitment\u003c/a\u003e, and the fact that the attribute\nencryption protocol is key-committing.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eAttackers seek to leverage plaintext commitment to recover encrypted records whose keys were wiped.\u003c/h4\u003e\u003ca id=\"user-content-attackers-seek-to-leverage-plaintext-commitment-to-recover-encrypted-records-whose-keys-were-wiped\" class=\"anchor\" aria-label=\"Permalink: Attackers seek to leverage plaintext commitment to recover encrypted records whose keys were wiped.\" href=\"#attackers-seek-to-leverage-plaintext-commitment-to-recover-encrypted-records-whose-keys-were-wiped\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eStatus\u003c/strong\u003e: Mitigated by design; requires enormous resources to attempt to attack.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAt some point in the past, Eugene requested his data be removed from the ledger, and his request was honored by\n\u003ca href=\"#encrypting-message-attributes-to-enable-crypto-shredding\"\u003eerasing the key\u003c/a\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eLater, Troy decides to attempt to recover the plaintext to undermine the privacy that many Eugenes enjoy by using the\nplaintext commitment to brute force the corresponding plaintext values. Troy's goal is to troll the Public Key Directory\nby convincing regulators that the \u003cem\u003eRight To Be Forgotten\u003c/em\u003e request has not been faithfully fulfilled.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThis attack is extremely economically expensive to pull off. Each plaintext commitment is defined as a combination of\n\u003ca href=\"#recent-merkle-root-included-in-plaintext-commitments\"\u003ea \"recent\" Merkle root\u003c/a\u003e, the attribute name, and the plaintext\nattribute value. This is then hashed with Argon2id, a password hashing function.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eFor example, in order to guess 1 million possible plaintext values per second, Troy would need the computational\nresources to fill 16 terabytes of memory per second. Due to the use of the Merkle root in determining a salt, as well as\nthe plaintext, this attack doesn't parallelize well for many Eugenes.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eInstance administrator enrolls a public key on behalf of an un-enrolled user.\u003c/h4\u003e\u003ca id=\"user-content-instance-administrator-enrolls-a-public-key-on-behalf-of-an-un-enrolled-user\" class=\"anchor\" aria-label=\"Permalink: Instance administrator enrolls a public key on behalf of an un-enrolled user.\" href=\"#instance-administrator-enrolls-a-public-key-on-behalf-of-an-un-enrolled-user\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eStatus\u003c/strong\u003e: Open (but somewhat addressable).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eRichard wants to prevent Dave from using end-to-end encryption. To do this, he signs an \u003ccode\u003eAddKey\u003c/code\u003e protocol message on his\nbehalf before he has an opportunity to enroll his own public key.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThis attack always succeeds. This risk must be acceptable.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eDave has remediation options available to him. There is an immutable public record indicating that Richard misbehaved.\nDave can move to another Fediverse host that isn't malicious. Dave can seek legal or social redress for Richard's\nmisbehavior, equipped with evidence that Richard cannot censor.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eInstance administrator attempts to enroll a new public key for a previously enrolled user.\u003c/h4\u003e\u003ca id=\"user-content-instance-administrator-attempts-to-enroll-a-new-public-key-for-a-previously-enrolled-user\" class=\"anchor\" aria-label=\"Permalink: Instance administrator attempts to enroll a new public key for a previously enrolled user.\" href=\"#instance-administrator-attempts-to-enroll-a-new-public-key-for-a-previously-enrolled-user\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eStatus\u003c/strong\u003e: Prevented by design.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIf a user has an existing public key enrolled in the protocol, the instance administrator cannot issue a self-signed\n\u003ccode\u003eAddKey\u003c/code\u003e message. These messages must be signed by a currently-trusted public key.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThere is an exception to this rule: \u003ca href=\"#burndown\"\u003eBurnDown\u003c/a\u003e, which is a break-glass feature for honest instance\nadministrators to use to help users start over if they lose all their secret keys. BurnDown can be prevented by the\n\u003ca href=\"#fireproof\"\u003eFireproof\u003c/a\u003e protocol message. This is discussed in great detail in the\n\u003ca href=\"#revocation-and-account-recovery\"\u003eSecurity Considerations\u003c/a\u003e.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eInstance administrator attempts to reset the public keys for a previously enrolled user.\u003c/h4\u003e\u003ca id=\"user-content-instance-administrator-attempts-to-reset-the-public-keys-for-a-previously-enrolled-user\" class=\"anchor\" aria-label=\"Permalink: Instance administrator attempts to reset the public keys for a previously enrolled user.\" href=\"#instance-administrator-attempts-to-reset-the-public-keys-for-a-previously-enrolled-user\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eStatus\u003c/strong\u003e: Addressable.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eRichard issues a malicious \u003ccode\u003eBurnDown\u003c/code\u003e for Dave. This only succeeds if Dave's account is not \u003ca href=\"#fireproof\"\u003eFireproof\u003c/a\u003e.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eRace condition between successful BurnDown and subsequent AddKey.\u003c/h4\u003e\u003ca id=\"user-content-race-condition-between-successful-burndown-and-subsequent-addkey\" class=\"anchor\" aria-label=\"Permalink: Race condition between successful BurnDown and subsequent AddKey.\" href=\"#race-condition-between-successful-burndown-and-subsequent-addkey\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eStatus\u003c/strong\u003e: Open.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAfter a successful \u003ccode\u003eBurnDown\u003c/code\u003e, the user's set of public keys is empty, which means the system will tolerate a\nself-signed \u003ccode\u003eAddKey\u003c/code\u003e protocol message from the user's instance.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThis is an acceptable risk, as it's congruent to \u003ca href=\"#instance-administrator-enrolls-a-public-key-on-behalf-of-an-un-enrolled-user\"\u003eun-enrolled users\u003c/a\u003e.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eHostile nation state demands their public key be added to an existing actor under a gag order.\u003c/h4\u003e\u003ca id=\"user-content-hostile-nation-state-demands-their-public-key-be-added-to-an-existing-actor-under-a-gag-order\" class=\"anchor\" aria-label=\"Permalink: Hostile nation state demands their public key be added to an existing actor under a gag order.\" href=\"#hostile-nation-state-demands-their-public-key-be-added-to-an-existing-actor-under-a-gag-order\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eStatus\u003c/strong\u003e: Mitigated. One variant is prevented by design, the other is addressable.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eGrace uses the power of the state to demand Alice insert a chosen public key into Bob's account, so that they can\nintrude on Bob's end-to-end encrypted communications, with some law enforcement justification, accompanied by a strict\ngag order to not reveal the government's order.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eSince Bob is currently enrolled in the protocol, Alice cannot comply with this order.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIf Bob is not Fireproof, there is a possibility for Alice to issue a BurnDown and then issue an AddKey for Bob on behalf\nof Grace. However, this will create immutable evidence of this intrusion, which is incompatible with gag orders.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eHostile nation state seeks to abuse \u003cem\u003eRight To Be Forgotten\u003c/em\u003e mechanisms to cover up an unlawful intrusion.\u003c/h4\u003e\u003ca id=\"user-content-hostile-nation-state-seeks-to-abuse-right-to-be-forgotten-mechanisms-to-cover-up-an-unlawful-intrusion\" class=\"anchor\" aria-label=\"Permalink: Hostile nation state seeks to abuse Right To Be Forgotten mechanisms to cover up an unlawful intrusion.\" href=\"#hostile-nation-state-seeks-to-abuse-right-to-be-forgotten-mechanisms-to-cover-up-an-unlawful-intrusion\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eStatus\u003c/strong\u003e: Open / Addressable.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eGrace instructs Mallory to perform an active attack against a user, then submits a \u003cem\u003eRight To Be Forgotten\u003c/em\u003e request to\nthe Public Key Directory to destroy evidence of their human rights violation. For example, Grace instructs Alice to\nlaunch a \u003ca href=\"#race-condition-between-successful-burndown-and-subsequent-addkey\"\u003eBurnDown then AddKey\u003c/a\u003e against Bob, then\nuses social engineering to gain access to Bob's friends to spy on their activity.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIf Grace has also enlisted Yvonne to perform the cover-up, this attack will succeed (as currently written).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eHowever, it is not without risk: \u003ca href=\"#burndown\"\u003eBurnDowns\u003c/a\u003e are meant to be noisy, rare Protocol Messages that should\ntrigger immediate skepticism for all parties involved. Although they have some legitimate use (i.e., if a user loses\naccess to all their secret keys and devices), they should set off alarm bells for anyone using the Public Key Directory.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eTo address this risk, any software building E2EE on top of the Public Key Directory \u003cstrong\u003eMUST\u003c/strong\u003e immediately demote the\ntrust status of any participants that receive a successful BurnDown. At minimum, this means requiring any higher-level\nvalidation be performed again (e.g., safety number comparison) as if chatting with a stranger.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eObviously, if Grace is unable to enlist Yvonne, and cannot convince the Public Key Directory operator that the \u003cem\u003eRight To\nBe Forgotten\u003c/em\u003e request is legitimate, then Grace's cover-up will not succeed. However, requiring legal acumen to prevent\nmisbehavior is a poor mechanism, so we consider this risk \"Open\" in this case.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eInstance administrator loses all their signing keys.\u003c/h4\u003e\u003ca id=\"user-content-instance-administrator-loses-all-their-signing-keys\" class=\"anchor\" aria-label=\"Permalink: Instance administrator loses all their signing keys.\" href=\"#instance-administrator-loses-all-their-signing-keys\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eStatus\u003c/strong\u003e: Mitigated.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eCarol, who self-hosts her Fediverse account, loses all of her signing keys, and wants to issue a BurnDown.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThis actually isn't a risk, but rather, an operational issue that might come up eventually. We do, however, consider it\nan Availability concern, which still needs to be addressed by any Threat Model.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe Public Key Directory doesn't know (or care) who's an administrator or not.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eAuthorization is the responsibility of your Fediverse server, not the Public Key Directory.\u003c/strong\u003e Although we designate\n\"operator\" in the BurnDown message, that's just to distinguish who signed the request versus which Actor the request is\nfor.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eWhen this happens, Carol can \u003ccode\u003eAddKey\u003c/code\u003e a new account, push a \u003ccode\u003eBurnDown\u003c/code\u003e for her original account, then push an \u003ccode\u003eAddKey\u003c/code\u003e\nfor her new account, using the new account as the \"operator\" role in her Protocol Messages. Then, if she wishes, issue a\n\u003ccode\u003eBurnDown\u003c/code\u003e for her temporary account.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe availability risk to self-hosters that lost all their keys is only present if their previous account is Fireproof.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eAttacker sends spoofed messages on behalf of another server.\u003c/h4\u003e\u003ca id=\"user-content-attacker-sends-spoofed-messages-on-behalf-of-another-server\" class=\"anchor\" aria-label=\"Permalink: Attacker sends spoofed messages on behalf of another server.\" href=\"#attacker-sends-spoofed-messages-on-behalf-of-another-server\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eStatus\u003c/strong\u003e: Prevented by design.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eMallory wants to send a \u003ccode\u003eBurnDown\u003c/code\u003e then \u003ccode\u003eAddKey\u003c/code\u003e to the Public Key Directory to impersonate Bob. To do this, she\npretends to be Alice's Fediverse instance and signs messages, using HTTP Signatures, with a bogus asymmetric keypair.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eWithout further privileges, this attack fails. The Public Key Directory server will asynchronously fetch the Public Key\nto validate an HTTP Signature rather than trusting attacker-controlled data. Unless you can compromise the host instance\nin order to replace the server's public key, you cannot spoof these messages.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eBut that does lead into another risk:\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eAttacker sends spoofed messages from a compromised Fediverse server.\u003c/h4\u003e\u003ca id=\"user-content-attacker-sends-spoofed-messages-from-a-compromised-fediverse-server\" class=\"anchor\" aria-label=\"Permalink: Attacker sends spoofed messages from a compromised Fediverse server.\" href=\"#attacker-sends-spoofed-messages-from-a-compromised-fediverse-server\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eStatus\u003c/strong\u003e: Addressable (but Prevented by Design if Fireproof).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThis is a variant of \u003ca href=\"#attacker-sends-spoofed-messages-on-behalf-of-another-server\"\u003ethe previous threat\u003c/a\u003e, but Mallory\nhas managed to compromise the server in some way; either through a direct software (or hardware) compromise, or a DNS\nhijack and issuing a new TLS certificate for her fake Fediverse server.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAs the specification is currently written, whether this attack succeeds depends on whether the administrators have\nenabled TOTP challenge-response authentication with the Fediverse server. If they have, Mallory cannot succeed without\nalso compromising the administrators' devices or stealing the TOTP secret through some other mechanism.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eHowever, Mallory would be obligated to create immutable evidence of her intrusion that she cannot wipe without\nYvonne's assistance. See also, \u003ca href=\"#hostile-nation-state-seeks-to-abuse-right-to-be-forgotten-mechanisms-to-cover-up-an-unlawful-intrusion\"\u003eabusing \u003cem\u003eRight to Be Forgotten\u003c/em\u003e mechanisms to cover-up intrusions\u003c/a\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eMallory cannot, however, issue a \u003ccode\u003eBurnDown\u003c/code\u003e or \u003ccode\u003eAddKey\u003c/code\u003e for a \u003ca href=\"#fireproof\"\u003eFireproof\u003c/a\u003e user. In this sense, the risk to\nthe user is mitigated \u003cstrong\u003eso long as they use Fireproof\u003c/strong\u003e: You cannot \u003ccode\u003eAddKey\u003c/code\u003e a user with at least one trusted public\nkey, and you cannot \u003ccode\u003eBurnDown\u003c/code\u003e a fireproof user.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAll other Protocol Messages must be signed by the user's secret key, which the Fediverse server \u003cstrong\u003eMUST NOT\u003c/strong\u003e possess.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThere may be future mechanisms we can use to prevent compromised servers or DNS hijacks from successfully sending\nProtocol Messages to the Public Key Directory, but for now we're leaving this risk Open.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eCosmic ray causes a bit-flip on stored data or the result of a computation.\u003c/h4\u003e\u003ca id=\"user-content-cosmic-ray-causes-a-bit-flip-on-stored-data-or-the-result-of-a-computation\" class=\"anchor\" aria-label=\"Permalink: Cosmic ray causes a bit-flip on stored data or the result of a computation.\" href=\"#cosmic-ray-causes-a-bit-flip-on-stored-data-or-the-result-of-a-computation\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eStatus\u003c/strong\u003e: Open.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThere is no specific threat actor here (although Mallory may apply). Instead, this is caused by nature.\n\u003ca href=\"https://web.archive.org/web/20231101000000*/https://groups.google.com/a/chromium.org/g/ct-policy/c/S17_j-WJ6dI\" rel=\"nofollow\"\u003eThis has happened to Certificate Transparency logs before\u003c/a\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eRandom errors can occur in many places:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eA computation being performed\u003c/li\u003e\n\u003cli\u003eData stored in RAM\u003c/li\u003e\n\u003cli\u003eData stored on disk\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eTo mitigate this risk, participants in this network (users and Fediverse Servers) \u003cstrong\u003eSHOULD\u003c/strong\u003e send Protocol Messages to\nmultiple Public Key Directory servers and, in turn, poll multiple servers. Clients \u003cstrong\u003eSHOULD\u003c/strong\u003e additionally be configured\nto require a quorum before trusting its responses.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eMalicious instance administrator attempts to censor Fireproof messages to retain control.\u003c/h4\u003e\u003ca id=\"user-content-malicious-instance-administrator-attempts-to-censor-fireproof-messages-to-retain-control\" class=\"anchor\" aria-label=\"Permalink: Malicious instance administrator attempts to censor Fireproof messages to retain control.\" href=\"#malicious-instance-administrator-attempts-to-censor-fireproof-messages-to-retain-control\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eStatus\u003c/strong\u003e: Mitigated.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eRichard wants to ensure Dave's account is never \u003ca href=\"#fireproof\"\u003eFireproof\u003c/a\u003e, because he wants the ability to issue a\nBurnDown on Dave's behalf at a moment's notice. To that end, his server software is modified to silently drop any\nProtocol Messages sent from any user if the action is set to Fireproof.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eDave can configure his client software to \u003ca href=\"#encryption-of-protocol-messages\"\u003ealways use Protocol Message Encryption\u003c/a\u003e.\nThis ensures that Richard cannot inspect and selectively censor Dave's Protocol Messages. He must choose an\nall-or-nothing approach to which Protocol Messages are passed onto the Public Key Directory.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eFor this reason, users \u003cstrong\u003eSHOULD\u003c/strong\u003e encrypt all of their Protocol Messages, not just \u003ccode\u003eFireproof\u003c/code\u003e messages.\nIt is further \u003cstrong\u003eRECOMMENDED\u003c/strong\u003e for client software to make this encryption the default behavior.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eMalicious instance administrator also controls the Public Key Directory.\u003c/h4\u003e\u003ca id=\"user-content-malicious-instance-administrator-also-controls-the-public-key-directory\" class=\"anchor\" aria-label=\"Permalink: Malicious instance administrator also controls the Public Key Directory.\" href=\"#malicious-instance-administrator-also-controls-the-public-key-directory\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eStatus\u003c/strong\u003e: Open.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eRichard not only hosts Dave's account, but also controls the Public Key Directory used by the local constellation of\nFediverse servers. Richard plans to use his privileged access to selectively reject Fireproof messages, lie about the\nhistory of the transparency log, etc.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eTo address dishonest logs, users can rely on witness co-signatures (part of the Sigsum protocol) to ensure that history\nis unchanged between different perspectives. This aspect is addressable.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eMalicious, selective rejection of protocol messages cannot be addressed by construction. Instead, the independence of\nPublic Key Directory operators from Fediverse instance administrators should be maintained. As this is a social\nmechanism, not a technological one, we consider this risk to remain open.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eAttacker uses a decoy Public Key Directory that publishes a dishonest history.\u003c/h4\u003e\u003ca id=\"user-content-attacker-uses-a-decoy-public-key-directory-that-publishes-a-dishonest-history\" class=\"anchor\" aria-label=\"Permalink: Attacker uses a decoy Public Key Directory that publishes a dishonest history.\" href=\"#attacker-uses-a-decoy-public-key-directory-that-publishes-a-dishonest-history\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eStatus\u003c/strong\u003e: Open.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThere exist multiple Public Key Directories, one controlled by an attacker, and their history disagrees. How does a user\n(or, as the case may be, the tools on behalf of the user) decide which directory is canonical?\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThis is related to \u003ca href=\"#malicious-instance-administrator-also-controls-the-public-key-directory\"\u003emalicious Public Key Directories\u003c/a\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIf every Fediverse instance also has an integrated PKD, rather than relying on a third party (which is what we recommend\nin the \u003ca href=\"/fedi-e2ee/public-key-directory-specification/blob/main/Architecture.md\"\u003eArchitecture\u003c/a\u003e document), this risk is more likely to manifest in the real world.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eHaving few independent Public Key Directories, rather than 1:1 for instances, makes this risk addressable. However, that\nis a social mechanism, not a technological one.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eAttacker submits contraband as auxiliary data.\u003c/h4\u003e\u003ca id=\"user-content-attacker-submits-contraband-as-auxiliary-data\" class=\"anchor\" aria-label=\"Permalink: Attacker submits contraband as auxiliary data.\" href=\"#attacker-submits-contraband-as-auxiliary-data\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eStatus\u003c/strong\u003e: Addressable.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eConsider a Public Key Directory which enables arbitrary, unformatted data to be published to the PKD by users. One day,\nTroy submits \u003ca href=\"https://www.inhope.org/EN/articles/what-is-csam\" rel=\"nofollow\"\u003eCSAM\u003c/a\u003e to the ledger, then notifies law enforcement of\nthis material being published on the Public Key Directory instance.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eTo prevent this risk, extensions \u003cstrong\u003eSHOULD\u003c/strong\u003e be strict about the data they accept.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eFailing that, instance operators can use the \u003ca href=\"#message-attribute-shreddability\"\u003emessage content shredability\u003c/a\u003e mechanism\nto wipe unwanted illegal material from their records by wiping the decryption key for that record.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eSharing Accounts\u003c/h4\u003e\u003ca id=\"user-content-sharing-accounts\" class=\"anchor\" aria-label=\"Permalink: Sharing Accounts\" href=\"#sharing-accounts\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIt is possible that a group of users wants to share one Fediverse account. For example if they are part of an organisation which wants to receive encrypted messages, but share the work between the group. (E.g.\na whistleblower hotline).\nFor the following we assume the smallest possible group of Bob and Troy, but all scenarios will affect larger groups, but they require just a single Troy.\nWhile this would not affect the groups ability to use the Fediverse account and accessing the Fediverse server, it sabotages all interactions where the key is used (E.g. reading e2ee messages.)\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch5 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eSharing an  account by sharing the secret key\u003c/h5\u003e\u003ca id=\"user-content-sharing-an--account-by-sharing-the-secret-key\" class=\"anchor\" aria-label=\"Permalink: Sharing an  account by sharing the secret key\" href=\"#sharing-an--account-by-sharing-the-secret-key\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eStatus:\u003c/strong\u003e Open / out of scope\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIf Bob and Troy share an account by sharing a secret key, Troy can replace that key with his own, by send one \u003ccode\u003eAddKey\u003c/code\u003e message to insert a new key only know to Troy and sending a \u003ccode\u003eRevokeKey\u003c/code\u003e message which removes the shared key.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eFurther can Troy send a \u003ccode\u003eFireproof\u003c/code\u003e message for the shared account and by doing so make it impossible for Bob to regain the identity.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch5 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eShared accounts by adding two keys\u003c/h5\u003e\u003ca id=\"user-content-shared-accounts-by-adding-two-keys\" class=\"anchor\" aria-label=\"Permalink: Shared accounts by adding two keys\" href=\"#shared-accounts-by-adding-two-keys\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eStatus:\u003c/strong\u003e Open / out of scope\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIf Bob and Troy share an account by adding two keys for one identity in the PKD and Bob and Troy have each one of the keys, it is possible for Troy to send a \u003ccode\u003eRevokeKey\u003c/code\u003e message for Bobs key which is signed by Troys key.\nFurther can Troy send a \u003ccode\u003eFireproof\u003c/code\u003e message, to make it impossible for Bob to regain the identity.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eProtocol Messages\u003c/h2\u003e\u003ca id=\"user-content-protocol-messages\" class=\"anchor\" aria-label=\"Permalink: Protocol Messages\" href=\"#protocol-messages\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThis section outlines the different message types that will be passed from the Fediverse Server to the Public Key\nDirectory server.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eEach protocol message will be a UTF-8 encoded JSON string. Dictionary keys \u003cstrong\u003eMUST\u003c/strong\u003e be unique within the same level.\nDictionary keys \u003cstrong\u003eSHOULD\u003c/strong\u003e be sorted. Participants \u003cstrong\u003eMAY\u003c/strong\u003e use whitespace, but it is not required or recommended.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eMost protocol messages will consist of the same structure. Each Protocol Message is formally defined in subsequent\nsubsections of this document:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{\n  /* The version number used in !pkd-context may change in the future: */\n  \u0026quot;!pkd-context\u0026quot;: \u0026quot;https://github.com/fedi-e2ee/public-key-directory/v1\u0026quot;,\n  /* The action, such as AddKey or RevokeKey, goes here: */\n  \u0026quot;action\u0026quot;: \u0026quot;\u0026quot;,\n  // key-id sometimes goes here\n  \u0026quot;message\u0026quot;: {\n    /* \n    The actual message contents required for the specific action goes here.\n    Its contents may vary from action to action.\n    */\n  },\n  /* A recent Merkle root (if applicable) for a previous message: */\n  \u0026quot;recent-merkle-root\u0026quot;: \u0026quot;\u0026quot;, \n  /* A signature calculated over \u0026quot;!pkd-context\u0026quot;, \u0026quot;action\u0026quot;, \u0026quot;recent-merkle-root\u0026quot;, and \u0026quot;message\u0026quot;: */\n  \u0026quot;signature\u0026quot;: \u0026quot;\u0026quot;,\n  \u0026quot;symmetric-keys\u0026quot;: {\n    /* These are used to decrypt attributes in the \u0026quot;message\u0026quot; object. They are not signed.\n     * This feature also only exists for compliance purposes, not to accomplish security goals.\n     * These are disclosed to the server, but not echoed to clients. Instead, plaintext will be served back. */\n  }\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"pl-c\"\u003e/* The version number used in !pkd-context may change in the future: */\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"!pkd-context\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"https://github.com/fedi-e2ee/public-key-directory/v1\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-c\"\u003e/* The action, such as AddKey or RevokeKey, goes here: */\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"action\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-c\"\u003e// key-id sometimes goes here\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"message\"\u003c/span\u003e: \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"pl-c\"\u003e/* \u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e    The actual message contents required for the specific action goes here.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e    Its contents may vary from action to action.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e    */\u003c/span\u003e\n  \u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-c\"\u003e/* A recent Merkle root (if applicable) for a previous message: */\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"recent-merkle-root\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \n  \u003cspan class=\"pl-c\"\u003e/* A signature calculated over \"!pkd-context\", \"action\", \"recent-merkle-root\", and \"message\": */\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"signature\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"symmetric-keys\"\u003c/span\u003e: \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"pl-c\"\u003e/* These are used to decrypt attributes in the \"message\" object. They are not signed.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e     * This feature also only exists for compliance purposes, not to accomplish security goals.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e     * These are disclosed to the server, but not echoed to clients. Instead, plaintext will be served back. */\u003c/span\u003e\n  \u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eSome protocol messages \u003cstrong\u003eSHOULD\u003c/strong\u003e also include a top level \u003ccode\u003e\"key-id\"\u003c/code\u003e attribute, which will help implementations select\none of many public keys to validate the signature. If no \u003ccode\u003ekey-id\u003c/code\u003e is provided, each valid public key \u003cstrong\u003eMAY\u003c/strong\u003e be tried.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe following subsections each describe a different Protocol Message type.\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ca href=\"#addkey\"\u003e\u003ccode\u003eAddKey\u003c/code\u003e\u003c/a\u003e: Add a new public key for a given Actor\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#revokekey\"\u003e\u003ccode\u003eRevokeKey\u003c/code\u003e\u003c/a\u003e: Revoke a public key\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#revokekeythirdparty\"\u003e\u003ccode\u003eRevokeKeyThirdParty\u003c/code\u003e\u003c/a\u003e: A mechanism for independent third parties to revoke compromised keys\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#moveidentity\"\u003e\u003ccode\u003eMoveIdentity\u003c/code\u003e\u003c/a\u003e: Move all existing public keys and auxiliary data to a new Actor ID.\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#burndown\"\u003e\u003ccode\u003eBurnDown\u003c/code\u003e\u003c/a\u003e: A mechanism for account recovery.\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#fireproof\"\u003e\u003ccode\u003eFireproof\u003c/code\u003e\u003c/a\u003e: Opt out of \u003ccode\u003eBurnDown\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#undofireproof\"\u003e\u003ccode\u003eUndoFireproof\u003c/code\u003e\u003c/a\u003e: Opt back into \u003ccode\u003eBurnDown\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#addauxdata\"\u003e\u003ccode\u003eAddAuxData\u003c/code\u003e\u003c/a\u003e: Add auxiliary data (e.g. public keys for other protocols).\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#revokeauxdata\"\u003e\u003ccode\u003eRevokeAuxData\u003c/code\u003e\u003c/a\u003e: Revoke auxiliary data.\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#checkpoint\"\u003e\u003ccode\u003eCheckpoint\u003c/code\u003e\u003c/a\u003e: Allows one PKD to commit their Merkle root to a peer PKD instance.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eAddKey\u003c/h3\u003e\u003ca id=\"user-content-addkey\" class=\"anchor\" aria-label=\"Permalink: AddKey\" href=\"#addkey\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAn \u003ccode\u003eAddKey\u003c/code\u003e message associated with an Actor is intended to associate a new Public Key to this actor.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe first \u003ccode\u003eAddKey\u003c/code\u003e for any given Actor \u003cstrong\u003eMUST\u003c/strong\u003e be self-signed by the same public key being added. Every subsequent\n\u003ccode\u003eAddKey\u003c/code\u003e must be signed by an existing, non-revoked public key.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eSelf-signing is not permitted for any \u003ccode\u003eAddKey\u003c/code\u003e while a valid public key exists for this user. A successful \u003ccode\u003eBurnDown\u003c/code\u003e,\nor \u003ccode\u003eRevokeKeyThirdParty\u003c/code\u003e of their last public key, permits another self-signed \u003ccode\u003eAddKey\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe first \u003ccode\u003eAddKey\u003c/code\u003e will not have a \u003ccode\u003ekey-id\u003c/code\u003e outside of the message.  Every subsequent \u003ccode\u003eAddKey\u003c/code\u003e for a given Actor\n\u003cstrong\u003eSHOULD\u003c/strong\u003e have a \u003ccode\u003ekey-id\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAll \u003ccode\u003eAddKey\u003c/code\u003e messages for a given actor must be sent from the actor's Fediverse Server, which \u003cstrong\u003eMUST\u003c/strong\u003e support HTTP\nSignatures.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eAddKey Attributes\u003c/h4\u003e\u003ca id=\"user-content-addkey-attributes\" class=\"anchor\" aria-label=\"Permalink: AddKey Attributes\" href=\"#addkey-attributes\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003eaction\u003c/code\u003e -- \u003cstrong\u003estring (Action Type)\u003c/strong\u003e (required): Must be set to \u003ccode\u003eAddKey\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emessage\u003c/code\u003e -- \u003cstrong\u003emap\u003c/strong\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003eactor\u003c/code\u003e -- \u003cstrong\u003estring (Actor ID)\u003c/strong\u003e (required): The canonical Actor ID for a given ActivityPub user. Encrypted.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003etime\u003c/code\u003e -- \u003cstrong\u003estring (Timestamp)\u003c/strong\u003e (required): The current \u003ca href=\"#timestamps\"\u003etimestamp\u003c/a\u003e.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003epublic-key\u003c/code\u003e -- \u003cstrong\u003estring (Public Key)\u003c/strong\u003e (required): The \u003ca href=\"#public-key-encoding\"\u003eencoded public key\u003c/a\u003e. Encrypted.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ekey-id\u003c/code\u003e -- \u003cstrong\u003estring (Key Identifier)\u003c/strong\u003e (optional): See \u003ca href=\"#key-identifiers\"\u003eKey Identifiers\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003erecent-merkle-root\u003c/code\u003e -- \u003cstrong\u003estring (Merkle Root)\u003c/strong\u003e (required): \u003ca href=\"#recent-merkle-root-included-in-plaintext-commitments\"\u003eUsed for plaintext commitment\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003esymmetric-keys\u003c/code\u003e -- \u003cstrong\u003emap\u003c/strong\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003eactor\u003c/code\u003e -- \u003cstrong\u003estring (Cryptography key)\u003c/strong\u003e (required): The key used to encrypt \u003ccode\u003emessage.actor\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003epublic-key\u003c/code\u003e -- \u003cstrong\u003estring (Cryptography key)\u003c/strong\u003e (required): The key used to encrypt \u003ccode\u003emessage.public-key\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eAddKey Validation Steps\u003c/h4\u003e\u003ca id=\"user-content-addkey-validation-steps\" class=\"anchor\" aria-label=\"Permalink: AddKey Validation Steps\" href=\"#addkey-validation-steps\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAfter validating that the Protocol Message originated from the expected Fediverse Server, the specific rules for\nvalidating an \u003ccode\u003eAddKey\u003c/code\u003e message are as follows:\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eUsing \u003ccode\u003esymmetric-keys.actor\u003c/code\u003e, decrypt \u003ccode\u003emessage.actor\u003c/code\u003e to obtain the Actor ID. If the decryption fails, return an\nerror status.\u003c/li\u003e\n\u003cli\u003eUsing \u003ccode\u003esymmetric-keys.public-key\u003c/code\u003e, decrypt \u003ccode\u003emessage.public-key\u003c/code\u003e. If the decryption fails, return an error status.\u003c/li\u003e\n\u003cli\u003eIf there are no other public keys for the provided Actor, use the given public key (it is self-signed) and go to\nstep 6. If the signature is invalid, return an error status.\u003c/li\u003e\n\u003cli\u003eOtherwise, if the \u003ccode\u003ekey-id\u003c/code\u003e is provided, select this public key for the given Actor. If there is no public key for\nthis Actor with a matching \u003ccode\u003ekey-id\u003c/code\u003e, return an error status.\u003c/li\u003e\n\u003cli\u003eIf a \u003ccode\u003ekey-id\u003c/code\u003e was not provided, perform step 6 for each valid and trusted public key for this Actor until one\nsucceeds. If none of them do, return an error status.\u003c/li\u003e\n\u003cli\u003eValidate the message signature for the given public key.\u003c/li\u003e\n\u003cli\u003eIf the signature is valid in step 6, process the message.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eRevokeKey\u003c/h3\u003e\u003ca id=\"user-content-revokekey\" class=\"anchor\" aria-label=\"Permalink: RevokeKey\" href=\"#revokekey\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eA \u003ccode\u003eRevokeKey\u003c/code\u003e message marks an existing public key as untrusted. There is no undo operation for public key revocation.\n\u003ccode\u003eRevokeKey\u003c/code\u003e is but one mechanism for public key revocation, intended to be used by the Actor that normally possesses the\nkey.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAttempting to issue a \u003ccode\u003eRevokeKey\u003c/code\u003e \u003cstrong\u003eMUST\u003c/strong\u003e fail unless there is another public key associated with this Actor. The key\nused to sign the \u003ccode\u003eRevokeKey\u003c/code\u003e cannot be the same as the key being revoked.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eSee \u003ca href=\"#burndown\"\u003eBurnDown\u003c/a\u003e for clearing all keys and starting over (unless \u003ca href=\"#fireproof\"\u003eFireproof\u003c/a\u003e was ever issued).\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eRevokeKey Attributes\u003c/h4\u003e\u003ca id=\"user-content-revokekey-attributes\" class=\"anchor\" aria-label=\"Permalink: RevokeKey Attributes\" href=\"#revokekey-attributes\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003eaction\u003c/code\u003e -- \u003cstrong\u003estring (Action Type)\u003c/strong\u003e (required): Must be set to \u003ccode\u003eRevokeKey\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emessage\u003c/code\u003e -- \u003cstrong\u003emap\u003c/strong\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003eactor\u003c/code\u003e -- \u003cstrong\u003estring (Actor ID)\u003c/strong\u003e (required): The canonical Actor ID for a given ActivityPub user. Encrypted.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003etime\u003c/code\u003e -- \u003cstrong\u003estring (Timestamp)\u003c/strong\u003e (required): The current \u003ca href=\"#timestamps\"\u003etimestamp\u003c/a\u003e.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003epublic-key\u003c/code\u003e -- \u003cstrong\u003estring (Public Key)\u003c/strong\u003e (required): The \u003ca href=\"#public-key-encoding\"\u003eencoded public key\u003c/a\u003e. Encrypted.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ekey-id\u003c/code\u003e -- \u003cstrong\u003estring (Key Identifier)\u003c/strong\u003e (optional): The key that is signing the revocation.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003erecent-merkle-root\u003c/code\u003e -- \u003cstrong\u003estring (Merkle Root)\u003c/strong\u003e (required): \u003ca href=\"#recent-merkle-root-included-in-plaintext-commitments\"\u003eUsed for plaintext commitment\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003esymmetric-keys\u003c/code\u003e -- \u003cstrong\u003emap\u003c/strong\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003eactor\u003c/code\u003e -- \u003cstrong\u003estring (Cryptography key)\u003c/strong\u003e (required): The key used to encrypt \u003ccode\u003emessage.actor\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003epublic-key\u003c/code\u003e -- \u003cstrong\u003estring (Cryptography key)\u003c/strong\u003e (required): The key used to encrypt \u003ccode\u003emessage.public-key\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eRevokeKey Validation Steps\u003c/h4\u003e\u003ca id=\"user-content-revokekey-validation-steps\" class=\"anchor\" aria-label=\"Permalink: RevokeKey Validation Steps\" href=\"#revokekey-validation-steps\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAfter validating that the Protocol Message originated from the expected Fediverse Server, the specific rules for\nvalidating an \u003ccode\u003eRevokeKey\u003c/code\u003e message are as follows:\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eUsing \u003ccode\u003esymmetric-keys.actor\u003c/code\u003e, decrypt \u003ccode\u003emessage.actor\u003c/code\u003e to obtain the Actor ID. If the decryption fails, return an\nerror status.\u003c/li\u003e\n\u003cli\u003eUsing \u003ccode\u003esymmetric-keys.public-key\u003c/code\u003e, decrypt \u003ccode\u003emessage.public-key\u003c/code\u003e. If the decryption fails, return an error status.\u003c/li\u003e\n\u003cli\u003eIf there is no prior Protocol Message with a plaintext Actor ID that matches the decrypted \u003ccode\u003emessage.actor\u003c/code\u003e, abort.\u003c/li\u003e\n\u003cli\u003eIf the \u003ccode\u003ekey-id\u003c/code\u003e is provided, select this public key for the given Actor and proceed to step 5. If there is no public\nkey for this Actor with a matching \u003ccode\u003ekey-id\u003c/code\u003e, return an error status.\u003c/li\u003e\n\u003cli\u003eIf a \u003ccode\u003ekey-id\u003c/code\u003e was not provided, perform step 6 for each valid and trusted public key for this Actor until one\nsucceeds. If none of them do, return an error status.\u003c/li\u003e\n\u003cli\u003eValidate the message signature for the given public key.\u003c/li\u003e\n\u003cli\u003eIf the signature is valid in step 6, process the message.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eRevokeKeyThirdParty\u003c/h3\u003e\u003ca id=\"user-content-revokekeythirdparty\" class=\"anchor\" aria-label=\"Permalink: RevokeKeyThirdParty\" href=\"#revokekeythirdparty\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThis is a special message type in two ways:\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eIt can bypass the Fediverse server entirely, and be submitted directly to the Public Key Directory.\u003c/li\u003e\n\u003cli\u003eIt can be issued by an unrelated third party.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp dir=\"auto\"\u003eIf the user doesn't possess any other public keys, this message bypasses the usual \u003ccode\u003eRevokeKey\u003c/code\u003e restriction where the\nuser continue to must have a valid public key. Instead, the Actor will be treated as if they ran a successful\n\u003ccode\u003eBurnDown\u003c/code\u003e, and allows them to start over with an \u003ccode\u003eAddKey\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eSince you need the secret key tog generate the revocation token for a given public key, \u003ccode\u003eFireproof\u003c/code\u003e does not prevent\nthird parties from revoking public keys.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThis does not cancel out a previous \u003ccode\u003eFireproof\u003c/code\u003e status. Future \u003ccode\u003eBurnDown\u003c/code\u003e messages may fail.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eBecause the contents of this revocation token are signed, no \u003ccode\u003esignature\u003c/code\u003e is needed outside the \u003ccode\u003emessage\u003c/code\u003e map. Nor is any\n\u003ccode\u003ekey-id\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eRevokeKeyThirdParty Attributes\u003c/h4\u003e\u003ca id=\"user-content-revokekeythirdparty-attributes\" class=\"anchor\" aria-label=\"Permalink: RevokeKeyThirdParty Attributes\" href=\"#revokekeythirdparty-attributes\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003eaction\u003c/code\u003e -- \u003cstrong\u003estring (Action Type)\u003c/strong\u003e (required): Must be set to \u003ccode\u003eRevokeKeyThirdParty\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003erevocation-token\u003c/code\u003e --\u003cstrong\u003estring\u003c/strong\u003e (required): See \u003ca href=\"#revocation-tokens\"\u003eRevocation Tokens\u003c/a\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eRevokeKeyThirdParty Validation Steps\u003c/h4\u003e\u003ca id=\"user-content-revokekeythirdparty-validation-steps\" class=\"anchor\" aria-label=\"Permalink: RevokeKeyThirdParty Validation Steps\" href=\"#revokekeythirdparty-validation-steps\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThese tokens can be submitted directly to the Public Key Directory server at any time, with or without the involvement\nof any Fediverse instances.\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eDecode the revocation token from base64url.\u003c/li\u003e\n\u003cli\u003eSplit the revocation token into \u003ccode\u003eversion\u003c/code\u003e, \u003ccode\u003eREVOCATION_CONSTANT\u003c/code\u003e, \u003ccode\u003epublic_key\u003c/code\u003e, and \u003ccode\u003esignature\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eValidate signature for  \u003ccode\u003eversion || REVOCATION_CONSTANT || public_key\u003c/code\u003e, using \u003ccode\u003epublic_key\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eIf the signature is valid in step 3, revoke this public key for all Actors that share it.\n(In practice, this \u003cstrong\u003eSHOULD\u003c/strong\u003e only be one, but if that's ever not the case, we revoke them all here.)\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eMoveIdentity\u003c/h3\u003e\u003ca id=\"user-content-moveidentity\" class=\"anchor\" aria-label=\"Permalink: MoveIdentity\" href=\"#moveidentity\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThis moves all the mappings from the old Actor ID to the new Actor ID.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe message \u003cstrong\u003eMUST\u003c/strong\u003e be signed by a valid secret key for the \u003ccode\u003eold-actor\u003c/code\u003e, whereas the HTTP Signature \u003cstrong\u003eMUST\u003c/strong\u003e come from\nthe new Fediverse Server instance. This grants users the ability to move their identity to a new instance, provided they\ncan successfully authenticate to the new instance.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThis message \u003cstrong\u003eMUST\u003c/strong\u003e be rejected if there are existing public keys for the target \u003ccode\u003enew-actor\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eMoveIdentity Attributes\u003c/h4\u003e\u003ca id=\"user-content-moveidentity-attributes\" class=\"anchor\" aria-label=\"Permalink: MoveIdentity Attributes\" href=\"#moveidentity-attributes\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003eaction\u003c/code\u003e -- \u003cstrong\u003estring (Action Type)\u003c/strong\u003e (required): Must be set to \u003ccode\u003eMoveIdentity\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emessage\u003c/code\u003e -- \u003cstrong\u003emap\u003c/strong\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003eold-actor\u003c/code\u003e -- \u003cstrong\u003estring (Actor ID)\u003c/strong\u003e (required): Who is being moved. Encrypted.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003enew-actor\u003c/code\u003e -- \u003cstrong\u003estring (Actor ID)\u003c/strong\u003e (required): Their new Actor ID. Encrypted.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003etime\u003c/code\u003e -- \u003cstrong\u003estring (Timestamp)\u003c/strong\u003e (required): The current \u003ca href=\"#timestamps\"\u003etimestamp\u003c/a\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ekey-id\u003c/code\u003e -- \u003cstrong\u003estring (Key Identifier)\u003c/strong\u003e (optional): The key that is signing the revocation.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003erecent-merkle-root\u003c/code\u003e -- \u003cstrong\u003estring (Merkle Root)\u003c/strong\u003e (required): \u003ca href=\"#recent-merkle-root-included-in-plaintext-commitments\"\u003eUsed for plaintext commitment\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003esymmetric-keys\u003c/code\u003e -- \u003cstrong\u003emap\u003c/strong\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003eold-actor\u003c/code\u003e -- \u003cstrong\u003estring (Cryptography key)\u003c/strong\u003e (required): The key used to encrypt \u003ccode\u003emessage.old-actor\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003enew-actor\u003c/code\u003e -- \u003cstrong\u003estring (Cryptography key)\u003c/strong\u003e (required): The key used to encrypt \u003ccode\u003emessage.new-actor\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eMoveIdentity Validation Steps\u003c/h4\u003e\u003ca id=\"user-content-moveidentity-validation-steps\" class=\"anchor\" aria-label=\"Permalink: MoveIdentity Validation Steps\" href=\"#moveidentity-validation-steps\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAfter validating that the Protocol Message originated from the expected Fediverse Server, the specific rules for\nvalidating an \u003ccode\u003eMoveIdentity\u003c/code\u003e message are as follows:\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eUsing \u003ccode\u003esymmetric-keys.old-actor\u003c/code\u003e, decrypt \u003ccode\u003emessage.old-actor\u003c/code\u003e to obtain the Old Actor ID. If the decryption fails,\nreturn an error status.\u003c/li\u003e\n\u003cli\u003eUsing \u003ccode\u003esymmetric-keys.new-actor\u003c/code\u003e, decrypt \u003ccode\u003emessage.new-actor\u003c/code\u003e to obtain the New Actor ID. If the decryption fails,\nreturn an error status.\u003c/li\u003e\n\u003cli\u003eIf there is no prior Protocol Message with a plaintext Actor ID that matches the decrypted \u003ccode\u003emessage.old-actor\u003c/code\u003e,\nabort.\u003c/li\u003e\n\u003cli\u003eIf the \u003ccode\u003ekey-id\u003c/code\u003e is provided, select this public key for the Old Actor and proceed to step 6. If there is no public\nkey for this Actor with a matching \u003ccode\u003ekey-id\u003c/code\u003e, return an error status.\u003c/li\u003e\n\u003cli\u003eIf a \u003ccode\u003ekey-id\u003c/code\u003e was not provided, perform step 6 for each valid and trusted public key for this Actor until one\nsucceeds. If none of them do, return an error status.\u003c/li\u003e\n\u003cli\u003eValidate the message signature for the given public key.\u003c/li\u003e\n\u003cli\u003eIf the signature is valid in step 6, process the message.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eBurnDown\u003c/h3\u003e\u003ca id=\"user-content-burndown\" class=\"anchor\" aria-label=\"Permalink: BurnDown\" href=\"#burndown\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eA \u003ccode\u003eBurnDown\u003c/code\u003e message acts as a soft delete for all public keys and auxiliary data for a given Actor, unless they are\nunder the effect of \u003ca href=\"#fireproof\"\u003eFireproof\u003c/a\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eUnlike most Fediverse messages, a \u003ccode\u003eBurnDown\u003c/code\u003e is issued by an operator account on the Fediverse instance that hosts the\nActor in question. Servers are responsible for ensuring only trusted administrators are permitted to issue \u003ccode\u003eBurnDown\u003c/code\u003e\nmessages for other users.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThis allows a user to issue a self-signed \u003ccode\u003eAddKey\u003c/code\u003e and start over.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eBurnDown Attributes\u003c/h4\u003e\u003ca id=\"user-content-burndown-attributes\" class=\"anchor\" aria-label=\"Permalink: BurnDown Attributes\" href=\"#burndown-attributes\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003eaction\u003c/code\u003e -- \u003cstrong\u003estring (Action Type)\u003c/strong\u003e (required): Must be set to \u003ccode\u003eBurnDown\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emessage\u003c/code\u003e -- \u003cstrong\u003emap\u003c/strong\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003eactor\u003c/code\u003e -- \u003cstrong\u003estring (Actor ID)\u003c/strong\u003e (required): The canonical Actor ID for a given ActivityPub user that is being\nburned down. Encrypted.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eoperator\u003c/code\u003e -- \u003cstrong\u003estring (Actor ID)\u003c/strong\u003e (required): The instance operator that is issuing the \u003ccode\u003eBurnDown\u003c/code\u003e on behalf\nof the user. Encrypted.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003etime\u003c/code\u003e -- \u003cstrong\u003estring (Timestamp)\u003c/strong\u003e (required): The current \u003ca href=\"#timestamps\"\u003etimestamp\u003c/a\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ekey-id\u003c/code\u003e -- \u003cstrong\u003estring (Key Identifier)\u003c/strong\u003e (optional): The key that is signing the revocation.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eotp\u003c/code\u003e -- \u003cstrong\u003estring (One-Time Password)\u003c/strong\u003e (optional, but required if enabled): A one-time password (see \u003ca href=\"#totp\"\u003eTOTP\u003c/a\u003e).\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003erecent-merkle-root\u003c/code\u003e -- \u003cstrong\u003estring (Merkle Root)\u003c/strong\u003e (required): \u003ca href=\"#recent-merkle-root-included-in-plaintext-commitments\"\u003eUsed for plaintext commitment\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003esymmetric-keys\u003c/code\u003e -- \u003cstrong\u003emap\u003c/strong\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003eactor\u003c/code\u003e -- \u003cstrong\u003estring (Cryptography key)\u003c/strong\u003e (required): The key used to encrypt \u003ccode\u003emessage.actor\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eoperator\u003c/code\u003e -- \u003cstrong\u003estring (Cryptography key)\u003c/strong\u003e (required): The key used to encrypt \u003ccode\u003emessage.operator\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003epublic-key\u003c/code\u003e -- \u003cstrong\u003estring (Cryptography key)\u003c/strong\u003e (required): The key used to encrypt \u003ccode\u003emessage.public-key\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eBurnDown Validation Steps\u003c/h4\u003e\u003ca id=\"user-content-burndown-validation-steps\" class=\"anchor\" aria-label=\"Permalink: BurnDown Validation Steps\" href=\"#burndown-validation-steps\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAfter validating that the Protocol Message originated from the expected Fediverse Server, the specific rules for\nvalidating an \u003ccode\u003eBurnDown\u003c/code\u003e message are as follows:\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eUsing \u003ccode\u003esymmetric-keys.actor\u003c/code\u003e, decrypt \u003ccode\u003emessage.actor\u003c/code\u003e to obtain the Actor ID. If the decryption fails, return an\nerror status.\u003c/li\u003e\n\u003cli\u003eIf there is no prior Protocol Message with a plaintext Actor ID that matches the decrypted \u003ccode\u003emessage.actor\u003c/code\u003e, abort.\u003c/li\u003e\n\u003cli\u003eIf this actor is fireproof, abort.\u003c/li\u003e\n\u003cli\u003eIf the instance has previously enrolled a TOTP secret to this Fediverse server, verify that the \u003ccode\u003eotp\u003c/code\u003e field (which\nis now required) is a correct \u003ca href=\"#totp\"\u003eTOTP challenge\u003c/a\u003e.\u003c/li\u003e\n\u003cli\u003eUsing \u003ccode\u003esymmetric-keys.operator\u003c/code\u003e, decrypt \u003ccode\u003emessage.operator\u003c/code\u003e to obtain the Actor ID for the Operator. If the\ndecryption fails, return an error status.\u003c/li\u003e\n\u003cli\u003eIf the \u003ccode\u003ekey-id\u003c/code\u003e is provided, select this public key for the Actor (Operator) and proceed to step 8. If there is no\npublic key for this Actor with a matching \u003ccode\u003ekey-id\u003c/code\u003e, return an error status.\u003c/li\u003e\n\u003cli\u003eIf a \u003ccode\u003ekey-id\u003c/code\u003e was not provided, perform step 8 for each valid and trusted public key for this Actor (Operator) until\none succeeds. If none of them do, return an error status.\u003c/li\u003e\n\u003cli\u003eValidate the message signature for the given public key.\u003c/li\u003e\n\u003cli\u003eIf the signature is valid in step 8, process the message.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eFireproof\u003c/h3\u003e\u003ca id=\"user-content-fireproof\" class=\"anchor\" aria-label=\"Permalink: Fireproof\" href=\"#fireproof\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eWhere \u003ccode\u003eBurnDown\u003c/code\u003e resets the state for a given Actor to allow account recovery, \u003ccode\u003eFireproof\u003c/code\u003e opts out of this recovery\nmechanism entirely. See \u003ca href=\"#revocation-and-account-recovery\"\u003ethe relevant Security Considerations section\u003c/a\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThis message \u003cstrong\u003eMAY\u003c/strong\u003e be sent out-of-band to the Public Key Directory without the Fediverse server's involvement.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ccode\u003eFireproof\u003c/code\u003e is only intended to prevent \u003ccode\u003eBurnDown\u003c/code\u003e (which the instance hosting the Actor may perform without a valid\nsignature from the same Actor). It does not prevent users from having no valid public keys (i.e., if someone issues a\n\u003ccode\u003eRevokeKeyThirdParty\u003c/code\u003e against their only trusted public key.)\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIf the user is already in Fireproof status, this message is rejected.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eFireproof Attributes\u003c/h4\u003e\u003ca id=\"user-content-fireproof-attributes\" class=\"anchor\" aria-label=\"Permalink: Fireproof Attributes\" href=\"#fireproof-attributes\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003eaction\u003c/code\u003e -- \u003cstrong\u003estring (Action Type)\u003c/strong\u003e (required): Must be set to \u003ccode\u003eFireproof\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emessage\u003c/code\u003e -- \u003cstrong\u003emap\u003c/strong\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003eactor\u003c/code\u003e -- \u003cstrong\u003estring (Actor ID)\u003c/strong\u003e (required): The canonical Actor ID for a given ActivityPub user. Encrypted.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003etime\u003c/code\u003e -- \u003cstrong\u003estring (Timestamp)\u003c/strong\u003e (required): The current \u003ca href=\"#timestamps\"\u003etimestamp\u003c/a\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ekey-id\u003c/code\u003e -- \u003cstrong\u003estring (Key Identifier)\u003c/strong\u003e (optional): The key that is signing the revocation.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003erecent-merkle-root\u003c/code\u003e -- \u003cstrong\u003estring (Merkle Root)\u003c/strong\u003e (required): \u003ca href=\"#recent-merkle-root-included-in-plaintext-commitments\"\u003eUsed for plaintext commitment\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003esymmetric-keys\u003c/code\u003e -- \u003cstrong\u003emap\u003c/strong\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003eactor\u003c/code\u003e -- \u003cstrong\u003estring (Cryptography key)\u003c/strong\u003e (required): The key used to encrypt \u003ccode\u003emessage.actor\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eFireproof Validation Steps\u003c/h4\u003e\u003ca id=\"user-content-fireproof-validation-steps\" class=\"anchor\" aria-label=\"Permalink: Fireproof Validation Steps\" href=\"#fireproof-validation-steps\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAfter validating that the Protocol Message originated from the expected Fediverse Server, the specific rules for\nvalidating an \u003ccode\u003eFireproof\u003c/code\u003e message are as follows:\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eUsing \u003ccode\u003esymmetric-keys.actor\u003c/code\u003e, decrypt \u003ccode\u003emessage.actor\u003c/code\u003e to obtain the Actor ID. If the decryption fails, return an\nerror status.\u003c/li\u003e\n\u003cli\u003eIf there is no prior Protocol Message with a plaintext Actor ID that matches the decrypted \u003ccode\u003emessage.actor\u003c/code\u003e, abort.\u003c/li\u003e\n\u003cli\u003eIf the \u003ccode\u003ekey-id\u003c/code\u003e is provided, select this public key for the given Actor and proceed to step 5. If there is no public\nkey for this Actor with a matching \u003ccode\u003ekey-id\u003c/code\u003e, return an error status.\u003c/li\u003e\n\u003cli\u003eIf a \u003ccode\u003ekey-id\u003c/code\u003e was not provided, perform step 5 for each valid and trusted public key for this Actor until one\nsucceeds. If none of them do, return an error status.\u003c/li\u003e\n\u003cli\u003eValidate the message signature for the given public key.\u003c/li\u003e\n\u003cli\u003eIf the signature is valid in step 5, process the message.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eUndoFireproof\u003c/h3\u003e\u003ca id=\"user-content-undofireproof\" class=\"anchor\" aria-label=\"Permalink: UndoFireproof\" href=\"#undofireproof\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThis reverts the Fireproof status for a given Actor, re-enabling account recovery by instance administrators.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ccode\u003eUndoFireproof\u003c/code\u003e is intended to allow ActivityPub users a way to opt back into account recovery. By issuing one to the\nPublic Key Directory server, a user accepts the risk of a malicious instance administrator issuing a \u003ccode\u003eBurnDown\u003c/code\u003e on their\nbehalf.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIf the user is not in \u003ccode\u003eFireproof\u003c/code\u003e status, this message is rejected.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eUndoFireproof Attributes\u003c/h4\u003e\u003ca id=\"user-content-undofireproof-attributes\" class=\"anchor\" aria-label=\"Permalink: UndoFireproof Attributes\" href=\"#undofireproof-attributes\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003eaction\u003c/code\u003e -- \u003cstrong\u003estring (Action Type)\u003c/strong\u003e (required): Must be set to \u003ccode\u003eUndoFireproof\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emessage\u003c/code\u003e -- \u003cstrong\u003emap\u003c/strong\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003eactor\u003c/code\u003e -- \u003cstrong\u003estring (Actor ID)\u003c/strong\u003e (required): The canonical Actor ID for a given ActivityPub user. Encrypted.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003etime\u003c/code\u003e -- \u003cstrong\u003estring (Timestamp)\u003c/strong\u003e (required): The current \u003ca href=\"#timestamps\"\u003etimestamp\u003c/a\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ekey-id\u003c/code\u003e -- \u003cstrong\u003estring (Key Identifier)\u003c/strong\u003e (optional): The key that is signing the revocation.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003erecent-merkle-root\u003c/code\u003e -- \u003cstrong\u003estring (Merkle Root)\u003c/strong\u003e (required): \u003ca href=\"#recent-merkle-root-included-in-plaintext-commitments\"\u003eUsed for plaintext commitment\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003esymmetric-keys\u003c/code\u003e -- \u003cstrong\u003emap\u003c/strong\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003eactor\u003c/code\u003e -- \u003cstrong\u003estring (Cryptography key)\u003c/strong\u003e (required): The key used to encrypt \u003ccode\u003emessage.actor\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eUndoFireproof Validation Steps\u003c/h4\u003e\u003ca id=\"user-content-undofireproof-validation-steps\" class=\"anchor\" aria-label=\"Permalink: UndoFireproof Validation Steps\" href=\"#undofireproof-validation-steps\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAfter validating that the Protocol Message originated from the expected Fediverse Server, the specific rules for\nvalidating an \u003ccode\u003eUndoFireproof\u003c/code\u003e message are as follows:\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eUsing \u003ccode\u003esymmetric-keys.actor\u003c/code\u003e, decrypt \u003ccode\u003emessage.actor\u003c/code\u003e to obtain the Actor ID. If the decryption fails, return an\nerror status.\u003c/li\u003e\n\u003cli\u003eIf there is no prior Protocol Message with a plaintext Actor ID that matches the decrypted \u003ccode\u003emessage.actor\u003c/code\u003e, abort.\u003c/li\u003e\n\u003cli\u003eIf the \u003ccode\u003ekey-id\u003c/code\u003e is provided, select this public key for the given Actor and proceed to step 5. If there is no public\nkey for this Actor with a matching \u003ccode\u003ekey-id\u003c/code\u003e, return an error status.\u003c/li\u003e\n\u003cli\u003eIf a \u003ccode\u003ekey-id\u003c/code\u003e was not provided, perform step 5 for each valid and trusted public key for this Actor until one\nsucceeds. If none of them do, return an error status.\u003c/li\u003e\n\u003cli\u003eValidate the message signature for the given public key.\u003c/li\u003e\n\u003cli\u003eIf the signature is valid in step 5, process the message.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eAddAuxData\u003c/h3\u003e\u003ca id=\"user-content-addauxdata\" class=\"anchor\" aria-label=\"Permalink: AddAuxData\" href=\"#addauxdata\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eSee \u003ca href=\"#auxiliary-data\"\u003eAuxiliary Data\u003c/a\u003e above for an explanation.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThese messages will append some Auxiliary Data to an Actor, provided that the Public Key Directory server supports the\nrelevant extension, and the data provided conforms to whatever validation criteria the extension defines.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eAddAuxData Attributes\u003c/h4\u003e\u003ca id=\"user-content-addauxdata-attributes\" class=\"anchor\" aria-label=\"Permalink: AddAuxData Attributes\" href=\"#addauxdata-attributes\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003eaction\u003c/code\u003e -- \u003cstrong\u003estring (Action Type)\u003c/strong\u003e (required): Must be set to \u003ccode\u003eAddAuxData\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emessage\u003c/code\u003e -- \u003cstrong\u003emap\u003c/strong\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003eactor\u003c/code\u003e -- \u003cstrong\u003estring (Actor ID)\u003c/strong\u003e (required): The canonical Actor ID for a given ActivityPub user. Encrypted.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eaux-type\u003c/code\u003e -- \u003cstrong\u003estring (Auxiliary Data Type)\u003c/strong\u003e (required): The identifier used by the Auxiliary Data extension.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eaux-data\u003c/code\u003e -- \u003cstrong\u003estring\u003c/strong\u003e (required): The auxiliary data. Encrypted.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eaux-id\u003c/code\u003e -- \u003cstrong\u003estring\u003c/strong\u003e (optional): See \u003ca href=\"#auxiliary-data-identifiers\"\u003eAuxiliary Data Identifiers\u003c/a\u003e. If provided,\nthe server will validate that the aux-id is valid for the given type and data.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003etime\u003c/code\u003e -- \u003cstrong\u003estring (Timestamp)\u003c/strong\u003e (required): The current \u003ca href=\"#timestamps\"\u003etimestamp\u003c/a\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ekey-id\u003c/code\u003e -- \u003cstrong\u003estring (Key Identifier)\u003c/strong\u003e (optional): The key that is signing the Aux Data.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003erecent-merkle-root\u003c/code\u003e -- \u003cstrong\u003estring (Merkle Root)\u003c/strong\u003e (required): \u003ca href=\"#recent-merkle-root-included-in-plaintext-commitments\"\u003eUsed for plaintext commitment\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003esymmetric-keys\u003c/code\u003e -- \u003cstrong\u003emap\u003c/strong\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003eactor\u003c/code\u003e -- \u003cstrong\u003estring (Cryptography key)\u003c/strong\u003e (required): The key used to encrypt \u003ccode\u003emessage.actor\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eaux-data\u003c/code\u003e -- \u003cstrong\u003estring (Cryptography key)\u003c/strong\u003e (required): The key used to encrypt \u003ccode\u003emessage.aux-data\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eAddAuxData Validation Steps\u003c/h4\u003e\u003ca id=\"user-content-addauxdata-validation-steps\" class=\"anchor\" aria-label=\"Permalink: AddAuxData Validation Steps\" href=\"#addauxdata-validation-steps\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAfter validating that the Protocol Message originated from the expected Fediverse Server, the specific rules for\nvalidating an \u003ccode\u003eAddAuxData\u003c/code\u003e message are as follows:\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eUsing \u003ccode\u003esymmetric-keys.actor\u003c/code\u003e, decrypt \u003ccode\u003emessage.actor\u003c/code\u003e to obtain the Actor ID. If the decryption fails, return an\nerror status.\u003c/li\u003e\n\u003cli\u003eUsing \u003ccode\u003esymmetric-keys.aux-data\u003c/code\u003e, decrypt \u003ccode\u003emessage.aux-data\u003c/code\u003e. If the decryption fails, return an error status.\u003c/li\u003e\n\u003cli\u003eIf \u003ccode\u003emessage.aux-type\u003c/code\u003e does not match any of the identifiers for supported Auxiliary Data extensions for this Public\nKey Directory, abort.\u003c/li\u003e\n\u003cli\u003eIf there is no prior Protocol Message with a plaintext Actor ID that matches the decrypted \u003ccode\u003emessage.actor\u003c/code\u003e, abort.\u003c/li\u003e\n\u003cli\u003eIf the \u003ccode\u003ekey-id\u003c/code\u003e is provided, select this public key for the given Actor and proceed to step 7. If there is no public\nkey for this Actor with a matching \u003ccode\u003ekey-id\u003c/code\u003e, return an error status.\u003c/li\u003e\n\u003cli\u003eIf a \u003ccode\u003ekey-id\u003c/code\u003e was not provided, perform step 7 for each valid and trusted public key for this Actor until one\nsucceeds. If none of them do, return an error status.\u003c/li\u003e\n\u003cli\u003eValidate the message signature for the given public key.\u003c/li\u003e\n\u003cli\u003eIf the signature is valid in step 7, validate the contents of \u003ccode\u003emessage.aux-data\u003c/code\u003e in accordance to the rules defined\nin the extension for the given \u003ccode\u003emessage.aux-type\u003c/code\u003e. Otherwise, return an error status.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eRevokeAuxData\u003c/h3\u003e\u003ca id=\"user-content-revokeauxdata\" class=\"anchor\" aria-label=\"Permalink: RevokeAuxData\" href=\"#revokeauxdata\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThis revokes one \u003ca href=\"#auxiliary-data\"\u003eAuxiliary Data\u003c/a\u003e record for a given Actor.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eRevokeAuxData Attributes\u003c/h4\u003e\u003ca id=\"user-content-revokeauxdata-attributes\" class=\"anchor\" aria-label=\"Permalink: RevokeAuxData Attributes\" href=\"#revokeauxdata-attributes\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003eaction\u003c/code\u003e -- \u003cstrong\u003estring (Action Type)\u003c/strong\u003e (required): Must be set to \u003ccode\u003eRevokeAuxData\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emessage\u003c/code\u003e -- \u003cstrong\u003emap\u003c/strong\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003eactor\u003c/code\u003e -- \u003cstrong\u003estring (Actor ID)\u003c/strong\u003e (required): The canonical Actor ID for a given ActivityPub user.\nThis may be encrypted (if \u003ccode\u003esymmetric-keys.actor\u003c/code\u003e is set at the time of creation).\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eaux-type\u003c/code\u003e -- \u003cstrong\u003estring (Auxiliary Data Type)\u003c/strong\u003e (required): The identifier used by the Auxiliary Data extension.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eaux-data\u003c/code\u003e -- \u003cstrong\u003estring\u003c/strong\u003e (optional): The auxiliary data. Encrypted.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eaux-id\u003c/code\u003e -- \u003cstrong\u003estring\u003c/strong\u003e (optional): See \u003ca href=\"#auxiliary-data-identifiers\"\u003eAuxiliary Data Identifiers\u003c/a\u003e. If provided,\nthe server will validate that the aux-id is valid for the given type and data.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003etime\u003c/code\u003e -- \u003cstrong\u003estring (Timestamp)\u003c/strong\u003e (required): The current \u003ca href=\"#timestamps\"\u003etimestamp\u003c/a\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ekey-id\u003c/code\u003e -- \u003cstrong\u003estring (Key Identifier)\u003c/strong\u003e (optional): The key that is signing the revocation.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003erecent-merkle-root\u003c/code\u003e -- \u003cstrong\u003estring (Merkle Root)\u003c/strong\u003e (required): \u003ca href=\"#recent-merkle-root-included-in-plaintext-commitments\"\u003eUsed for plaintext commitment\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003esymmetric-keys\u003c/code\u003e -- \u003cstrong\u003emap\u003c/strong\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003eactor\u003c/code\u003e -- \u003cstrong\u003estring (Cryptography key)\u003c/strong\u003e (required): The key used to encrypt \u003ccode\u003emessage.actor\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eaux-data\u003c/code\u003e -- \u003cstrong\u003estring (Cryptography key)\u003c/strong\u003e (optional): The key used to encrypt \u003ccode\u003emessage.aux-data\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eNote that either \u003ccode\u003emessage.auth-data\u003c/code\u003e \u003cstrong\u003eOR\u003c/strong\u003e \u003ccode\u003emessage.aux-id\u003c/code\u003e is required in order for revocation to succeed.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eRevokeAuxData Validation Steps\u003c/h4\u003e\u003ca id=\"user-content-revokeauxdata-validation-steps\" class=\"anchor\" aria-label=\"Permalink: RevokeAuxData Validation Steps\" href=\"#revokeauxdata-validation-steps\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAfter validating that the Protocol Message originated from the expected Fediverse Server, the specific rules for\nvalidating an \u003ccode\u003eRevokeAuxData\u003c/code\u003e message are as follows:\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eUsing \u003ccode\u003esymmetric-keys.actor, decrypt \u003c/code\u003emessage.actor` to obtain the Actor ID. If the decryption fails,\nreturn an error status.\u003c/li\u003e\n\u003cli\u003eIf \u003ccode\u003esymmetric-keys.aux-data\u003c/code\u003e is provided, decrypt \u003ccode\u003emessage.aux-data\u003c/code\u003e. If the decryption fails, return an error\nstatus. If a plaintext \u003ccode\u003emessage.aux-data\u003c/code\u003e is provided without a symmetric key, abort.\u003c/li\u003e\n\u003cli\u003eIf there is no prior Protocol Message with a plaintext Actor ID that matches the decrypted \u003ccode\u003emessage.actor\u003c/code\u003e, abort.\u003c/li\u003e\n\u003cli\u003eIf \u003ccode\u003emessage.aux-id\u003c/code\u003e is provided, proceed to step 7.\u003c/li\u003e\n\u003cli\u003eOtherwise, if \u003ccode\u003emessage.aux-data\u003c/code\u003e is provided, recalculate the expected \u003ccode\u003eaux-id\u003c/code\u003e, then proceed to step 7.\u003c/li\u003e\n\u003cli\u003eIf there is no existing Auxiliary Data with a matching \u003ccode\u003eaux-id\u003c/code\u003e (whether provided or calculated), abort.\u003c/li\u003e\n\u003cli\u003eIf the \u003ccode\u003ekey-id\u003c/code\u003e is provided, select this public key for the given Actor and proceed to step 8. If there is no public\nkey for this Actor with a matching \u003ccode\u003ekey-id\u003c/code\u003e, return an error status.\u003c/li\u003e\n\u003cli\u003eIf a \u003ccode\u003ekey-id\u003c/code\u003e was not provided, perform step 8 for each valid and trusted public key for this Actor until one\nsucceeds. If none of them do, return an error status.\u003c/li\u003e\n\u003cli\u003eValidate the message signature for the given public key.\u003c/li\u003e\n\u003cli\u003eIf the signature is valid in step 9, proceed with the revocation of the Auxiliary Data for this Actor.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eCheckpoint\u003c/h3\u003e\u003ca id=\"user-content-checkpoint\" class=\"anchor\" aria-label=\"Permalink: Checkpoint\" href=\"#checkpoint\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eUnlike other Protocol Message types, this one will strictly be performed from one Public Key Directory to another. See\n\u003ca href=\"#witness-co-signing\"\u003ethe Witness co-signing section\u003c/a\u003e for context.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ccode\u003eCheckpoint\u003c/code\u003e messages contain three critical pieces of context, to be committed into the recipient's Sigsum ledger:\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eThe current Merkle root of the sender (\u003ccode\u003efrom-root\u003c/code\u003e).\u003c/li\u003e\n\u003cli\u003eThe most recent \u003cem\u003evalidated\u003c/em\u003e Merkle root of the recipient (\u003ccode\u003eto-validated-root\u003c/code\u003e).\u003c/li\u003e\n\u003cli\u003eThe current public key of the sender (\u003ccode\u003efrom-public-key\u003c/code\u003e).\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp dir=\"auto\"\u003eBy \"validated\", we mean that the sender has reconstructed the current state of mappings between Actors and public keys,\nas well as Actors to auxiliary data, of the recipient's history.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe third item (\u003ccode\u003efrom-public-key\u003c/code\u003e) also provides a mechanism for Public Key Directory instances to announce new public\nkeys to their peers, in the event that a rotation is necessary.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eCheckpoint messages are purely informational, and only serve to cross-commit Merkle roots onto each other's histories,\nso that a specific Merkle root can be verified to exist within a point in time with respect to other ledgers' Merkle\nroots.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eCheckpoint Attributes\u003c/h4\u003e\u003ca id=\"user-content-checkpoint-attributes\" class=\"anchor\" aria-label=\"Permalink: Checkpoint Attributes\" href=\"#checkpoint-attributes\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003eaction\u003c/code\u003e -- \u003cstrong\u003estring (Action Type)\u003c/strong\u003e (required): Must be set to \u003ccode\u003eCheckpoint\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emessage\u003c/code\u003e -- \u003cstrong\u003emap\u003c/strong\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003etime\u003c/code\u003e -- \u003cstrong\u003estring (Timestamp)\u003c/strong\u003e (required): The current \u003ca href=\"#timestamps\"\u003etimestamp\u003c/a\u003e.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003efrom-directory\u003c/code\u003e -- \u003cstrong\u003estring (URL)\u003c/strong\u003e (required): Must be set to the public URL of the PKD sending this Message.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003efrom-root\u003c/code\u003e -- \u003cstrong\u003estring (Merkle Root)\u003c/strong\u003e (required): The Merkle root of the PKD that is signing this request.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003efrom-public-key\u003c/code\u003e -- \u003cstrong\u003estring (Public Key)\u003c/strong\u003e (required): The current public key for the PKD sending the request.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eto-directory\u003c/code\u003e -- \u003cstrong\u003estring (URL)\u003c/strong\u003e (required): Must be set to the public URL of the recipient PKD for this Message.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eto-validated-root\u003c/code\u003e -- \u003cstrong\u003estring (Merkle Root)\u003c/strong\u003e (required): The latest validated Merkle root of the recipient server.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eCheckpoint Validation Steps\u003c/h4\u003e\u003ca id=\"user-content-checkpoint-validation-steps\" class=\"anchor\" aria-label=\"Permalink: Checkpoint Validation Steps\" href=\"#checkpoint-validation-steps\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eVerify that \u003ccode\u003eaction\u003c/code\u003e is set to \u003ccode\u003eCheckpoint\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eVerify that \u003ccode\u003emessage.from-directory\u003c/code\u003e exists strictly within an allow-list of accepted directories. If not, reject.\u003c/li\u003e\n\u003cli\u003eVerify that \u003ccode\u003emessage.to-directory\u003c/code\u003e matches the current Public Key Directory's canonical URL. If not, reject.\u003c/li\u003e\n\u003cli\u003eVerify that \u003ccode\u003emessage.time\u003c/code\u003e is within a reasonably recent time window (e.g. \u003ccode\u003e86400\u003c/code\u003e seconds, or 24 hours). If not,\nreject.\u003c/li\u003e\n\u003cli\u003eVerify that \u003ccode\u003emessage.to-validated-root\u003c/code\u003e is \u003ca href=\"#recent-merkle-root-included-in-plaintext-commitments\"\u003erecent\u003c/a\u003e. If not,\nreject.\u003c/li\u003e\n\u003cli\u003eAsynchronously fetch the current public key from the sender's PKD, compare with \u003ccode\u003emessage.from-public-key\u003c/code\u003e. If they\nare not identical at the time of insertion, abort.\u003c/li\u003e\n\u003cli\u003eValidate the message signature for the given public key in \u003ccode\u003efrom-public-key\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eStore the Checkpoint message in the underlying ledger.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eThe Federated Public Key Directory\u003c/h2\u003e\u003ca id=\"user-content-the-federated-public-key-directory\" class=\"anchor\" aria-label=\"Permalink: The Federated Public Key Directory\" href=\"#the-federated-public-key-directory\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eEncryption of Protocol Messages\u003c/h3\u003e\u003ca id=\"user-content-encryption-of-protocol-messages\" class=\"anchor\" aria-label=\"Permalink: Encryption of Protocol Messages\" href=\"#encryption-of-protocol-messages\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eProtocol Messages \u003cstrong\u003eMAY\u003c/strong\u003e be sent in plaintext at the HTTP layer, or encrypted using \u003ca href=\"https://datatracker.ietf.org/doc/rfc9180/\" rel=\"nofollow\"\u003eHPKE (RFC 9180)\u003c/a\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eWhen encryption is chosen, the client software \u003cstrong\u003eMUST\u003c/strong\u003e use a specific public key provided by the Public Key Directory\nserver for this purpose.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe Public Key Directory's public key \u003cstrong\u003eMAY\u003c/strong\u003e rotate frequently, and \u003cstrong\u003eSHOULD\u003c/strong\u003e be fetched from the server and cached\nclient-side for no more than 24 hours. Public Key Directories are not required to rotate this public key.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eProtocol Message Encryption\u003c/h4\u003e\u003ca id=\"user-content-protocol-message-encryption\" class=\"anchor\" aria-label=\"Permalink: Protocol Message Encryption\" href=\"#protocol-message-encryption\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ccode\u003eBurnDown\u003c/code\u003e messages \u003cstrong\u003eMUST NOT\u003c/strong\u003e be encrypted.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eWhen encryption is chosen, the Protocol Message \u003cstrong\u003eMUST\u003c/strong\u003e be serialized as a JSON string and then encrypted according to\nthe specific HPKE cipher suite advertised by the Public Key Directory, using the given public key.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eUsers \u003cstrong\u003eMAY\u003c/strong\u003e pad the plaintext before encryption with additional whitespace to their desired length, but \u003cstrong\u003eSHOULD\u003c/strong\u003e\nkeep their plaintext JSON blobs smaller than 16 MiB (16,777,216 bytes).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eWhen encrypting, the AAD parameter of the HPKE encryption \u003cstrong\u003eMUST\u003c/strong\u003e be set to the value of the \u003ccode\u003e!pkd-context\u003c/code\u003e field.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe result of the ciphertext will be encoded with unpadded \u003ca href=\"https://datatracker.ietf.org/doc/html/rfc4648#section-5\" rel=\"nofollow\"\u003ebase64url\u003c/a\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe message emitted to the Public Key Directory will consist of the following elements:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{\n  /* This is always included. */\n  \u0026quot;!pkd-context\u0026quot;: \u0026quot;https://github.com/fedi-e2ee/public-key-directory/v1\u0026quot;,\n  /* The value of encrypted-message MUST be an unpadded base64url-encoded string. */\n  \u0026quot;encrypted-message\u0026quot;: \u0026quot;...\u0026quot;\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"pl-c\"\u003e/* This is always included. */\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"!pkd-context\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"https://github.com/fedi-e2ee/public-key-directory/v1\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-c\"\u003e/* The value of encrypted-message MUST be an unpadded base64url-encoded string. */\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"encrypted-message\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"...\"\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eProtocol Message Decryption\u003c/h4\u003e\u003ca id=\"user-content-protocol-message-decryption\" class=\"anchor\" aria-label=\"Permalink: Protocol Message Decryption\" href=\"#protocol-message-decryption\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIf \u003ccode\u003eencrypted-message\u003c/code\u003e was provided by the HTTP request, after verifying the HTTP Signature, decode this value from\nencoded with unpadded \u003ca href=\"https://datatracker.ietf.org/doc/html/rfc4648#section-5\" rel=\"nofollow\"\u003ebase64url\u003c/a\u003e then attempt to decrypt it.\nEnsure the AAD parameter is set to the value of the \u003ccode\u003e!pkd-context\u003c/code\u003e field.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eDecryption failures count as rejections and incur a \u003ca href=\"#rate-limiting-bad-requests\"\u003erate-limiting penalty\u003c/a\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe result of a successful decryption \u003cstrong\u003eMUST\u003c/strong\u003e be a string that corresponds to a JSON-encoded Protocol Message. This\nJSON blob \u003cstrong\u003eMAY\u003c/strong\u003e have additional whitespace appended to it.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eProtocol Message Processing\u003c/h3\u003e\u003ca id=\"user-content-protocol-message-processing\" class=\"anchor\" aria-label=\"Permalink: Protocol Message Processing\" href=\"#protocol-message-processing\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eMost \u003ca href=\"#protocol-messages\"\u003eProtocol Messages\u003c/a\u003e will be received through ActivityPub. (Exception: \u003ca href=\"#revokekeythirdparty\"\u003e\u003ccode\u003eRevokeKeyThirdParty\u003c/code\u003e\u003c/a\u003e\ncan be sent via HTTP request to the JSON REST API.)\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eEach type of Protocol Message has its own specific validation steps. This section defines the workflow for handling all\nProtocolMessages.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eRate-Limiting Bad Requests\u003c/h4\u003e\u003ca id=\"user-content-rate-limiting-bad-requests\" class=\"anchor\" aria-label=\"Permalink: Rate-Limiting Bad Requests\" href=\"#rate-limiting-bad-requests\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThe first step should be checking the source of the request against a rate-limiting protocol with exponential back-off.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eRejected or invalid Protocol Messages will increase the counter for that client or Fediverse server and for the IP\naddress that sent the request. Each value of the counter doubles the amount of time that must pass between subsequent\nrequests, beginning with a configurable parameter (default = 100 milliseconds) for the first failure.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003ePublic Key Directories \u003cstrong\u003eMAY\u003c/strong\u003e specify a maximum time between requests from misbehaving instances. It is not required to\nhave a maximum penalty time.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIf the request has an entry in the Bad Request table based on server identity or IP address, the timestamp of the last\nrequest + the current penalty is compared to the current time. If insufficient time has elapsed, the request is dropped,\nand the server responds with an HTTP 429 error.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAfter a period of time equal to twice the penalty has passed, the counter will be decremented by 1, until it reaches 0.\nAt this point, the item is removed from the Bad Request table.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAttempting to send requests that trigger rate limit rejection \u003cstrong\u003eMAY\u003c/strong\u003e incur additional penalties, depending on server\nconfiguration, but it isn't required. Public Key Directories \u003cstrong\u003eMAY\u003c/strong\u003e also permanently block Fediverse Servers that\nroutinely misbehave at their operator's discretion.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"#totp\"\u003eTOTP Messages\u003c/a\u003e \u003cstrong\u003eMUST\u003c/strong\u003e employ aggressive rate-limiting for incorrect guesses, but for which the HTTP Signature\nwas valid (i.e., the request originated from the instance).\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eProtocol Message Parsing\u003c/h4\u003e\u003ca id=\"user-content-protocol-message-parsing\" class=\"anchor\" aria-label=\"Permalink: Protocol Message Parsing\" href=\"#protocol-message-parsing\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThe Public Key Directory expects a JSON blob in the HTTP request body. This should correspond to the structure of a\n\u003ca href=\"#protocol-messages\"\u003eProtocol Message\u003c/a\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe blob \u003cstrong\u003eMAY\u003c/strong\u003e be encrypted from the client software. See \u003ca href=\"#protocol-message-encryption\"\u003eProtocol Message Encryption\u003c/a\u003e.\nIf so, the JSON blob will be a top-level message containing only \u003ccode\u003e!pkd-context\u003c/code\u003e and \u003ccode\u003eencrypted-message\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eProtocol Messages encrypted with HPKE in this way \u003cstrong\u003eMUST\u003c/strong\u003e always include an HTTP Signature header, and it \u003cstrong\u003eMUST\u003c/strong\u003e be\nvalid.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003ePlaintext HTTP Requests containing these Protocol Messages \u003cstrong\u003eMAY\u003c/strong\u003e be signed with an HTTP Signature. If it is, first\n\u003ca href=\"https://swicg.github.io/activitypub-http-signature/#how-to-verify-a-signature\" rel=\"nofollow\"\u003everify the HTTP Signature\u003c/a\u003e on the\nmessage, according to the ActivityPub specification.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAny invalid HTTP Signatures count as a rejection and incur a rate-limiting penalty, even if the Protocol Message type\ndoes not require signatures.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eEncrypted Protocol messages \u003cstrong\u003eMUST\u003c/strong\u003e be decrypted after the signature verification is complete. Decryption of Protocol\nMessages is described \u003ca href=\"#protocol-message-decryption\"\u003ein a previous section\u003c/a\u003e. Encryption is performed client-side by the\nuser.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIf encryption was used, and the decrypted Protocol Message is a \u003ccode\u003eBurnDown\u003c/code\u003e, the Public Key Directory \u003cstrong\u003eMUST\u003c/strong\u003e discard\nit. BurnDown messages \u003cstrong\u003eMUST\u003c/strong\u003e be sent unencrypted. The instance is responsible for ensuring that only administrators\n\u003cstrong\u003eMAY\u003c/strong\u003e send a\u003ccode\u003eBurnDown\u003c/code\u003e to a Public Key Directory.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eSome Protocol Messages require an HTTP Signature, even when sent in plaintext. A missing signature in these instances is\ntreated as invalid, and incurs a rate-limiting penalty.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe JSON blob should then be deserialized into an Object and handled appropriately (see next subsection).\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eHandling Protocol Messages\u003c/h4\u003e\u003ca id=\"user-content-handling-protocol-messages\" class=\"anchor\" aria-label=\"Permalink: Handling Protocol Messages\" href=\"#handling-protocol-messages\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eEvery Protocol Message received by a Public Key Directory \u003cstrong\u003eMUST\u003c/strong\u003e be unique. Additionally, the timestamp for most\nmessage types (except \u003ccode\u003eRevokeKeyThirdParty\u003c/code\u003e) \u003cstrong\u003eMUST\u003c/strong\u003e be present and within a reasonable window. Public Key Directories\n\u003cstrong\u003eMAY\u003c/strong\u003e configure a preferred time window for timestamps, but it \u003cstrong\u003eMUST\u003c/strong\u003e be no greater than 30 days (2592000 seconds).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAfter parsing the Protocol Message, verify that the \u003ccode\u003e!pkd-context\u003c/code\u003e matches the expected value for a Public Key Directory\nProtocol Message. If it is absent or mismatched, discard the message. Servers \u003cstrong\u003eMAY\u003c/strong\u003e count this as an invalid message\nthat incurs a rate limit penalty, but it is not required.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eOnce we have established the \u003ccode\u003e!pkd-context\u003c/code\u003e matches, the \u003ccode\u003eaction\u003c/code\u003e should be examined. If the action is one of the following,\na valid HTTP Signature \u003cstrong\u003eMUST\u003c/strong\u003e have been sent with the message: \u003ccode\u003eAddKey\u003c/code\u003e, \u003ccode\u003eBurnDown\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIf the \u003ccode\u003eaction\u003c/code\u003e is not one of the expected values (see \u003ca href=\"#protocol-messages\"\u003eProtocol Messages\u003c/a\u003e), discard the message.\nThis may indicate a newer specification.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eNext, pass the deserialized JSON to a handler (function, class, etc.) for that specific action type. This behavior\n\u003cstrong\u003eMUST\u003c/strong\u003e implement the validation steps relevant to the appropriate Protocol Message.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAfter the message validation is complete, \u003ca href=\"#sigsum-integration\"\u003ecommit the Protocol Message to Sigsum\u003c/a\u003e. If the\nSigsum integration fails, return an HTTP 500 response to the client and abort.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eFinally, make the appropriate changes to the local database (based on what action is to be performed).\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eTOTP\u003c/h3\u003e\u003ca id=\"user-content-totp\" class=\"anchor\" aria-label=\"Permalink: TOTP\" href=\"#totp\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eEvery Fediverse instance may enroll a secret key for use with \u003ca href=\"https://www.rfc-editor.org/rfc/rfc6238.html\" rel=\"nofollow\"\u003eTOTP (RFC 6238)\u003c/a\u003e.\nIf one is enrolled for a given instance, an TOTP challenge will be required in order to successfully issue a\n\u003ca href=\"#burndown\"\u003eBurnDown\u003c/a\u003e protocol message, or to rotate or disenroll the TOTP secret.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eEvery Fediverse instance will have one TOTP secret that may be shared across administrators, for the following reasons:\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eThe Public Key Directory doesn't know which Actor on a given instance is an administrator, and which isn't.\u003c/li\u003e\n\u003cli\u003eIf an attacker gets root access to your instance, if TOTPs were per-Actor, they could just issue protocol messages\nfrom an Actor that has not enrolled a TOTP secret before. (Or enroll a fresh TOTP secret for a desired Actor.)\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp dir=\"auto\"\u003eInstead of per-Actor, we constrain the TOTP secret to affect the entire instance (should anyone choose to issue a\nBurnDown on behalf of other users).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThere are four TOTP operations, but none of them will result in a Protocol Message or change to the underlying Merkle\nTree state.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eTOTP Configuration\u003c/h4\u003e\u003ca id=\"user-content-totp-configuration\" class=\"anchor\" aria-label=\"Permalink: TOTP Configuration\" href=\"#totp-configuration\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eTime window size: \u003cstrong\u003e\u003ccode\u003e30\u003c/code\u003e seconds\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003eHash function: \u003cstrong\u003e\u003ccode\u003eSHA-512\u003c/code\u003e\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003eOTP length: \u003cstrong\u003e\u003ccode\u003e8\u003c/code\u003e digits\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eSome authenticator apps do not support these parameters.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eTOTP Enrollment\u003c/h4\u003e\u003ca id=\"user-content-totp-enrollment\" class=\"anchor\" aria-label=\"Permalink: TOTP Enrollment\" href=\"#totp-enrollment\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eTOTP secret keys must be 256 bits of randomness. This secret value will be encoded with base32\n(\u003ca href=\"https://www.rfc-editor.org/rfc/rfc4648.html#section-6\" rel=\"nofollow\"\u003eRFC 4648, section 6\u003c/a\u003e) when served to the end users (e.g.,\nvia a QR code).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThis secret must be shared with the Public Key Directory instance, \u003ca href=\"#encryption-of-protocol-messages\"\u003eencrypted with HPKE like Protocol Messages\u003c/a\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIn addition, the one-time passwords for two successive time windows must be included. Both of these one-time passwords\n\u003cstrong\u003eMUST\u003c/strong\u003e be valid for the decrypted secret key before it is accepted by the Public Key Directory.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThis operation \u003cstrong\u003eMUST\u003c/strong\u003e fail if there is already a TOTP secret enrolled for an instance.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eSee the \u003ca href=\"#post-apitotpenroll\"\u003ecorresponding JSON REST API endpoint\u003c/a\u003e for details.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eTOTP Disenrollment\u003c/h4\u003e\u003ca id=\"user-content-totp-disenrollment\" class=\"anchor\" aria-label=\"Permalink: TOTP Disenrollment\" href=\"#totp-disenrollment\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThis removes the TOTP shared secret for this instance stored in the Public Key Directory.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThis disables TOTP verification for BurnDown messages issued by the entire instance.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThis operation \u003cstrong\u003eMUST\u003c/strong\u003e fail if there is no TOTP secret enrolled for an instance.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eSee the \u003ca href=\"#post-apitotpdisenroll\"\u003ecorresponding JSON REST API endpoint\u003c/a\u003e for details.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eTOTP Rotation\u003c/h4\u003e\u003ca id=\"user-content-totp-rotation\" class=\"anchor\" aria-label=\"Permalink: TOTP Rotation\" href=\"#totp-rotation\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThis is congruent to disenrolling the old secret and enrolling a new secret in one step.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eSee the \u003ca href=\"#post-apitotprotate\"\u003ecorresponding JSON REST API endpoint\u003c/a\u003e for details.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eTOTP Signatures\u003c/h4\u003e\u003ca id=\"user-content-totp-signatures\" class=\"anchor\" aria-label=\"Permalink: TOTP Signatures\" href=\"#totp-signatures\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eHTTP requests to enroll, disenroll, or rotate the TOTP secret will include a \u003ca href=\"#protocol-signatures\"\u003econstruction congruent to protocol signatures\u003c/a\u003e,\nwith the following tweaks:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eThe \u003ccode\u003eaction\u003c/code\u003e will simply be \u003ccode\u003etotp-enroll\u003c/code\u003e, \u003ccode\u003etotp-disenroll\u003c/code\u003e, or \u003ccode\u003etotp-rotate\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eThe \u003ccode\u003emessage\u003c/code\u003e key will be replaced with \u003ccode\u003eenrollment\u003c/code\u003e, \u003ccode\u003edisenrollment\u003c/code\u003e, or \u003ccode\u003erotation\u003c/code\u003e.\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eIts contents will be serialized exactly the same as Protocol Messages, to facilitate code reuse.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eThe \u003ccode\u003erecent-merkle-root\u003c/code\u003e will be omitted.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eEach message-equivalent object \u003cstrong\u003eMUST\u003c/strong\u003e have an \u003ccode\u003eactor-id\u003c/code\u003e field, which allows the Public Key Directory software know\nwhich public key to use when verifying the message.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe Public Key Directory software \u003cstrong\u003eMUST\u003c/strong\u003e verify that the Actor ID belongs to the instance in scope for the TOTP.\nAdditionally, the HTTP Signature on the HTTP request body \u003cstrong\u003eMUST\u003c/strong\u003e also match the public key for the same actor.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eTOTP Verification\u003c/h4\u003e\u003ca id=\"user-content-totp-verification\" class=\"anchor\" aria-label=\"Permalink: TOTP Verification\" href=\"#totp-verification\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003ePer \u003ca href=\"https://datatracker.ietf.org/doc/html/rfc6238#section-5.2\" rel=\"nofollow\"\u003eRFC 6238, Section 5.2\u003c/a\u003e, each one-time password will have\na time-window size of 30 seconds, and a maximum of 2 previous windows will be accepted.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eWhen enrolling, two successive one-time passwords are necessary (both (t) and (t-1) for any given time window, t).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eDuring validation, only one valid window is accepted.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eJSON REST API\u003c/h3\u003e\u003ca id=\"user-content-json-rest-api\" class=\"anchor\" aria-label=\"Permalink: JSON REST API\" href=\"#json-rest-api\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThis section documents the JSON REST API available over HTTPS. Response bodies will be JSON (if the status code is 200).\nIf applicable, HTTP request bodies are also expected to be JSON.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eEvery HTTP response will include a signature over the HTTP response body, which will be sent as an additional HTTP\nheader, adhering to \u003ca href=\"https://www.rfc-editor.org/rfc/rfc9421.html#name-eddsa-using-curve-edwards25\" rel=\"nofollow\"\u003eRFC 9421 with EdDSA over edwards25519\u003c/a\u003e.\nPublic Key Directory software \u003cstrong\u003eMUST NOT\u003c/strong\u003e support the HMAC, RSA, ECDSA, or JWS signature algorithms from RFC 9421.\nOnly EdDSA and newer algorithms (e.g., post-quantum signatures in the future) may be used.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eGET api/actor/:actor_id\u003c/h4\u003e\u003ca id=\"user-content-get-apiactoractor_id\" class=\"anchor\" aria-label=\"Permalink: GET api/actor/:actor_id\" href=\"#get-apiactoractor_id\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003ePurpose: List aggregate data about a given actor.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIf there is no data for a given \u003ccode\u003e:actor_id\u003c/code\u003e, this will return an HTTP 404 error. This can happen if an Actor ID is not\nknown to this Public Key Directory or if a \u003cem\u003eRight To Be Forgotten\u003c/em\u003e takedown occurred.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAn HTTP 200 OK request will contain the following response fields:\u003c/p\u003e\n\u003cmarkdown-accessiblity-table\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eResponse Field\u003c/th\u003e\n\u003cth\u003eType\u003c/th\u003e\n\u003cth\u003eRemarks\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003e!pkd-context\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eDomain separation\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eactor-id\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eMatches the request parameter, sanitized\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ecount-aux\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003enumber\u003c/td\u003e\n\u003ctd\u003eThe number of auxiliary data records for this Actor\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ecount-keys\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003enumber\u003c/td\u003e\n\u003ctd\u003eThe number of active public keys for this Actor\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/markdown-accessiblity-table\u003e\n\u003cp dir=\"auto\"\u003eThe \u003ccode\u003e!pkd-context\u003c/code\u003e field will be set to the ASCII string \u003ccode\u003efedi-e2ee:v1/api/actor/info\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eExample Response\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{\n  \u0026quot;!pkd-context\u0026quot;: \u0026quot;fedi-e2ee:v1/api/actor/info\u0026quot;,\n  \u0026quot;actor-id\u0026quot;: \u0026quot;https://example.com/alice\u0026quot;,\n  \u0026quot;count-aux\u0026quot;: 5,\n  \u0026quot;count-keys\u0026quot;: 3\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"!pkd-context\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"fedi-e2ee:v1/api/actor/info\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"actor-id\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"https://example.com/alice\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"count-aux\"\u003c/span\u003e: \u003cspan class=\"pl-c1\"\u003e5\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"count-keys\"\u003c/span\u003e: \u003cspan class=\"pl-c1\"\u003e3\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eGET api/actor/:actor_id/keys\u003c/h4\u003e\u003ca id=\"user-content-get-apiactoractor_idkeys\" class=\"anchor\" aria-label=\"Permalink: GET api/actor/:actor_id/keys\" href=\"#get-apiactoractor_idkeys\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003ePurpose: List all currently-trusted public keys for a given actor.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIf there is no data for a given \u003ccode\u003e:actor_id\u003c/code\u003e, this will return an HTTP 404 error. This can happen if an Actor ID is not\nknown to this Public Key Directory or if a \u003cem\u003eRight To Be Forgotten\u003c/em\u003e takedown occurred.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAn HTTP 200 OK request will contain the following response fields:\u003c/p\u003e\n\u003cmarkdown-accessiblity-table\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eResponse Field\u003c/th\u003e\n\u003cth\u003eType\u003c/th\u003e\n\u003cth\u003eRemarks\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003e!pkd-context\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eDomain separation\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eactor-id\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eMatches the request parameter, sanitized\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003epublic-keys\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eobject[]\u003c/td\u003e\n\u003ctd\u003eArray of objects (see next table)\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/markdown-accessiblity-table\u003e\n\u003cp dir=\"auto\"\u003eThe \u003ccode\u003e!pkd-context\u003c/code\u003e field will be set to the ASCII string \u003ccode\u003efedi-e2ee:v1/api/actor/get-keys\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eEach entry in the \u003ccode\u003epublic-keys\u003c/code\u003e array will contain the following fields:\u003c/p\u003e\n\u003cmarkdown-accessiblity-table\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eResponse Field\u003c/th\u003e\n\u003cth\u003eType\u003c/th\u003e\n\u003cth\u003eRemarks\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ecreated\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003e\u003ca href=\"#timestamps\"\u003eTimestamp\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ekey-id\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eSee \u003ca href=\"#key-identifiers\"\u003eKey IDs\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003einclusion-proof\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring[]\u003c/td\u003e\n\u003ctd\u003eThe intermediate nodes on the path needed to validate this Protocol Message's Merkle root.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003emerkle-root\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eMerkle tree root hash for AddKey\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003epublic-key\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003ePublic key\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/markdown-accessiblity-table\u003e\n\u003cp dir=\"auto\"\u003eOnly non-revoked public keys will be included in this list.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eExample Response\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{\n  \u0026quot;!pkd-context\u0026quot;: \u0026quot;fedi-e2ee:v1/api/actor/get-keys\u0026quot;,\n  \u0026quot;actor-id\u0026quot;: \u0026quot;https://example.com/alice\u0026quot;,\n  \u0026quot;public-keys\u0026quot;: [\n    {\n      \u0026quot;created\u0026quot;: \u0026quot;1722176511\u0026quot;,\n      \u0026quot;key-id\u0026quot;: \u0026quot;foo\u0026quot;,\n      \u0026quot;inclusion-proof\u0026quot;: [\u0026quot;yWF2i5NqdyB9s0nEGnNQpoxSOcIwySMCch5xTOJurwE\u0026quot;, \u0026quot;b67xzsl8mtyMGphDa-DNJEyrM0lWIgp94W36svRxjW4\u0026quot;, \u0026quot;omGuBQqThwTt-hAFM7Pk_4Yx_21YNe8f8zX_Lxo9dpc\u0026quot;],\n      \u0026quot;merkle-root\u0026quot;: \u0026quot;pkd-mr-v1:rZgQvJn16wkOuNq3ejHqC0zDkuQ-3GBpCR0YP6Xy5yQ\u0026quot;,\n      \u0026quot;public-key\u0026quot;: \u0026quot;ed25519:Tm2XBvb0mAb4ldVubCzvz0HMTczR8VGF44sv478VFLM\u0026quot;\n    },\n    {\n      \u0026quot;created\u0026quot;: \u0026quot;1722603182\u0026quot;,\n      \u0026quot;key-id\u0026quot;: \u0026quot;bar\u0026quot;,\n      \u0026quot;inclusion-proof\u0026quot;: [\u0026quot;-h8Ld1pCvMEopujWQ3dcAW3D6_dgdnwfazlRfSSRXUM\u0026quot;, \u0026quot;b67xzsl8mtyMGphDa-DNJEyrM0lWIgp94W36svRxjW4\u0026quot;, \u0026quot;omGuBQqThwTt-hAFM7Pk_4Yx_21YNe8f8zX_Lxo9dpc\u0026quot;],\n      \u0026quot;merkle-root\u0026quot;: \u0026quot;pkd-mr-v1:p0n-vBu3mEx6BxnFKe6DDknwKUR8U42i8y_0VmEReg4\u0026quot;,\n      \u0026quot;public-key\u0026quot;: \u0026quot;ed25519:Tm2XBvb0mAb4ldVubCzvz0HMTczR8VGF44sv478VFLN\u0026quot;\n    },\n    {\n      \u0026quot;created\u0026quot;: \u0026quot;1730902833\u0026quot;,\n      \u0026quot;key-id\u0026quot;: \u0026quot;baz\u0026quot;,\n      \u0026quot;inclusion-proof\u0026quot;: [\u0026quot;bqtD85NcSflBq0XGVuTwtvnoZ7AZcZYdUm7V8ScF1LI\u0026quot;, \u0026quot;1ftW_n_zhfgCwenBdTaRJDEETmluqD3OPRN7hK8Jnvo\u0026quot;, \u0026quot;omGuBQqThwTt-hAFM7Pk_4Yx_21YNe8f8zX_Lxo9dpc\u0026quot;],\n      \u0026quot;merkle-root\u0026quot;: \u0026quot;pkd-mr-v1:HlRR_f1fFrRGu7Mczkdi41po07iP9JYjCp1GBb2y_nk\u0026quot;,\n      \u0026quot;public-key\u0026quot;: \u0026quot;ed25519:Tm2XBvb0mAb4ldVubCzvz0HMTczR8VGF44sv478VFLO\u0026quot;\n    }\n  ]\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"!pkd-context\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"fedi-e2ee:v1/api/actor/get-keys\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"actor-id\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"https://example.com/alice\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"public-keys\"\u003c/span\u003e: \u003cspan class=\"pl-kos\"\u003e[\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"created\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"1722176511\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"key-id\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"foo\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"inclusion-proof\"\u003c/span\u003e: \u003cspan class=\"pl-kos\"\u003e[\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"yWF2i5NqdyB9s0nEGnNQpoxSOcIwySMCch5xTOJurwE\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\"b67xzsl8mtyMGphDa-DNJEyrM0lWIgp94W36svRxjW4\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\"omGuBQqThwTt-hAFM7Pk_4Yx_21YNe8f8zX_Lxo9dpc\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e]\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"merkle-root\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"pkd-mr-v1:rZgQvJn16wkOuNq3ejHqC0zDkuQ-3GBpCR0YP6Xy5yQ\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"public-key\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"ed25519:Tm2XBvb0mAb4ldVubCzvz0HMTczR8VGF44sv478VFLM\"\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"created\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"1722603182\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"key-id\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"bar\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"inclusion-proof\"\u003c/span\u003e: \u003cspan class=\"pl-kos\"\u003e[\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"-h8Ld1pCvMEopujWQ3dcAW3D6_dgdnwfazlRfSSRXUM\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\"b67xzsl8mtyMGphDa-DNJEyrM0lWIgp94W36svRxjW4\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\"omGuBQqThwTt-hAFM7Pk_4Yx_21YNe8f8zX_Lxo9dpc\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e]\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"merkle-root\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"pkd-mr-v1:p0n-vBu3mEx6BxnFKe6DDknwKUR8U42i8y_0VmEReg4\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"public-key\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"ed25519:Tm2XBvb0mAb4ldVubCzvz0HMTczR8VGF44sv478VFLN\"\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"created\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"1730902833\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"key-id\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"baz\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"inclusion-proof\"\u003c/span\u003e: \u003cspan class=\"pl-kos\"\u003e[\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"bqtD85NcSflBq0XGVuTwtvnoZ7AZcZYdUm7V8ScF1LI\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\"1ftW_n_zhfgCwenBdTaRJDEETmluqD3OPRN7hK8Jnvo\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\"omGuBQqThwTt-hAFM7Pk_4Yx_21YNe8f8zX_Lxo9dpc\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e]\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"merkle-root\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"pkd-mr-v1:HlRR_f1fFrRGu7Mczkdi41po07iP9JYjCp1GBb2y_nk\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"public-key\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"ed25519:Tm2XBvb0mAb4ldVubCzvz0HMTczR8VGF44sv478VFLO\"\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"pl-kos\"\u003e]\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eGET api/actor/:actor_id/key/:key_id\u003c/h4\u003e\u003ca id=\"user-content-get-apiactoractor_idkeykey_id\" class=\"anchor\" aria-label=\"Permalink: GET api/actor/:actor_id/key/:key_id\" href=\"#get-apiactoractor_idkeykey_id\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003ePurpose: Retrieve information about a specific public key.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIf there is no data for a given \u003ccode\u003e:actor_id\u003c/code\u003e, this will return an HTTP 404 error. This can happen if an Actor ID is not\nknown to this Public Key Directory or if a \u003cem\u003eRight To Be Forgotten\u003c/em\u003e takedown occurred.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAn HTTP 200 OK request will contain the following response fields:\u003c/p\u003e\n\u003cmarkdown-accessiblity-table\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eResponse Field\u003c/th\u003e\n\u003cth\u003eType\u003c/th\u003e\n\u003cth\u003eRemarks\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003e!pkd-context\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eDomain separation\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eactor-id\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eMatches the request parameter, sanitized\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ecreated\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003e\u003ca href=\"#timestamps\"\u003eTimestamp\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003einclusion-proof\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring[]\u003c/td\u003e\n\u003ctd\u003eThe intermediate nodes on the path needed to validate this Protocol Message's Merkle root.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ekey-id\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eSee \u003ca href=\"#key-identifiers\"\u003eKey IDs\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003emerkle-root\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eMerkle tree root hash for AddKey\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003epublic-key\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003ePublic key\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003erevoked\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring | null\u003c/td\u003e\n\u003ctd\u003e\u003ca href=\"#timestamps\"\u003eTimestamp\u003c/a\u003e (or null)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003erevoke-root\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring | null\u003c/td\u003e\n\u003ctd\u003eMerkle tree root hash for RevokeKey (or null)\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/markdown-accessiblity-table\u003e\n\u003cp dir=\"auto\"\u003eThe \u003ccode\u003e!pkd-context\u003c/code\u003e field will be set to the ASCII string \u003ccode\u003efedi-e2ee:v1/api/actor/key-info\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eExample Response\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{\n  \u0026quot;!pkd-context\u0026quot;: \u0026quot;fedi-e2ee:v1/api/actor/key-info\u0026quot;,\n  \u0026quot;actor-id\u0026quot;: \u0026quot;https://example.com/alice\u0026quot;,\n  \u0026quot;created\u0026quot;: \u0026quot;1722176511\u0026quot;,\n  \u0026quot;inclusion-proof\u0026quot;: [\u0026quot;yWF2i5NqdyB9s0nEGnNQpoxSOcIwySMCch5xTOJurwE\u0026quot;, \u0026quot;b67xzsl8mtyMGphDa-DNJEyrM0lWIgp94W36svRxjW4\u0026quot;, \u0026quot;omGuBQqThwTt-hAFM7Pk_4Yx_21YNe8f8zX_Lxo9dpc\u0026quot;],\n  \u0026quot;key-id\u0026quot;: \u0026quot;foo\u0026quot;,\n  \u0026quot;merkle-root\u0026quot;: \u0026quot;pkd-mr-v1:rZgQvJn16wkOuNq3ejHqC0zDkuQ-3GBpCR0YP6Xy5yQ\u0026quot;,\n  \u0026quot;public-key\u0026quot;: \u0026quot;ed25519:Tm2XBvb0mAb4ldVubCzvz0HMTczR8VGF44sv478VFLM\u0026quot;,\n  \u0026quot;revoked\u0026quot;: null,\n  \u0026quot;revoke-root\u0026quot;: null\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"!pkd-context\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"fedi-e2ee:v1/api/actor/key-info\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"actor-id\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"https://example.com/alice\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"created\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"1722176511\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"inclusion-proof\"\u003c/span\u003e: \u003cspan class=\"pl-kos\"\u003e[\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"yWF2i5NqdyB9s0nEGnNQpoxSOcIwySMCch5xTOJurwE\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\"b67xzsl8mtyMGphDa-DNJEyrM0lWIgp94W36svRxjW4\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\"omGuBQqThwTt-hAFM7Pk_4Yx_21YNe8f8zX_Lxo9dpc\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e]\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"key-id\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"foo\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"merkle-root\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"pkd-mr-v1:rZgQvJn16wkOuNq3ejHqC0zDkuQ-3GBpCR0YP6Xy5yQ\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"public-key\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"ed25519:Tm2XBvb0mAb4ldVubCzvz0HMTczR8VGF44sv478VFLM\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"revoked\"\u003c/span\u003e: \u003cspan class=\"pl-c1\"\u003enull\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"revoke-root\"\u003c/span\u003e: \u003cspan class=\"pl-c1\"\u003enull\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eGET api/actor/:actor_id/auxiliary\u003c/h4\u003e\u003ca id=\"user-content-get-apiactoractor_idauxiliary\" class=\"anchor\" aria-label=\"Permalink: GET api/actor/:actor_id/auxiliary\" href=\"#get-apiactoractor_idauxiliary\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003ePurpose: List all currently-trusted auxiliary data for a given actor.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIf there is no data for a given \u003ccode\u003e:actor_id\u003c/code\u003e, this will return an HTTP 404 error. This can happen if an Actor ID is not\nknown to this Public Key Directory or if a \u003cem\u003eRight To Be Forgotten\u003c/em\u003e takedown occurred.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAn HTTP 200 OK request will contain the following response fields:\u003c/p\u003e\n\u003cmarkdown-accessiblity-table\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eResponse Field\u003c/th\u003e\n\u003cth\u003eType\u003c/th\u003e\n\u003cth\u003eRemarks\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003e!pkd-context\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eDomain separation\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eactor-id\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eMatches the request parameter, sanitized\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eauxiliary\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eobject[]\u003c/td\u003e\n\u003ctd\u003eArray of objects (see next table)\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/markdown-accessiblity-table\u003e\n\u003cp dir=\"auto\"\u003eThe \u003ccode\u003e!pkd-context\u003c/code\u003e field will be set to the ASCII string \u003ccode\u003efedi-e2ee:v1/api/actor/aux-info\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eEach entry in the \u003ccode\u003eauxiliary\u003c/code\u003e array will contain the following fields:\u003c/p\u003e\n\u003cmarkdown-accessiblity-table\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eResponse Field\u003c/th\u003e\n\u003cth\u003eType\u003c/th\u003e\n\u003cth\u003eRemarks\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eaux-id\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003e\u003ca href=\"#auxiliary-data-identifiers\"\u003eAuxiliary Data ID\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eaux-type\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003e\u003ca href=\"#auxiliary-data\"\u003eAuxiliary Data Type\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ecreated\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003e\u003ca href=\"#timestamps\"\u003eTimestamp\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/markdown-accessiblity-table\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eExample Response\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{\n  \u0026quot;!pkd-context\u0026quot;: \u0026quot;fedi-e2ee:v1/api/actor/aux-info\u0026quot;,\n  \u0026quot;actor-id\u0026quot;: \u0026quot;https://example.com/alice\u0026quot;,\n  \u0026quot;auxiliary\u0026quot;: [\n    {\n      \u0026quot;aux-id\u0026quot;: \u0026quot;XUUDSZSwIWsanCX9Dr4WH5g9p1_pTaK6hZymeISJI0A\u0026quot;,\n      \u0026quot;aux-type\u0026quot;: \u0026quot;age-v1\u0026quot;,\n      \u0026quot;created\u0026quot;: \u0026quot;1730902834\u0026quot;\n    },\n    {\n      \u0026quot;aux-id\u0026quot;: \u0026quot;qVca3ELZdRW2yGZj8kfbynFKPDrOCoKzFJlqwquzfDw\u0026quot;,\n      \u0026quot;aux-type\u0026quot;: \u0026quot;openssh\u0026quot;,\n      \u0026quot;created\u0026quot;: \u0026quot;1730902835\u0026quot;\n    },\n    {\n      \u0026quot;aux-id\u0026quot;: \u0026quot;qKqisbMDuIUu3BARNxZC3eTlmkVdCCOhW96fwX66-tg\u0026quot;,\n      \u0026quot;aux-type\u0026quot;: \u0026quot;minisign\u0026quot;,\n      \u0026quot;created\u0026quot;: \u0026quot;1730902836\u0026quot;\n    },\n    {\n      \u0026quot;aux-id\u0026quot;: \u0026quot;nSQbDDlBUmyGnY0TWoNT00vlxzNerRJP9vSwjqKDPU8\u0026quot;,\n      \u0026quot;aux-type\u0026quot;: \u0026quot;matrix-v3\u0026quot;,\n      \u0026quot;created\u0026quot;: \u0026quot;1730902837\u0026quot;\n    },\n    {\n      \u0026quot;aux-id\u0026quot;: \u0026quot;wb9dIfesihn9g0gpyL_sMVdFuUYY3ZfQXnGCFy-F53Y\u0026quot;,\n      \u0026quot;aux-type\u0026quot;: \u0026quot;openpgp\u0026quot;,\n      \u0026quot;created\u0026quot;: \u0026quot;1730902838\u0026quot;\n    }\n  ]\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"!pkd-context\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"fedi-e2ee:v1/api/actor/aux-info\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"actor-id\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"https://example.com/alice\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"auxiliary\"\u003c/span\u003e: \u003cspan class=\"pl-kos\"\u003e[\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"aux-id\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"XUUDSZSwIWsanCX9Dr4WH5g9p1_pTaK6hZymeISJI0A\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"aux-type\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"age-v1\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"created\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"1730902834\"\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"aux-id\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"qVca3ELZdRW2yGZj8kfbynFKPDrOCoKzFJlqwquzfDw\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"aux-type\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"openssh\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"created\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"1730902835\"\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"aux-id\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"qKqisbMDuIUu3BARNxZC3eTlmkVdCCOhW96fwX66-tg\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"aux-type\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"minisign\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"created\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"1730902836\"\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"aux-id\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"nSQbDDlBUmyGnY0TWoNT00vlxzNerRJP9vSwjqKDPU8\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"aux-type\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"matrix-v3\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"created\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"1730902837\"\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"aux-id\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"wb9dIfesihn9g0gpyL_sMVdFuUYY3ZfQXnGCFy-F53Y\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"aux-type\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"openpgp\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"created\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"1730902838\"\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"pl-kos\"\u003e]\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eGET api/actor/:actor_id/auxiliary/:aux_data_id\u003c/h4\u003e\u003ca id=\"user-content-get-apiactoractor_idauxiliaryaux_data_id\" class=\"anchor\" aria-label=\"Permalink: GET api/actor/:actor_id/auxiliary/:aux_data_id\" href=\"#get-apiactoractor_idauxiliaryaux_data_id\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003ePurpose: Retrieve information about a specific auxiliary data.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIf there is no data for a given \u003ccode\u003e:actor_id\u003c/code\u003e, this will return an HTTP 404 error. This can happen if an Actor ID is not\nknown to this Public Key Directory or if a \u003cem\u003eRight To Be Forgotten\u003c/em\u003e takedown occurred.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAn HTTP 200 OK request will contain the following response fields:\u003c/p\u003e\n\u003cmarkdown-accessiblity-table\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eResponse Field\u003c/th\u003e\n\u003cth\u003eType\u003c/th\u003e\n\u003cth\u003eRemarks\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003e!pkd-context\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eDomain separation\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eactor-id\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eMatches the request parameter, sanitized\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eaux-data\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eAuxiliary Data Contents\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eaux-id\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003e\u003ca href=\"#auxiliary-data-identifiers\"\u003eAuxiliary Data ID\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eaux-type\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003e\u003ca href=\"#auxiliary-data\"\u003eAuxiliary Data Type\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ecreated\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003e\u003ca href=\"#timestamps\"\u003eTimestamp\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003einclusion-proof\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring[]\u003c/td\u003e\n\u003ctd\u003eThe intermediate nodes on the path needed to validate this Protocol Message's Merkle root.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003emerkle-root\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eMerkle tree root hash for AddAuxData\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003erevoked\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring | null\u003c/td\u003e\n\u003ctd\u003e\u003ca href=\"#timestamps\"\u003eTimestamp\u003c/a\u003e (or null)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003erevoke-root\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring | null\u003c/td\u003e\n\u003ctd\u003eMerkle tree root hash for RevokeAuxData (or null)\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/markdown-accessiblity-table\u003e\n\u003cp dir=\"auto\"\u003eThe \u003ccode\u003e!pkd-context\u003c/code\u003e field will be set to the ASCII string \u003ccode\u003efedi-e2ee:v1/api/actor/get-aux\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eExample Response\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{\n  \u0026quot;!pkd-context\u0026quot;: \u0026quot;fedi-e2ee:v1/api/actor/get-aux\u0026quot;,\n  \u0026quot;actor-id\u0026quot;: \u0026quot;https://example.com/alice\u0026quot;,\n  \u0026quot;aux-data\u0026quot;: \u0026quot;age1ql3z7hjy54pw3hyww5ayyfg7zqgvc7w3j2elw8zmrj2kg5sfn9aqmcac8p\u0026quot;,\n  \u0026quot;aux-id\u0026quot;: \u0026quot;XUUDSZSwIWsanCX9Dr4WH5g9p1_pTaK6hZymeISJI0A\u0026quot;,\n  \u0026quot;aux-type\u0026quot;: \u0026quot;age-v1\u0026quot;,\n  \u0026quot;created\u0026quot;: \u0026quot;1730902834\u0026quot;,\n  \u0026quot;inclusion-proof\u0026quot;: [\u0026quot;O4BrUUtPYC3PWIr6uo0o8-zMrH4hT43WLmNrpUJTpKk\u0026quot;, \u0026quot;s-91v_WIcTNuyI-EbVTJs71Vq0iNbwj3dWN7akDj5jw\u0026quot;, \u0026quot;omGuBQqThwTt-hAFM7Pk_4Yx_21YNe8f8zX_Lxo9dpc\u0026quot;],\n  \u0026quot;merkle-root\u0026quot;: \u0026quot;pkd-mr-v1:KOspo1eBvXE9ZPyyNmW1sqqFeLqLA5f1LBCYHct1n9c\u0026quot;,\n  \u0026quot;revoked\u0026quot;: null,\n  \u0026quot;revoke-root\u0026quot;: null\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"!pkd-context\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"fedi-e2ee:v1/api/actor/get-aux\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"actor-id\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"https://example.com/alice\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"aux-data\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"age1ql3z7hjy54pw3hyww5ayyfg7zqgvc7w3j2elw8zmrj2kg5sfn9aqmcac8p\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"aux-id\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"XUUDSZSwIWsanCX9Dr4WH5g9p1_pTaK6hZymeISJI0A\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"aux-type\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"age-v1\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"created\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"1730902834\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"inclusion-proof\"\u003c/span\u003e: \u003cspan class=\"pl-kos\"\u003e[\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"O4BrUUtPYC3PWIr6uo0o8-zMrH4hT43WLmNrpUJTpKk\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\"s-91v_WIcTNuyI-EbVTJs71Vq0iNbwj3dWN7akDj5jw\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\"omGuBQqThwTt-hAFM7Pk_4Yx_21YNe8f8zX_Lxo9dpc\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e]\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"merkle-root\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"pkd-mr-v1:KOspo1eBvXE9ZPyyNmW1sqqFeLqLA5f1LBCYHct1n9c\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"revoked\"\u003c/span\u003e: \u003cspan class=\"pl-c1\"\u003enull\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"revoke-root\"\u003c/span\u003e: \u003cspan class=\"pl-c1\"\u003enull\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eGET api/history\u003c/h4\u003e\u003ca id=\"user-content-get-apihistory\" class=\"anchor\" aria-label=\"Permalink: GET api/history\" href=\"#get-apihistory\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003ePurpose: View the latest hash stored in the message history.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAn HTTP 200 OK request will contain the following response fields:\u003c/p\u003e\n\u003cmarkdown-accessiblity-table\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eResponse Field\u003c/th\u003e\n\u003cth\u003eType\u003c/th\u003e\n\u003cth\u003eRemarks\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003e!pkd-context\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eDomain separation\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ecurrent-time\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003e\u003ca href=\"#timestamps\"\u003eTimestamp\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ecreated\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003e\u003ca href=\"#timestamps\"\u003eTimestamp\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003emerkle-root\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eMerkle tree root hash for the latest record\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/markdown-accessiblity-table\u003e\n\u003cp dir=\"auto\"\u003eThe \u003ccode\u003e!pkd-context\u003c/code\u003e field will be set to the ASCII string \u003ccode\u003efedi-e2ee:v1/api/history\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eExample Response\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{\n  \u0026quot;!pkd-context\u0026quot;: \u0026quot;fedi-e2ee:v1/api/history\u0026quot;,\n  \u0026quot;current-time\u0026quot;: \u0026quot;1730905988\u0026quot;,\n  \u0026quot;created\u0026quot;: \u0026quot;1601016659\u0026quot;,\n  \u0026quot;merkle-root\u0026quot;: \u0026quot;pkd-mr-v1:XINzPw6Z8ygzDQSZVpGtUmjVIqGVkkzWat_tkuWit3M\u0026quot;\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"!pkd-context\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"fedi-e2ee:v1/api/history\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"current-time\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"1730905988\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"created\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"1601016659\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"merkle-root\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"pkd-mr-v1:XINzPw6Z8ygzDQSZVpGtUmjVIqGVkkzWat_tkuWit3M\"\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eGET api/history/since/:last_hash\u003c/h4\u003e\u003ca id=\"user-content-get-apihistorysincelast_hash\" class=\"anchor\" aria-label=\"Permalink: GET api/history/since/:last_hash\" href=\"#get-apihistorysincelast_hash\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003ePurpose: List up to \u003ccode\u003ePAGINATION_LIMIT\u003c/code\u003e hashes starting after the provided hash, in sequence.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAn HTTP 200 OK request will contain the following response fields:\u003c/p\u003e\n\u003cmarkdown-accessiblity-table\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eResponse Field\u003c/th\u003e\n\u003cth\u003eType\u003c/th\u003e\n\u003cth\u003eRemarks\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003e!pkd-context\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eDomain separation\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ecurrent-time\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003e\u003ca href=\"#timestamps\"\u003eTimestamp\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003erecords\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eobject[]\u003c/td\u003e\n\u003ctd\u003eArray of objects (see next table)\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/markdown-accessiblity-table\u003e\n\u003cp dir=\"auto\"\u003eThe \u003ccode\u003e!pkd-context\u003c/code\u003e field will be set to the ASCII string \u003ccode\u003efedi-e2ee:v1/api/history/since\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eEach entry in the \u003ccode\u003erecords\u003c/code\u003e array will contain the following fields:\u003c/p\u003e\n\u003cmarkdown-accessiblity-table\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eResponse Field\u003c/th\u003e\n\u003cth\u003eType\u003c/th\u003e\n\u003cth\u003eRemarks\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ecreated\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003e\u003ca href=\"#timestamps\"\u003eTimestamp\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eencrypted-message\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eProtocol message \u003ca href=\"#encrypting-message-attributes-to-enable-crypto-shredding\"\u003ewith encrypted attributes\u003c/a\u003e (committed to Merkle tree)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003emessage\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003emap | null\u003c/td\u003e\n\u003ctd\u003eDecrypted protocol message (or null)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003emerkle-root\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eMerkle tree root hash for the latest record\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003erewrapped-keys\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003emap\u0026lt;string, object\u0026gt; | null\u003c/td\u003e\n\u003ctd\u003eArray of objects (re-wrapped symmetric keys for each field)\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/markdown-accessiblity-table\u003e\n\u003cp dir=\"auto\"\u003eThe optional \u003ccode\u003erewrapped-keys\u003c/code\u003e field maps a Trusted Replica's fully qualified domain name to an object.\u003cbr\u003e\nThis object contains the re-wrapped symmetric key for each encrypted field that the Trusted Replica is\npermitted to persist.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eExample Response\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{\n  \u0026quot;!pkd-context\u0026quot;: \u0026quot;fedi-e2ee:v1/api/history/since\u0026quot;,\n  \u0026quot;created\u0026quot;: \u0026quot;1730905988\u0026quot;,\n  \u0026quot;encrypted-message\u0026quot;: \u0026quot;{\\\u0026quot;!pkd-context\\\u0026quot;:\\\u0026quot;https://github.com/fedi-e2ee/public-key-directory/v1\\\u0026quot;,\\\u0026quot;action\\\u0026quot;:\\\u0026quot;AddAuxData\\\u0026quot;,\\\u0026quot;message\\\u0026quot;:{\\\u0026quot;aux-type\\\u0026quot;:\\\u0026quot;ATPXFWGIhyAXzCn7P-Uf2Y5KG28Yk6rg-qjsrhj0dRpTDw5mofhwnWx0ApiYHfwNZ0tDyNrRqBX3lLailS5sdvRpUkwIgwkojB-EzKg3vKzQibxUcBRcZTMoW05DYj9araX3Prs\\\u0026quot;,\\\u0026quot;aux-id\\\u0026quot;:\\\u0026quot;AVVV8gY_bVH7E4BJc4vdWngzSLbOBZCEpq4qQdqozqTfI2mSRHK1bg3NtUQ6oZt34XEdGo8LttPO4hpQeroaotDBzU8PNIjDZercEdjh5Jb5rEBageABiJxlD7zxp31J6nWKnY2_ZEUMWGm5RYjZ9I94UxkrKx2zH1CtYwv2cMw8-7PPst3wIArhUUw\\\u0026quot;,\\\u0026quot;aux-data\\\u0026quot;:\\\u0026quot;ATkdBpiXZa3Va3d4FYrh-q_-NLcTMLPhuIsujD19laqtA9uYvTZtKsPYo88p6GOOodsGe9Vkk3C_-BFIeVIH1bPBU2q3M_ggEjZ-HC1JyWrKFg92fUQDTxcP4Rf8Ow1lsBoyy9YSxwUXisbIjN4qnvkL7KiXXRk\\\u0026quot;,\\\u0026quot;time\\\u0026quot;:\\\u0026quot;1730908981\\\u0026quot;},\\\u0026quot;recent-merkle-root\\\u0026quot;:\\\u0026quot;ukjCV9E7aCAVKmobj_nvn-1AwTi6Ju21GsVHewiQdBA\\\u0026quot;,\\\u0026quot;signature\\\u0026quot;:\\\u0026quot;BlFdZqQIG6in0q4pCcK2HEng2iAKbL6R4Fhsst3WYYKV1aubg30RkPFI5HNATREa00Lc_IXPbsUZZcTW3W9JBg\\\u0026quot;}\u0026quot;,\n  \u0026quot;message\u0026quot;: {\n    \u0026quot;!pkd-context\u0026quot;: \u0026quot;https://github.com/fedi-e2ee/public-key-directory/v1\u0026quot;,\n    \u0026quot;action\u0026quot;: \u0026quot;AddAuxData\u0026quot;,\n    \u0026quot;message\u0026quot;: {\n      \u0026quot;aux-type\u0026quot;: \u0026quot;test\u0026quot;,\n      \u0026quot;aux-id\u0026quot;: \u0026quot;ntwVcdQXw0x2U8iBy78jFgv7zs2wipBRIYv9qz6KS0Y\u0026quot;,\n      \u0026quot;aux-data\u0026quot;: \u0026quot;this-is-just-test-data\u0026quot;,\n      \u0026quot;time\u0026quot;: \u0026quot;1730908981\u0026quot;\n    },\n    \u0026quot;recent-merkle-root\u0026quot;: \u0026quot;pkd-mr-v1:ukjCV9E7aCAVKmobj_nvn-1AwTi6Ju21GsVHewiQdBA\u0026quot;,\n    \u0026quot;signature\u0026quot;: \u0026quot;BlFdZqQIG6in0q4pCcK2HEng2iAKbL6R4Fhsst3WYYKV1aubg30RkPFI5HNATREa00Lc_IXPbsUZZcTW3W9JBg\u0026quot;\n  },\n  \u0026quot;merkle-root\u0026quot;: \u0026quot;pkd-mr-v1:Io01AlF_FeRiJounhQjty3tsxEKHekPVTd7r_3BHpXc\u0026quot;,\n  \u0026quot;rewrapped-keys\u0026quot;: {\n    \u0026quot;example.foo.bar\u0026quot;: {\n      \u0026quot;aux-type\u0026quot;: \u0026quot;\u0026lt;hpke ciphertext goes here\u0026gt;\u0026quot;,\n    }\n  }\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"!pkd-context\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"fedi-e2ee:v1/api/history/since\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"created\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"1730905988\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"encrypted-message\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"{\\\"!pkd-context\\\":\\\"https://github.com/fedi-e2ee/public-key-directory/v1\\\",\\\"action\\\":\\\"AddAuxData\\\",\\\"message\\\":{\\\"aux-type\\\":\\\"ATPXFWGIhyAXzCn7P-Uf2Y5KG28Yk6rg-qjsrhj0dRpTDw5mofhwnWx0ApiYHfwNZ0tDyNrRqBX3lLailS5sdvRpUkwIgwkojB-EzKg3vKzQibxUcBRcZTMoW05DYj9araX3Prs\\\",\\\"aux-id\\\":\\\"AVVV8gY_bVH7E4BJc4vdWngzSLbOBZCEpq4qQdqozqTfI2mSRHK1bg3NtUQ6oZt34XEdGo8LttPO4hpQeroaotDBzU8PNIjDZercEdjh5Jb5rEBageABiJxlD7zxp31J6nWKnY2_ZEUMWGm5RYjZ9I94UxkrKx2zH1CtYwv2cMw8-7PPst3wIArhUUw\\\",\\\"aux-data\\\":\\\"ATkdBpiXZa3Va3d4FYrh-q_-NLcTMLPhuIsujD19laqtA9uYvTZtKsPYo88p6GOOodsGe9Vkk3C_-BFIeVIH1bPBU2q3M_ggEjZ-HC1JyWrKFg92fUQDTxcP4Rf8Ow1lsBoyy9YSxwUXisbIjN4qnvkL7KiXXRk\\\",\\\"time\\\":\\\"1730908981\\\"},\\\"recent-merkle-root\\\":\\\"ukjCV9E7aCAVKmobj_nvn-1AwTi6Ju21GsVHewiQdBA\\\",\\\"signature\\\":\\\"BlFdZqQIG6in0q4pCcK2HEng2iAKbL6R4Fhsst3WYYKV1aubg30RkPFI5HNATREa00Lc_IXPbsUZZcTW3W9JBg\\\"}\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"message\"\u003c/span\u003e: \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"pl-s\"\u003e\"!pkd-context\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"https://github.com/fedi-e2ee/public-key-directory/v1\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"pl-s\"\u003e\"action\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"AddAuxData\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"pl-s\"\u003e\"message\"\u003c/span\u003e: \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"aux-type\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"test\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"aux-id\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"ntwVcdQXw0x2U8iBy78jFgv7zs2wipBRIYv9qz6KS0Y\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"aux-data\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"this-is-just-test-data\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"time\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"1730908981\"\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"pl-s\"\u003e\"recent-merkle-root\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"pkd-mr-v1:ukjCV9E7aCAVKmobj_nvn-1AwTi6Ju21GsVHewiQdBA\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"pl-s\"\u003e\"signature\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"BlFdZqQIG6in0q4pCcK2HEng2iAKbL6R4Fhsst3WYYKV1aubg30RkPFI5HNATREa00Lc_IXPbsUZZcTW3W9JBg\"\u003c/span\u003e\n  \u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"merkle-root\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"pkd-mr-v1:Io01AlF_FeRiJounhQjty3tsxEKHekPVTd7r_3BHpXc\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"rewrapped-keys\"\u003c/span\u003e: \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"pl-s\"\u003e\"example.foo.bar\"\u003c/span\u003e: \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"aux-type\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"\u0026lt;hpke ciphertext goes here\u0026gt;\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIn the above example, dummy values were used for Merkle roots.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eGET api/history/view/:hash\u003c/h4\u003e\u003ca id=\"user-content-get-apihistoryviewhash\" class=\"anchor\" aria-label=\"Permalink: GET api/history/view/:hash\" href=\"#get-apihistoryviewhash\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003ePurpose: View information about a specific protocol message. This will also return SigSum inclusion proofs and witness\nco-signatures.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAn HTTP 200 OK request will contain the following response fields:\u003c/p\u003e\n\u003cmarkdown-accessiblity-table\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eResponse Field\u003c/th\u003e\n\u003cth\u003eType\u003c/th\u003e\n\u003cth\u003eRemarks\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003e!pkd-context\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eDomain separation\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ecreated\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003e\u003ca href=\"#timestamps\"\u003eTimestamp\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eencrypted-message\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eProtocol message \u003ca href=\"#encrypting-message-attributes-to-enable-crypto-shredding\"\u003ewith encrypted attributes\u003c/a\u003e (committed to Merkle tree)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003einclusion-proof\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring[]\u003c/td\u003e\n\u003ctd\u003eThe intermediate nodes on the path needed to validate this Protocol Message's Merkle root.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003emessage\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003emap | null\u003c/td\u003e\n\u003ctd\u003eDecrypted protocol message (or null)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003emerkle-root\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eMerkle tree root hash for the latest record\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003erewrapped-keys\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003emap\u0026lt;string, object\u0026gt; | null\u003c/td\u003e\n\u003ctd\u003eArray of objects (re-wrapped symmetric keys for each field)\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/markdown-accessiblity-table\u003e\n\u003cp dir=\"auto\"\u003eThe \u003ccode\u003e!pkd-context\u003c/code\u003e field will be set to the ASCII string \u003ccode\u003efedi-e2ee:v1/api/history/view\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe optional \u003ccode\u003erewrapped-keys\u003c/code\u003e field maps a Trusted Replica's fully qualified domain name to an object.\u003cbr\u003e\nThis object contains the re-wrapped symmetric key for each encrypted field that the Trusted Replica is\npermitted to persist.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eExample Response\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{\n  \u0026quot;!pkd-context\u0026quot;: \u0026quot;fedi-e2ee:v1/api/history/view\u0026quot;,\n  \u0026quot;created\u0026quot;: \u0026quot;1730905988\u0026quot;,\n  \u0026quot;encrypted-message\u0026quot;: \u0026quot;{\\\u0026quot;!pkd-context\\\u0026quot;:\\\u0026quot;https://github.com/fedi-e2ee/public-key-directory/v1\\\u0026quot;,\\\u0026quot;action\\\u0026quot;:\\\u0026quot;AddAuxData\\\u0026quot;,\\\u0026quot;message\\\u0026quot;:{\\\u0026quot;aux-type\\\u0026quot;:\\\u0026quot;ATPXFWGIhyAXzCn7P-Uf2Y5KG28Yk6rg-qjsrhj0dRpTDw5mofhwnWx0ApiYHfwNZ0tDyNrRqBX3lLailS5sdvRpUkwIgwkojB-EzKg3vKzQibxUcBRcZTMoW05DYj9araX3Prs\\\u0026quot;,\\\u0026quot;aux-id\\\u0026quot;:\\\u0026quot;AVVV8gY_bVH7E4BJc4vdWngzSLbOBZCEpq4qQdqozqTfI2mSRHK1bg3NtUQ6oZt34XEdGo8LttPO4hpQeroaotDBzU8PNIjDZercEdjh5Jb5rEBageABiJxlD7zxp31J6nWKnY2_ZEUMWGm5RYjZ9I94UxkrKx2zH1CtYwv2cMw8-7PPst3wIArhUUw\\\u0026quot;,\\\u0026quot;aux-data\\\u0026quot;:\\\u0026quot;ATkdBpiXZa3Va3d4FYrh-q_-NLcTMLPhuIsujD19laqtA9uYvTZtKsPYo88p6GOOodsGe9Vkk3C_-BFIeVIH1bPBU2q3M_ggEjZ-HC1JyWrKFg92fUQDTxcP4Rf8Ow1lsBoyy9YSxwUXisbIjN4qnvkL7KiXXRk\\\u0026quot;,\\\u0026quot;time\\\u0026quot;:\\\u0026quot;1730908981\\\u0026quot;},\\\u0026quot;recent-merkle-root\\\u0026quot;:\\\u0026quot;ukjCV9E7aCAVKmobj_nvn-1AwTi6Ju21GsVHewiQdBA\\\u0026quot;,\\\u0026quot;signature\\\u0026quot;:\\\u0026quot;BlFdZqQIG6in0q4pCcK2HEng2iAKbL6R4Fhsst3WYYKV1aubg30RkPFI5HNATREa00Lc_IXPbsUZZcTW3W9JBg\\\u0026quot;}\u0026quot;,\n  \u0026quot;inclusion-proof\u0026quot;: [\u0026quot;w3N3BU44g4MLC-sDGSzr1nJO9jmZfh_yq1bhpLjjWmo\u0026quot;, \u0026quot;MMh4YxMTJLUW5m-6TuyfVhL3bxPF5fnXKbajEVJeO_s\u0026quot;, \u0026quot;5Oagf2KpIxEschB1bjyUCG9E8ap_7chIQFHyU4yJy1I\u0026quot;],\n  \u0026quot;message\u0026quot;: {\n    \u0026quot;!pkd-context\u0026quot;: \u0026quot;https://github.com/fedi-e2ee/public-key-directory/v1\u0026quot;,\n    \u0026quot;action\u0026quot;: \u0026quot;AddAuxData\u0026quot;,\n    \u0026quot;message\u0026quot;: {\n      \u0026quot;aux-type\u0026quot;: \u0026quot;test\u0026quot;,\n      \u0026quot;aux-id\u0026quot;: \u0026quot;ntwVcdQXw0x2U8iBy78jFgv7zs2wipBRIYv9qz6KS0Y\u0026quot;,\n      \u0026quot;aux-data\u0026quot;: \u0026quot;this-is-just-test-data\u0026quot;,\n      \u0026quot;time\u0026quot;: \u0026quot;1730908981\u0026quot;\n    },\n    \u0026quot;recent-merkle-root\u0026quot;: \u0026quot;pkd-mr-v1:ukjCV9E7aCAVKmobj_nvn-1AwTi6Ju21GsVHewiQdBA\u0026quot;,\n    \u0026quot;signature\u0026quot;: \u0026quot;BlFdZqQIG6in0q4pCcK2HEng2iAKbL6R4Fhsst3WYYKV1aubg30RkPFI5HNATREa00Lc_IXPbsUZZcTW3W9JBg\u0026quot;\n  },\n  \u0026quot;merkle-root\u0026quot;: \u0026quot;pkd-mr-v1:Io01AlF_FeRiJounhQjty3tsxEKHekPVTd7r_3BHpXc\u0026quot;,\n  \u0026quot;rewrapped-keys\u0026quot;: {\n    \u0026quot;example.foo.bar\u0026quot;: {\n      \u0026quot;aux-type\u0026quot;: \u0026quot;\u0026lt;hpke ciphertext goes here\u0026gt;\u0026quot;,\n    }\n  }\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"!pkd-context\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"fedi-e2ee:v1/api/history/view\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"created\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"1730905988\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"encrypted-message\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"{\\\"!pkd-context\\\":\\\"https://github.com/fedi-e2ee/public-key-directory/v1\\\",\\\"action\\\":\\\"AddAuxData\\\",\\\"message\\\":{\\\"aux-type\\\":\\\"ATPXFWGIhyAXzCn7P-Uf2Y5KG28Yk6rg-qjsrhj0dRpTDw5mofhwnWx0ApiYHfwNZ0tDyNrRqBX3lLailS5sdvRpUkwIgwkojB-EzKg3vKzQibxUcBRcZTMoW05DYj9araX3Prs\\\",\\\"aux-id\\\":\\\"AVVV8gY_bVH7E4BJc4vdWngzSLbOBZCEpq4qQdqozqTfI2mSRHK1bg3NtUQ6oZt34XEdGo8LttPO4hpQeroaotDBzU8PNIjDZercEdjh5Jb5rEBageABiJxlD7zxp31J6nWKnY2_ZEUMWGm5RYjZ9I94UxkrKx2zH1CtYwv2cMw8-7PPst3wIArhUUw\\\",\\\"aux-data\\\":\\\"ATkdBpiXZa3Va3d4FYrh-q_-NLcTMLPhuIsujD19laqtA9uYvTZtKsPYo88p6GOOodsGe9Vkk3C_-BFIeVIH1bPBU2q3M_ggEjZ-HC1JyWrKFg92fUQDTxcP4Rf8Ow1lsBoyy9YSxwUXisbIjN4qnvkL7KiXXRk\\\",\\\"time\\\":\\\"1730908981\\\"},\\\"recent-merkle-root\\\":\\\"ukjCV9E7aCAVKmobj_nvn-1AwTi6Ju21GsVHewiQdBA\\\",\\\"signature\\\":\\\"BlFdZqQIG6in0q4pCcK2HEng2iAKbL6R4Fhsst3WYYKV1aubg30RkPFI5HNATREa00Lc_IXPbsUZZcTW3W9JBg\\\"}\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"inclusion-proof\"\u003c/span\u003e: \u003cspan class=\"pl-kos\"\u003e[\u003c/span\u003e\u003cspan class=\"pl-s\"\u003e\"w3N3BU44g4MLC-sDGSzr1nJO9jmZfh_yq1bhpLjjWmo\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\"MMh4YxMTJLUW5m-6TuyfVhL3bxPF5fnXKbajEVJeO_s\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \u003cspan class=\"pl-s\"\u003e\"5Oagf2KpIxEschB1bjyUCG9E8ap_7chIQFHyU4yJy1I\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e]\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"message\"\u003c/span\u003e: \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"pl-s\"\u003e\"!pkd-context\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"https://github.com/fedi-e2ee/public-key-directory/v1\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"pl-s\"\u003e\"action\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"AddAuxData\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"pl-s\"\u003e\"message\"\u003c/span\u003e: \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"aux-type\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"test\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"aux-id\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"ntwVcdQXw0x2U8iBy78jFgv7zs2wipBRIYv9qz6KS0Y\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"aux-data\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"this-is-just-test-data\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"time\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"1730908981\"\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"pl-s\"\u003e\"recent-merkle-root\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"pkd-mr-v1:ukjCV9E7aCAVKmobj_nvn-1AwTi6Ju21GsVHewiQdBA\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"pl-s\"\u003e\"signature\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"BlFdZqQIG6in0q4pCcK2HEng2iAKbL6R4Fhsst3WYYKV1aubg30RkPFI5HNATREa00Lc_IXPbsUZZcTW3W9JBg\"\u003c/span\u003e\n  \u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"merkle-root\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"pkd-mr-v1:Io01AlF_FeRiJounhQjty3tsxEKHekPVTd7r_3BHpXc\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"rewrapped-keys\"\u003c/span\u003e: \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"pl-s\"\u003e\"example.foo.bar\"\u003c/span\u003e: \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"aux-type\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"\u0026lt;hpke ciphertext goes here\u0026gt;\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIn the above example, dummy values were used for Merkle roots.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eGET api/extensions\u003c/h4\u003e\u003ca id=\"user-content-get-apiextensions\" class=\"anchor\" aria-label=\"Permalink: GET api/extensions\" href=\"#get-apiextensions\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003ePurpose: Lists the \u003ca href=\"#auxiliary-data-extensions\"\u003eAuxiliary Data Extensions\u003c/a\u003e supported by this server.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAn HTTP 200 OK request will contain the following response fields:\u003c/p\u003e\n\u003cmarkdown-accessiblity-table\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eResponse Field\u003c/th\u003e\n\u003cth\u003eType\u003c/th\u003e\n\u003cth\u003eRemarks\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003e!pkd-context\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eDomain separation\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ecurrent-time\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003e\u003ca href=\"#timestamps\"\u003eTimestamp\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eextensions\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eobject[]\u003c/td\u003e\n\u003ctd\u003eArray of objects (see next table)\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/markdown-accessiblity-table\u003e\n\u003cp dir=\"auto\"\u003eThe \u003ccode\u003e!pkd-context\u003c/code\u003e field will be set to the ASCII string \u003ccode\u003efedi-e2ee:v1/api/extensions\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eEach entry in the \u003ccode\u003eextensions\u003c/code\u003e array will contain \u003cem\u003eat least\u003c/em\u003e each of the following fields:\u003c/p\u003e\n\u003cmarkdown-accessiblity-table\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eResponse Field\u003c/th\u003e\n\u003cth\u003eType\u003c/th\u003e\n\u003cth\u003eRemarks\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eid\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eUnique.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eversion\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eVersion identifier. Extension-specific.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eref\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eURL to extension specification.\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/markdown-accessiblity-table\u003e\n\u003cp dir=\"auto\"\u003eExtensions \u003cstrong\u003eMAY\u003c/strong\u003e include optional additional fields, if necessary, in the above table.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eExample Response\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{\n  \u0026quot;!pkd-context\u0026quot;: \u0026quot;fedi-e2ee:v1/api/extensions\u0026quot;,\n  \u0026quot;time\u0026quot;: \u0026quot;1731080850\u0026quot;,\n  \u0026quot;extensions\u0026quot;: [\n    {\n      \u0026quot;id\u0026quot;: \u0026quot;foo-v1\u0026quot;,\n      \u0026quot;version\u0026quot;: \u0026quot;1.0.0\u0026quot;,\n      \u0026quot;ref\u0026quot;: \u0026quot;https://example.com/v1\u0026quot;\n    }\n  ]\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"!pkd-context\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"fedi-e2ee:v1/api/extensions\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"time\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"1731080850\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"extensions\"\u003c/span\u003e: \u003cspan class=\"pl-kos\"\u003e[\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"id\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"foo-v1\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"version\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"1.0.0\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"ref\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"https://example.com/v1\"\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"pl-kos\"\u003e]\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eGET api/replicas\u003c/h4\u003e\u003ca id=\"user-content-get-apireplicas\" class=\"anchor\" aria-label=\"Permalink: GET api/replicas\" href=\"#get-apireplicas\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003ePurpose: List the other Public Key Directory instances that are replicated onto this one.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAn HTTP 200 OK request will contain the following response fields:\u003c/p\u003e\n\u003cmarkdown-accessiblity-table\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eResponse Field\u003c/th\u003e\n\u003cth\u003eType\u003c/th\u003e\n\u003cth\u003eRemarks\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003e!pkd-context\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eDomain separation\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ecurrent-time\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003e\u003ca href=\"#timestamps\"\u003eTimestamp\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ereplicas\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eobject[]\u003c/td\u003e\n\u003ctd\u003eArray of objects (see next table)\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/markdown-accessiblity-table\u003e\n\u003cp dir=\"auto\"\u003eThe \u003ccode\u003e!pkd-context\u003c/code\u003e field will be set to the ASCII string \u003ccode\u003efedi-e2ee:v1/api/replicas\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eEach entry in the \u003ccode\u003ereplicas\u003c/code\u003e array will contain \u003cem\u003eat least\u003c/em\u003e each of the following fields:\u003c/p\u003e\n\u003cmarkdown-accessiblity-table\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eResponse Field\u003c/th\u003e\n\u003cth\u003eType\u003c/th\u003e\n\u003cth\u003eRemarks\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eid\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eUnique.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eref\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eCanonical URL for the other Public Key Directory being replicated.\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/markdown-accessiblity-table\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eExample Response\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{\n  \u0026quot;!pkd-context\u0026quot;: \u0026quot;fedi-e2ee:v1/api/replicas\u0026quot;,\n  \u0026quot;time\u0026quot;: \u0026quot;1731080855\u0026quot;,\n  \u0026quot;extensions\u0026quot;: [\n    {\n      \u0026quot;id\u0026quot;: \u0026quot;7k18At1PNkUmWokYbkpS5t29ZPWQASvg2dWXaFiOnac\u0026quot;,\n      \u0026quot;ref\u0026quot;: \u0026quot;https://example.org\u0026quot;\n    },\n    {\n      \u0026quot;id\u0026quot;: \u0026quot;1jrlXOicceUMsxs1c5F1EbVPvy1CRWgH42k_UrMceQg\u0026quot;,\n      \u0026quot;ref\u0026quot;: \u0026quot;https://example.org\u0026quot;\n    }\n  ]\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"!pkd-context\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"fedi-e2ee:v1/api/replicas\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"time\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"1731080855\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"extensions\"\u003c/span\u003e: \u003cspan class=\"pl-kos\"\u003e[\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"id\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"7k18At1PNkUmWokYbkpS5t29ZPWQASvg2dWXaFiOnac\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"ref\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"https://example.org\"\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"id\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"1jrlXOicceUMsxs1c5F1EbVPvy1CRWgH42k_UrMceQg\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"pl-s\"\u003e\"ref\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"https://example.org\"\u003c/span\u003e\n    \u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"pl-kos\"\u003e]\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eGET api/replica/:replica_id/{...}\u003c/h4\u003e\u003ca id=\"user-content-get-apireplicareplica_id\" class=\"anchor\" aria-label=\"Permalink: GET api/replica/:replica_id/{...}\" href=\"#get-apireplicareplica_id\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eEvery replica URL will contain a direct replica of the original Public Key Directory's HTTP responses.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eFor example, \u003ccode\u003eapi/replica/7k18At1PNkUmWokYbkpS5t29ZPWQASvg2dWXaFiOnac/actor/:actor_id\u003c/code\u003e will contain the same contents\nas requesting \u003ccode\u003eapi/actor/:actor_id\u003c/code\u003e from the original Public Key Directory.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThus, \u003ccode\u003eapi/replica/:replica_id/\u003c/code\u003e will contain:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ca href=\"#get-apiactoractorid\"\u003eactor/:actor_id\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#get-apiactoractoridkeys\"\u003eactor/:actor_id/keys\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#get-apiactoractoridkeys\"\u003eactor/:actor_id/key/:key_id\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#get-apiactoractoridauxiliary\"\u003eactor/:actor_id/auxiliary\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#get-apiactoractoridauxiliaryauxdataid\"\u003eactor/:actor_id/auxiliary/:aux_data_id\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#get-apihistory\"\u003ehistory\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#get-apihistorysincelasthash\"\u003ehistory/since/:last_hash\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eThe \u003ccode\u003eextensions\u003c/code\u003e, \u003ccode\u003ereplica\u003c/code\u003e, and \u003ccode\u003erevoke\u003c/code\u003e endpoints are not mirrored in a replica.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eGET api/server-public-key\u003c/h4\u003e\u003ca id=\"user-content-get-apiserver-public-key\" class=\"anchor\" aria-label=\"Permalink: GET api/server-public-key\" href=\"#get-apiserver-public-key\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003ePurpose: Retrieve the public key to encrypt Protocol Messages (for use in HPKE)\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAn HTTP 200 OK request will contain the following response fields:\u003c/p\u003e\n\u003cmarkdown-accessiblity-table\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eResponse Field\u003c/th\u003e\n\u003cth\u003eType\u003c/th\u003e\n\u003cth\u003eRemarks\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003e!pkd-context\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eDomain separation\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ecurrent-time\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003e\u003ca href=\"#timestamps\"\u003eTimestamp\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ehpke-ciphersuite\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eSee below\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ehpke-public-key\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eBase64url-encoded HPKE public key\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/markdown-accessiblity-table\u003e\n\u003cp dir=\"auto\"\u003eThe \u003ccode\u003e!pkd-context\u003c/code\u003e field will be set to the ASCII string \u003ccode\u003efedi-e2ee:v1/api/server-public-key\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe \u003ccode\u003ehpke-ciphersuite\u003c/code\u003e string will refer to an \u003ca href=\"#hpke-cipher-suites\"\u003eHPKE cipher suite\u003c/a\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eExample Response\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{\n  \u0026quot;!pkd-context\u0026quot;: \u0026quot;fedi-e2ee:v1/api/server-public-key\u0026quot;,\n  \u0026quot;current-time\u0026quot;: \u0026quot;1730909831\u0026quot;,\n  \u0026quot;hpke-ciphersuite\u0026quot;: \u0026quot;Curve25519_SHA256_ChachaPoly\u0026quot;,\n  \u0026quot;hpke-public-key\u0026quot;: \u0026quot;3NtzCdMS1nuAVGHQStL-2evsgYz_LCuEzLeXXlrX7tM\u0026quot;\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"!pkd-context\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"fedi-e2ee:v1/api/server-public-key\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"current-time\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"1730909831\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"hpke-ciphersuite\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"Curve25519_SHA256_ChachaPoly\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"hpke-public-key\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"3NtzCdMS1nuAVGHQStL-2evsgYz_LCuEzLeXXlrX7tM\"\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003ePOST api/revoke\u003c/h4\u003e\u003ca id=\"user-content-post-apirevoke\" class=\"anchor\" aria-label=\"Permalink: POST api/revoke\" href=\"#post-apirevoke\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003ePurpose: Accepts \u003ca href=\"#revokekeythirdparty\"\u003e\u003ccode\u003eRevokeKeyThirdParty\u003c/code\u003e\u003c/a\u003e messages.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe following HTTP request parameters \u003cstrong\u003eMUST\u003c/strong\u003e be included:\u003c/p\u003e\n\u003cmarkdown-accessiblity-table\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eRequest Parameter\u003c/th\u003e\n\u003cth\u003eType\u003c/th\u003e\n\u003cth\u003eRemarks\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003e!pkd-context\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eDomain separation\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ecurrent-time\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003e\u003ca href=\"#timestamps\"\u003eTimestamp\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003erevocation-token\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eRevocation token\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/markdown-accessiblity-table\u003e\n\u003cp dir=\"auto\"\u003eIf the revocation token is valid, it will be processed and an HTTP 200 OK response will be returned.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIf the revocation token is invalid, an HTTP 2204 No Content response will be returned.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eEither way, the response body will only contain a \u003ccode\u003e!pkd-context\u003c/code\u003e header and a timestamp.\nThe \u003ccode\u003e!pkd-context\u003c/code\u003e field will be set to the ASCII string \u003ccode\u003efedi-e2ee:v1/api/revoke\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eExample Response\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{\n  \u0026quot;!pkd-context\u0026quot;: \u0026quot;fedi-e2ee:v1/api/revoke\u0026quot;,\n  \u0026quot;time\u0026quot;: \u0026quot;1730909831\u0026quot;\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"!pkd-context\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"fedi-e2ee:v1/api/revoke\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"time\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"1730909831\"\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003ePOST api/totp/disenroll\u003c/h4\u003e\u003ca id=\"user-content-post-apitotpdisenroll\" class=\"anchor\" aria-label=\"Permalink: POST api/totp/disenroll\" href=\"#post-apitotpdisenroll\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003ePurpose: Remove the current TOTP secret stored in the Public Key Directory for the current instance.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe following HTTP request parameters \u003cstrong\u003eMUST\u003c/strong\u003e be included:\u003c/p\u003e\n\u003cmarkdown-accessiblity-table\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eRequest Parameter\u003c/th\u003e\n\u003cth\u003eType\u003c/th\u003e\n\u003cth\u003eRemarks\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003e!pkd-context\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eDomain separation\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ecurrent-time\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003e\u003ca href=\"#timestamps\"\u003eTimestamp\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003edisenrollment\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eobject\u003c/td\u003e\n\u003ctd\u003eSee next table\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003esignature\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eSignature of \u003ccode\u003edisenrollment\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/markdown-accessiblity-table\u003e\n\u003cp dir=\"auto\"\u003eThe \u003ccode\u003e!pkd-context\u003c/code\u003e field will be set to the ASCII string \u003ccode\u003efedi-e2ee:v1/api/totp/disenroll\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe disenrollment object will consist of the following fields:\u003c/p\u003e\n\u003cmarkdown-accessiblity-table\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eRequest Parameter\u003c/th\u003e\n\u003cth\u003eType\u003c/th\u003e\n\u003cth\u003eRemarks\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eactor-id\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eThe Actor ID that produced the signature.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ekey-id\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eThe specific public key to use for this actor.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eotp\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eOne-Time Password (see \u003ca href=\"#totp\"\u003eTOTP\u003c/a\u003e)\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/markdown-accessiblity-table\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eExample Response\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{\n  \u0026quot;!pkd-context\u0026quot;: \u0026quot;fedi-e2ee:v1/api/totp/disenroll\u0026quot;,\n  \u0026quot;success\u0026quot;: true,\n  \u0026quot;time\u0026quot;: \u0026quot;1730909831\u0026quot;\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"!pkd-context\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"fedi-e2ee:v1/api/totp/disenroll\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"success\"\u003c/span\u003e: \u003cspan class=\"pl-c1\"\u003etrue\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"time\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"1730909831\"\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIf there is no TOTP secret key enrolled for a specific instance, the OTP is ignored and a \"success\" response is\nreturned.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIf the TOTP secret is enrolled, but the OTP is incorrect, return an HTTP 403 error. This should count as a penalty for\nrate-limiting.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003ePOST api/totp/enroll\u003c/h4\u003e\u003ca id=\"user-content-post-apitotpenroll\" class=\"anchor\" aria-label=\"Permalink: POST api/totp/enroll\" href=\"#post-apitotpenroll\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003ePurpose: Enroll an TOTP secret for the current Fediverse instance.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe following HTTP request parameters \u003cstrong\u003eMUST\u003c/strong\u003e be included:\u003c/p\u003e\n\u003cmarkdown-accessiblity-table\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eRequest Parameter\u003c/th\u003e\n\u003cth\u003eType\u003c/th\u003e\n\u003cth\u003eRemarks\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003e!pkd-context\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eDomain separation\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ecurrent-time\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003e\u003ca href=\"#timestamps\"\u003eTimestamp\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eenrollment\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eobject\u003c/td\u003e\n\u003ctd\u003eSee next table\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003esignature\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eSignature of \u003ccode\u003eenrollment\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/markdown-accessiblity-table\u003e\n\u003cp dir=\"auto\"\u003eThe \u003ccode\u003e!pkd-context\u003c/code\u003e field will be set to the ASCII string \u003ccode\u003efedi-e2ee:v1/api/totp/enroll\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe enrollment object will consist of the following fields:\u003c/p\u003e\n\u003cmarkdown-accessiblity-table\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eRequest Parameter\u003c/th\u003e\n\u003cth\u003eType\u003c/th\u003e\n\u003cth\u003eRemarks\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eactor-id\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eThe Actor ID that produced the signature.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ekey-id\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eThe specific public key to use for this actor.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eotp-current\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eOne-Time Password (see \u003ca href=\"#totp\"\u003eTOTP\u003c/a\u003e), current time window.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eotp-previous\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eOne-Time Password (see \u003ca href=\"#totp\"\u003eTOTP\u003c/a\u003e), previous time window.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003etotp-secret\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eHPKE-encrypted\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/markdown-accessiblity-table\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eExample Response\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{\n  \u0026quot;!pkd-context\u0026quot;: \u0026quot;fedi-e2ee:v1/api/totp/enroll\u0026quot;,\n  \u0026quot;success\u0026quot;: true,\n  \u0026quot;time\u0026quot;: \u0026quot;1730909831\u0026quot;\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"!pkd-context\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"fedi-e2ee:v1/api/totp/enroll\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"success\"\u003c/span\u003e: \u003cspan class=\"pl-c1\"\u003etrue\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"time\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"1730909831\"\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIf the TOTP secret is already enrolled, return an HTTP 409 error.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIf the \u003ccode\u003eotp-current\u003c/code\u003e or \u003ccode\u003eotp-previous\u003c/code\u003e is invalid for the HPKE-encrypted secret (or if a decryption error occurs), then\nthe Public Key Directory will return an HTTP 406 error.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003ePOST api/totp/rotate\u003c/h4\u003e\u003ca id=\"user-content-post-apitotprotate\" class=\"anchor\" aria-label=\"Permalink: POST api/totp/rotate\" href=\"#post-apitotprotate\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003ePurpose: Rotate the TOTP secret.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe following HTTP request parameters \u003cstrong\u003eMUST\u003c/strong\u003e be included:\u003c/p\u003e\n\u003cmarkdown-accessiblity-table\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eRequest Parameter\u003c/th\u003e\n\u003cth\u003eType\u003c/th\u003e\n\u003cth\u003eRemarks\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003e!pkd-context\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eDomain separation\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ecurrent-time\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003e\u003ca href=\"#timestamps\"\u003eTimestamp\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003erotation\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eobject\u003c/td\u003e\n\u003ctd\u003eSee next table\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003esignature\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eSignature of \u003ccode\u003erotation\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/markdown-accessiblity-table\u003e\n\u003cp dir=\"auto\"\u003eThe \u003ccode\u003e!pkd-context\u003c/code\u003e field will be set to the ASCII string \u003ccode\u003efedi-e2ee:v1/api/totp/rotate\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe enrollment object will consist of the following fields:\u003c/p\u003e\n\u003cmarkdown-accessiblity-table\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eRequest Parameter\u003c/th\u003e\n\u003cth\u003eType\u003c/th\u003e\n\u003cth\u003eRemarks\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eactor-id\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eThe Actor ID that produced the signature.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ekey-id\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eThe specific public key to use for this actor.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003enew-otp-current\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eOne-Time Password (see \u003ca href=\"#totp\"\u003eTOTP\u003c/a\u003e), current time window.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003enew-otp-previous\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eOne-Time Password (see \u003ca href=\"#totp\"\u003eTOTP\u003c/a\u003e), previous time window.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003enew-totp-secret\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eHPKE-encrypted\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eold-otp\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003estring\u003c/td\u003e\n\u003ctd\u003eOne-Time Password (see \u003ca href=\"#totp\"\u003eTOTP\u003c/a\u003e)\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/markdown-accessiblity-table\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eExample Response\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{\n  \u0026quot;!pkd-context\u0026quot;: \u0026quot;fedi-e2ee:v1/api/totp/rotate\u0026quot;,\n  \u0026quot;success\u0026quot;: true,\n  \u0026quot;time\u0026quot;: \u0026quot;1730909831\u0026quot;\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"!pkd-context\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"fedi-e2ee:v1/api/totp/rotate\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"success\"\u003c/span\u003e: \u003cspan class=\"pl-c1\"\u003etrue\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"time\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"1730909831\"\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIf there is no TOTP secret key enrolled for a specific instance, return an HTTP 400 error.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIf the TOTP secret is enrolled, but \u003ccode\u003eold-otp\u003c/code\u003e is incorrect, return an HTTP 403 error. This should count as a penalty for\nrate-limiting.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIf the \u003ccode\u003enew-otp-current\u003c/code\u003e or \u003ccode\u003enew-otp-previous\u003c/code\u003e is invalid for the HPKE-encrypted secret (or if a decryption error\noccurs), then the Public Key Directory will return an HTTP 406 error.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eGossip Protocol\u003c/h3\u003e\u003ca id=\"user-content-gossip-protocol\" class=\"anchor\" aria-label=\"Permalink: Gossip Protocol\" href=\"#gossip-protocol\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eGossip Protocol Background\u003c/h4\u003e\u003ca id=\"user-content-gossip-protocol-background\" class=\"anchor\" aria-label=\"Permalink: Gossip Protocol Background\" href=\"#gossip-protocol-background\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eGossip Protocols ensure consistency in distributed systems with limited interactions. We define two mechanisms for the\nPublic Key Directory: One active, one passive.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eActive Gossip (Checkpoints)\u003c/h4\u003e\u003ca id=\"user-content-active-gossip-checkpoints\" class=\"anchor\" aria-label=\"Permalink: Active Gossip (Checkpoints)\" href=\"#active-gossip-checkpoints\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThe \u003ca href=\"#checkpoint\"\u003eCheckpoint\u003c/a\u003e Protocol Message type defined above (which allows one PKD to commit its current history\nonto another PKD's log) is one type of Gossip. With Checkpoints, the sender informs the recipient of their current\nMerkle root, and it is logged in the secondary ledger.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIf both Public Key Directory instances are independently operated, this allows third parties to verify the authenticity\nof the PKD that sent the Checkpoint.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThis inter-PKD mechanism is a \u003cstrong\u003epush\u003c/strong\u003e from the Sender to the Recipient. It requires an explicit action on the Sender to\nperform. This also requires the Recipient grant the Sender permission to publish a Checkpoint message.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eFor completeness, we specify a permissionless, \u003cstrong\u003epull\u003c/strong\u003e-based Gossip mechanism for replicating history from one PKD to\nanother. Care is taken to maximize the availability of data without preventing\n\u003ca href=\"#message-attribute-shreddability\"\u003e\u003cem\u003eRight To Be Forgotten\u003c/em\u003e takedowns\u003c/a\u003e.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003ePassive Gossip (Mirroring)\u003c/h4\u003e\u003ca id=\"user-content-passive-gossip-mirroring\" class=\"anchor\" aria-label=\"Permalink: Passive Gossip (Mirroring)\" href=\"#passive-gossip-mirroring\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThird-party software and other Public Key Directory instances can be configured to stream new Protocol Messages from the\ntarget PKD instance to store locally.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe encrypted attributes will always be copied onto mirrors.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eMirrors \u003cstrong\u003eMAY\u003c/strong\u003e cache the corresponding plaintext fields from the source directory, provided\nthey adhere to the \u003ca href=\"#mirror-plaintext-cache-invalidation\"\u003ecache invalidation\u003c/a\u003e specification.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eReplica instances \u003cstrong\u003eSHOULD\u003c/strong\u003e provide \u003ca href=\"#witness-co-signing\"\u003ewitness co-signatures\u003c/a\u003e to the Sigsum transparency log that\nthe source PKD is built atop.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch5 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eRecursive Replication\u003c/h5\u003e\u003ca id=\"user-content-recursive-replication\" class=\"anchor\" aria-label=\"Permalink: Recursive Replication\" href=\"#recursive-replication\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIn addition to direct mirrors, Public Key Directory instances may choose to recursively replicate all of the replicas\nhosted by another server.\u003c/p\u003e\n\u003csection class=\"js-render-needs-enrichment render-needs-enrichment position-relative\" data-identity=\"4a2aea37-609a-4e26-a08f-acc4bda9992c\" data-host=\"https://viewscreen.githubusercontent.com\" data-src=\"https://viewscreen.githubusercontent.com/markdown/mermaid?docs_host=https%3A%2F%2Fdocs.github.com\" data-type=\"mermaid\" aria-label=\"mermaid rendered output container\"\u003e\n  \u003cdiv class=\"js-render-enrichment-target\" data-json=\"{\u0026quot;data\u0026quot;:\u0026quot;flowchart TD\\n    A(example.com) --\u0026amp;gt;|replicated|B{foo.net}\\n    B --\u0026amp;gt; |replicated|C{bar.org}\\n\u0026quot;}\" data-plain=\"flowchart TD\n    A(example.com) --\u0026gt;|replicated|B{foo.net}\n    B --\u0026gt; |replicated|C{bar.org}\n\" dir=\"auto\"\u003e\n    \u003cdiv class=\"render-plaintext-hidden\" dir=\"auto\"\u003e\n      \u003cpre lang=\"mermaid\" aria-label=\"Raw mermaid code\"\u003eflowchart TD\n    A(example.com) --\u0026gt;|replicated|B{foo.net}\n    B --\u0026gt; |replicated|C{bar.org}\n\u003c/pre\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n  \u003cspan class=\"js-render-enrichment-loader d-flex flex-justify-center flex-items-center width-full\" style=\"min-height:100px\" role=\"presentation\"\u003e\n    \u003cspan data-view-component=\"true\"\u003e\n  \u003csvg style=\"box-sizing: content-box; color: var(--color-icon-primary);\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" aria-hidden=\"true\" data-view-component=\"true\" class=\"octospinner mx-auto anim-rotate\"\u003e\n    \u003ccircle cx=\"8\" cy=\"8\" r=\"7\" stroke=\"currentColor\" stroke-opacity=\"0.25\" stroke-width=\"2\" vector-effect=\"non-scaling-stroke\" fill=\"none\"\u003e\u003c/circle\u003e\n    \u003cpath d=\"M15 8a7.002 7.002 0 00-7-7\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" vector-effect=\"non-scaling-stroke\"\u003e\u003c/path\u003e\n\u003c/svg\u003e    \u003cspan class=\"sr-only\"\u003eLoading\u003c/span\u003e\n\u003c/span\u003e\n  \u003c/span\u003e\n\u003c/section\u003e\n\n\u003cp dir=\"auto\"\u003eIn the above flowchart, \u003ccode\u003ebar.org\u003c/code\u003e is replicating the history stored in \u003ccode\u003efoo.net\u003c/code\u003e. If they opt or a recursive\nreplication, they will also replicate \u003ccode\u003eexample.com\u003c/code\u003e by copying from the copies of records hosted by \u003ccode\u003efoo.net\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch5 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eTrusted Mirrors\u003c/h5\u003e\u003ca id=\"user-content-trusted-mirrors\" class=\"anchor\" aria-label=\"Permalink: Trusted Mirrors\" href=\"#trusted-mirrors\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIf the source Public Key Directory trusts the mirror's operators, the source \u003cstrong\u003eMAY\u003c/strong\u003e republish the symmetric key used\nto encrypt that Protocol Message's attributes, encrypted using HPKE with the mirror's latest public key (i.e., from\ntheir most recent Checkpoint).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThese HPKE-encrypted blobs will be cached and appended to the \u003ccode\u003erewrapped-keys\u003c/code\u003e field for any record that has not been\nwiped.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eKey rewrapping is not recommended by default, as it would allow the replica to decrypt the record even if the source PKD\nreceived a legal take-down notice. Instead, it should only be used for mirrors you trust to respect when the source\nhas been wiped by a legal request, and purge their copy of the symmetric key in turn.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eTrusted Mirrors may serve as a form of fail-over in case the source instance is inaccessible, as a mechanism to reduce\nthe efficacy of Denial of Service attacks.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eMirror Plaintext Cache Invalidation\u003c/h4\u003e\u003ca id=\"user-content-mirror-plaintext-cache-invalidation\" class=\"anchor\" aria-label=\"Permalink: Mirror Plaintext Cache Invalidation\" href=\"#mirror-plaintext-cache-invalidation\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThe replicated ciphertext \u003cstrong\u003eMAY\u003c/strong\u003e be persisted indefinitely, but regardless of the trust status of a given Mirror, if\nthe mirror has access to the plaintext (whether by caching a copy or by \u003ccode\u003erewrapped-keys\u003c/code\u003e), the Mirror \u003cstrong\u003eMUST\u003c/strong\u003e\noccasionally attempt to verify that the source server has not deliberately wiped their copy of the symmetric key.\nIf the source has, the mirror \u003cstrong\u003eMUST\u003c/strong\u003e do the same.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eWhen processing a request for a replicated record, checking the status of the upstream record is \u003cstrong\u003eRECOMMENDED\u003c/strong\u003e if it\nhas not been checked in the past 24 hours.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIf the source is unavailable, the mirror may defer retries for up to 7 days. After this grace period, they should treat\nthe relevant rewrapped keys and cached plaintexts as invalid and remove them. If the source comes back online, the\nmirror \u003cstrong\u003eMAY\u003c/strong\u003e re-cache the symmetric keys and/or plaintext.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eSigsum Integration\u003c/h3\u003e\u003ca id=\"user-content-sigsum-integration\" class=\"anchor\" aria-label=\"Permalink: Sigsum Integration\" href=\"#sigsum-integration\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"https://www.sigsum.org\" rel=\"nofollow\"\u003eSigsum\u003c/a\u003e is the transparency system that underpins the Public Key Directory design. Requests to\nSigSum contain the following:\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eA message to be stored.\u003c/li\u003e\n\u003cli\u003eA public key that signs the data.\u003c/li\u003e\n\u003cli\u003eA signature over the message (1), using the public key (2).\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp dir=\"auto\"\u003eAfter verifying the signature (3), Sigsum stores the SHA256 hash of (1), the SHA256 hash of (2), and the signature (3)\nas-is.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe Public Key Directory Server will maintain its own Ed25519 keypair, which is used to sign new messages into Sigsum.\nEach bundle submitted to Sigsum as a Sigsum message will consist of the following subset of the Protocol Message:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"{\n  /* The version number used in !pkd-context may change in the future: */\n  \u0026quot;!pkd-context\u0026quot;: \u0026quot;https://github.com/fedi-e2ee/public-key-directory/v1\u0026quot;,\n  /* The action, such as AddKey or RevokeKey, goes here: */\n  \u0026quot;action\u0026quot;: \u0026quot;\u0026quot;,\n  /* A recent Merkle root (if applicable) for a previous message: */\n  \u0026quot;recent-merkle-root\u0026quot;: \u0026quot;\u0026quot;,\n  \u0026quot;message\u0026quot;: {\n    /* \n    The actual message contents required for the specific action goes here.\n    Its contents may vary from action to action.\n    */\n  }, \n  /* A signature calculated over \u0026quot;!pkd-context\u0026quot;, \u0026quot;action\u0026quot;, \u0026quot;recent-merkle-root\u0026quot;, and \u0026quot;message\u0026quot;: */\n  \u0026quot;signature\u0026quot;: \u0026quot;\u0026quot;\n}\"\u003e\u003cpre\u003e\u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"pl-c\"\u003e/* The version number used in !pkd-context may change in the future: */\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"!pkd-context\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"https://github.com/fedi-e2ee/public-key-directory/v1\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-c\"\u003e/* The action, such as AddKey or RevokeKey, goes here: */\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"action\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-c\"\u003e/* A recent Merkle root (if applicable) for a previous message: */\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"recent-merkle-root\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"message\"\u003c/span\u003e: \u003cspan class=\"pl-kos\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"pl-c\"\u003e/* \u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e    The actual message contents required for the specific action goes here.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e    Its contents may vary from action to action.\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e    */\u003c/span\u003e\n  \u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003cspan class=\"pl-kos\"\u003e,\u003c/span\u003e \n  \u003cspan class=\"pl-c\"\u003e/* A signature calculated over \"!pkd-context\", \"action\", \"recent-merkle-root\", and \"message\": */\u003c/span\u003e\n  \u003cspan class=\"pl-s\"\u003e\"signature\"\u003c/span\u003e: \u003cspan class=\"pl-s\"\u003e\"\"\u003c/span\u003e\n\u003cspan class=\"pl-kos\"\u003e}\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eNote that \u003ccode\u003ekey-id\u003c/code\u003e and \u003ccode\u003esymmetric-keys\u003c/code\u003e are deliberately excluded from being committed to Sigsum.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe \u003ccode\u003e!pkd-context\u003c/code\u003e header (which is signed by the end user) is included for domain separation against other uses of the\nuser's secret key.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eWitness Co-Signing\u003c/h4\u003e\u003ca id=\"user-content-witness-co-signing\" class=\"anchor\" aria-label=\"Permalink: Witness Co-Signing\" href=\"#witness-co-signing\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eSigsum doesn't use a gossip protocol. Instead, it relies on proactive witness co-signatures into other ledgers. See\n\u003ca href=\"https://git.glasklar.is/nisse/cats-2023/-/blob/main/sigsum-design-cats-2023.pdf\" rel=\"nofollow\"\u003esection 3.5 of the Sigsum paper for more details\u003c/a\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIt's not sufficient for Public Key Directory entries to merely validate that a record exists in a Merkle tree. At least\none witness \u003cstrong\u003eMUST\u003c/strong\u003e also validate that the current state is deterministically reproducible from the history of the\ntransparency log.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eTo provide a mechanism for this requirement, PKDs are encouraged to send \u003ca href=\"#checkpoint\"\u003e\u003ccode\u003eCheckpoint\u003c/code\u003e\u003c/a\u003e Protocol Messages\nto their peers in addition to regular Sigsum witness co-signatures.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eAuxiliary Data Extensions\u003c/h3\u003e\u003ca id=\"user-content-auxiliary-data-extensions\" class=\"anchor\" aria-label=\"Permalink: Auxiliary Data Extensions\" href=\"#auxiliary-data-extensions\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAuxiliary Data Extensions should be registered in \u003ca href=\"https://github.com/fedi-e2ee/fedi-pkd-extensions\"\u003ethis GitHub repository\u003c/a\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eEach extension should provide a list of input validation steps, which will vary based on the use-case.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe input validation steps specified by the extension will be performed by the Public Key Directory when parsing an\n\u003ccode\u003eAddAuxData\u003c/code\u003e message.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eCryptography Protocols\u003c/h2\u003e\u003ca id=\"user-content-cryptography-protocols\" class=\"anchor\" aria-label=\"Permalink: Cryptography Protocols\" href=\"#cryptography-protocols\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThis section details any nontrivial cryptographic protocols used in the Public Key Directory server.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eNontrivial is a subjective categorization. For example, signing a message with Ed25519 is considered trivial because a\nseparate specification exists for Ed25519. That is not a criticism of the algorithm.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe authors of this specification strongly recommend asking an applied cryptography expert develop these cryptographic\ncomponents.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe cryptography version used for the current specification is \u003ca href=\"#version-1\"\u003eVersion 1\u003c/a\u003e.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eProtocol Message Encryption\u003c/h3\u003e\u003ca id=\"user-content-protocol-message-encryption-1\" class=\"anchor\" aria-label=\"Permalink: Protocol Message Encryption\" href=\"#protocol-message-encryption-1\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThe entirety of a Protocol Message \u003cstrong\u003eMAY\u003c/strong\u003e be encrypted, client-side, using \u003ca href=\"https://datatracker.ietf.org/doc/rfc9180/\" rel=\"nofollow\"\u003eHPKE (RFC 9180)\u003c/a\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe encryption process is described in \u003ca href=\"#protocol-message-encryption\"\u003eEncryption of Protocol Messages\u003c/a\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe decryption process is described in \u003ca href=\"#protocol-message-decryption\"\u003eDecryption of Protocol Messages\u003c/a\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe Public Key Directory chooses the cipher suite used for HPKE. Any currently acceptable HPKE algorithm \u003cstrong\u003eMAY\u003c/strong\u003e be used\nif the client and server both support it.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eFor the current version of the protocol, clients and servers \u003cstrong\u003eMUST\u003c/strong\u003e support the\n\u003ca href=\"https://www.rfc-editor.org/rfc/rfc9180.html#name-dhkemx25519-hkdf-sha256-hkdf\" rel=\"nofollow\"\u003eDHKEM(X25519, HKDF-SHA256) with HKDF-SHA256 and ChaCha20Poly1305\u003c/a\u003e\ncipher suite.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eSee \u003ca href=\"#hpke-cipher-suites\"\u003eHPKE cipher suites\u003c/a\u003e for more information.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eEncrypting Message Attributes to Enable Crypto Shredding\u003c/h3\u003e\u003ca id=\"user-content-encrypting-message-attributes-to-enable-crypto-shredding\" class=\"anchor\" aria-label=\"Permalink: Encrypting Message Attributes to Enable Crypto Shredding\" href=\"#encrypting-message-attributes-to-enable-crypto-shredding\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThe goal of attribute encryption is compliance, not security, but we still consider it important to use a committing\nauthenticated encryption mode to ensure a backdoor is not possible through an Invisible Salamanders style attack.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eWe use HKDF to derive two distinct keys for our protocol. One for AES, the other for HMAC-SHA2. We encrypt then MAC\nto avoid the \u003ca href=\"https://moxie.org/2011/12/13/the-cryptographic-doom-principle.html\" rel=\"nofollow\"\u003eCryptographic Doom Principle\u003c/a\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eWe opt to not use AES-GCM to ensure the ciphertext and authentication tag are key-committing, where GCM does not provide\nthis security property.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eWe use a total of 256 bits of randomness. After 2^{85.3} attributes have been encrypted, we expect a key+nonce collision\nprobability of approximately 2^-85.3. The AES-CTR nonce is derived alongside the encryption key from a 256-bit IKM and\n256-bit random value.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eCiphertexts and keys are expected to be \u003ca href=\"https://datatracker.ietf.org/doc/html/rfc4648#section-5\" rel=\"nofollow\"\u003ebase64url\u003c/a\u003e-encoded.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eWe also include a commitment of the plaintext, which is also covered by the ciphertext's authentication tag. This uses\ndomain-separated HMAC to calculate a salt, which is then used to calculate an Argon2id KDF output of the plaintext.\nWe use Argon2id to make brute-force attacks impractical.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eRecent Merkle Root Included in Plaintext Commitments\u003c/h4\u003e\u003ca id=\"user-content-recent-merkle-root-included-in-plaintext-commitments\" class=\"anchor\" aria-label=\"Permalink: Recent Merkle Root Included in Plaintext Commitments\" href=\"#recent-merkle-root-included-in-plaintext-commitments\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eWe additionally include the Merkle root of a recent accepted Protocol Message when calculating this commitment. Which\nroot is selected \u003cstrong\u003eMUST\u003c/strong\u003e be stored alongside the ciphertext. By \"recent\", we strictly mean the following:\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eClients are \u003cstrong\u003eRECOMMENDED\u003c/strong\u003e to use the Merkle root of the most recent Protocol Message.\u003c/li\u003e\n\u003cli\u003eIf there are N accepted messages in the ledger, the selected Merkle root \u003cstrong\u003eSHOULD\u003c/strong\u003e be no more than log_2(N)^2\nmessages old (rounded up to the nearest whole number). Public Key Directories \u003cstrong\u003eMUST NOT\u003c/strong\u003e reject messages newer than\nthis threshold on basis of staleness.\u003c/li\u003e\n\u003cli\u003eTo tolerate large transaction volumes in a short window of time, the chosen Merkle root \u003cstrong\u003eMUST\u003c/strong\u003e be at least in the\nmost recent N/2 messages (for N currently accepted Protocol Messages). Public Key Directories \u003cstrong\u003eMAY\u003c/strong\u003e reject these\nmessages due to staleness, especially if the Directory isn't experiencing significant throughput, or if an Actor\nsubmits multiple Protocol Messages tied to a Merkle root too old to satisfy rule 2.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp dir=\"auto\"\u003eFor example: When attempting to insert the 1,000,001th record, this means there are currently 1,000,000 accepted\nProtocol Messages stored in the Public Key Database. The 1,000,000th record is preferred (by rule 1 above).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eHowever, any message after 999,602 would be considered acceptable. Arithmetically, log_2(1,000,000) squared is 397.26.\nWe round up to a tolerance window of 398. 1,000,000 minus 398 is 999,602. So any record's Merkle root corresponding to\na message index in that range is acceptable to use by rule 2.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eHowever, if there is an enormous spike in traffic, Public Key Directories \u003cstrong\u003eMAY\u003c/strong\u003e tolerate as far back as 500,000,\nprovided no two Protocol Messages from the same actor reuse the same \"recent\" Merkle root.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eFor the first message in a PKD, the \"recent\" Merkle root \u003cstrong\u003eMUST\u003c/strong\u003e be set to a sequence of 32 \u003ccode\u003e0x00\u003c/code\u003e bytes.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eAlgorithm Suite Versions\u003c/h3\u003e\u003ca id=\"user-content-algorithm-suite-versions\" class=\"anchor\" aria-label=\"Permalink: Algorithm Suite Versions\" href=\"#algorithm-suite-versions\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eEach of the function placeholders in the algorithm descriptions below can refer to these specific constants and\nfunctions.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe \u003ccode\u003eString\u003c/code\u003e type in the tables below are encoded as UTF-8, and should be interpreted as a literal sequence of the bytes\nrepresenting these characters.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eNote: \u003ccode\u003elen(x)\u003c/code\u003e is defined as the little-endian encoding of the number of octets in the byte string \u003ccode\u003ex\u003c/code\u003e, treated as an\nunsigned 64-bit integer. This is congruent to \u003ccode\u003eLE64()\u003c/code\u003e as used in\nPAE from PASETO.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eVersion 1\u003c/h4\u003e\u003ca id=\"user-content-version-1\" class=\"anchor\" aria-label=\"Permalink: Version 1\" href=\"#version-1\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch5 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eVersion 1 Constants\u003c/h5\u003e\u003ca id=\"user-content-version-1-constants\" class=\"anchor\" aria-label=\"Permalink: Version 1 Constants\" href=\"#version-1-constants\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThese constants are mostly used for domain separation.\u003c/p\u003e\n\u003cmarkdown-accessiblity-table\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eConstant name\u003c/th\u003e\n\u003cth\u003eType\u003c/th\u003e\n\u003cth\u003eValue\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eVERSION\u003c/td\u003e\n\u003ctd\u003eByte\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003e0x01\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eKDF_ENCRYPT_KEY\u003c/td\u003e\n\u003ctd\u003eString\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003e\"FediE2EE-v1-Compliance-Encryption-Key\"\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eKDF_AUTH_KEY\u003c/td\u003e\n\u003ctd\u003eString\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003e\"FediE2EE-v1-Compliance-Message-Auth-Key\"\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eKDF_COMMIT_SALT\u003c/td\u003e\n\u003ctd\u003eString\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003e\"FediE2EE-v1-Compliance-KDF-Salt\"\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eKEY_BITS\u003c/td\u003e\n\u003ctd\u003eInteger\u003c/td\u003e\n\u003ctd\u003e256\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eNONCE_BITS\u003c/td\u003e\n\u003ctd\u003eInteger\u003c/td\u003e\n\u003ctd\u003e128\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/markdown-accessiblity-table\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch5 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eVersion 1 Functions\u003c/h5\u003e\u003ca id=\"user-content-version-1-functions\" class=\"anchor\" aria-label=\"Permalink: Version 1 Functions\" href=\"#version-1-functions\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cmarkdown-accessiblity-table\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eFunction Name\u003c/th\u003e\n\u003cth\u003eCryptographic Algorithm\u003c/th\u003e\n\u003cth\u003eConfiguration and Miscellaneous Details\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eStream\u003c/td\u003e\n\u003ctd\u003eAES-256-CTR\u003c/td\u003e\n\u003ctd\u003eTo encrypt, XOR the output with the plaintext.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eHash\u003c/td\u003e\n\u003ctd\u003eSHA-512\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eMAC\u003c/td\u003e\n\u003ctd\u003eHMAC-SHA512\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eKDF\u003c/td\u003e\n\u003ctd\u003eHKDF-HMAC-SHA512\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ePwKDF\u003c/td\u003e\n\u003ctd\u003eArgon2id\u003c/td\u003e\n\u003ctd\u003emem = 16MiB, iter = 3, para = 1\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eSign\u003c/td\u003e\n\u003ctd\u003eEd25519.sign()\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eVerify\u003c/td\u003e\n\u003ctd\u003eEd25519.verify()\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/markdown-accessiblity-table\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eMessage Attribute Plaintext Commitment Algorithm\u003c/h4\u003e\u003ca id=\"user-content-message-attribute-plaintext-commitment-algorithm\" class=\"anchor\" aria-label=\"Permalink: Message Attribute Plaintext Commitment Algorithm\" href=\"#message-attribute-plaintext-commitment-algorithm\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eInputs\u003c/strong\u003e:\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eAttribute name (e.g. \u003ccode\u003eactor\u003c/code\u003e from \u003ccode\u003emessage\u003c/code\u003e), denoted \u003ccode\u003ea\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003ePlaintext (string, plaintext), denoted \u003ccode\u003ep\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eThe Merkle root of a recent accepted Protocol Message, \u003ccode\u003em\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eSalt, \u003ccode\u003es\u003c/code\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eOutput\u003c/strong\u003e:\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eA compact binary string that represents a commitment of the plaintext.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eAlgorithm\u003c/strong\u003e:\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eSet \u003ccode\u003el\u003c/code\u003e to \u003ccode\u003elen(m) || m || len(a) || a || len(p) || p\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eSet \u003ccode\u003eQ\u003c/code\u003e to the output of \u003ca href=\"#version-1-functions\"\u003e\u003ccode\u003ePwKDF\u003c/code\u003e\u003c/a\u003e with the following parameters:\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003epassword\u003c/code\u003e = \u003ccode\u003el\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003esalt\u003c/code\u003e = \u003ccode\u003es\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eoutput length\u003c/code\u003e = \u003ccode\u003e32\u003c/code\u003e (32 bytes, or 256 bits)\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eOutput the commitment \u003ccode\u003eQ\u003c/code\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eMessage Attribute Encryption Algorithm\u003c/h4\u003e\u003ca id=\"user-content-message-attribute-encryption-algorithm\" class=\"anchor\" aria-label=\"Permalink: Message Attribute Encryption Algorithm\" href=\"#message-attribute-encryption-algorithm\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eInputs\u003c/strong\u003e:\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eAttribute name (e.g. \u003ccode\u003eactor\u003c/code\u003e from \u003ccode\u003emessage\u003c/code\u003e), denoted \u003ccode\u003ea\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003ePlaintext (string, plaintext).\u003c/li\u003e\n\u003cli\u003eInput Key Material.\u003c/li\u003e\n\u003cli\u003eThe Merkle root of a recent accepted Protocol Message, \u003ccode\u003em\u003c/code\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eOutput\u003c/strong\u003e:\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eA compact binary string that represents an encrypted message attribute value (e.g. the Actor ID in \u003ccode\u003emessage.actor\u003c/code\u003e).\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eAlgorithm\u003c/strong\u003e:\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eSet the version prefix \u003ccode\u003eh\u003c/code\u003e to \u003ca href=\"#version-1-constants\"\u003e\u003ccode\u003eVERSION\u003c/code\u003e\u003c/a\u003e.\u003c/li\u003e\n\u003cli\u003eGenerate 32 bytes of random data, \u003ccode\u003er\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eDerive an encryption key, \u003ccode\u003eEk\u003c/code\u003e, and nonce, \u003ccode\u003en\u003c/code\u003e, through \u003ca href=\"#version-1-functions\"\u003e\u003ccode\u003eKDF\u003c/code\u003e\u003c/a\u003e with a NULL salt and an info\nstring set to \u003ccode\u003eKDF_ENCRYPT_KEY || h || r || len(a) || a\u003c/code\u003e, with an output length of 384 bits. The most significant\n256 bits will be the encryption key, \u003ccode\u003eEk\u003c/code\u003e, while the remaining 128 bits will be the nonce, \u003ccode\u003en\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eDerive an authentication key, \u003ccode\u003eAk\u003c/code\u003e, through \u003ca href=\"#version-1-functions\"\u003e\u003ccode\u003eKDF\u003c/code\u003e\u003c/a\u003e with a NULL salt and an info string set to\n\u003ccode\u003eKDF_AUTH_KEY || h || r || len(a) || a\u003c/code\u003e, with an output length of 256 bits.\u003c/li\u003e\n\u003cli\u003eDerive a commitment salt, \u003ccode\u003es\u003c/code\u003e, as the \u003ca href=\"#version-1-functions\"\u003e\u003ccode\u003eHash\u003c/code\u003e\u003c/a\u003e of\n\u003ccode\u003eKDF_COMMIT_SALT || h || r || len(m) || m || len(a) || a\u003c/code\u003e\ntruncated to 128 bits (big endian / the least significant bits).\u003c/li\u003e\n\u003cli\u003eCalculate \u003ca href=\"#message-attribute-plaintext-commitment-algorithm\"\u003ea commitment of the plaintext\u003c/a\u003e, designated \u003ccode\u003eQ\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eEncrypt the plaintext attribute using \u003ca href=\"#version-1-functions\"\u003e\u003ccode\u003eStream\u003c/code\u003e\u003c/a\u003e, with the nonce set to \u003ccode\u003en\u003c/code\u003e, to obtain the\nciphertext, \u003ccode\u003ec\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eCalculate the \u003ca href=\"#version-1-functions\"\u003e\u003ccode\u003eMAC\u003c/code\u003e\u003c/a\u003e of \u003ccode\u003eh || r || len(a) || a || len(c) || c || len(Q) || Q\u003c/code\u003e, with \u003ccode\u003eAk\u003c/code\u003e as\nthe key. Truncate the HMAC output to the rightmost 32 bytes (256 bits) to obtain \u003ccode\u003et\u003c/code\u003e. This is equivalent to reducing\nthe HMAC output modulo 2^{256}.\u003c/li\u003e\n\u003cli\u003eReturn \u003ccode\u003eh || r || Q || t || c\u003c/code\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eMessage Attribute Decryption Algorithm\u003c/h4\u003e\u003ca id=\"user-content-message-attribute-decryption-algorithm\" class=\"anchor\" aria-label=\"Permalink: Message Attribute Decryption Algorithm\" href=\"#message-attribute-decryption-algorithm\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eInputs\u003c/strong\u003e:\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eAttribute name (e.g. \u003ccode\u003eactor\u003c/code\u003e from \u003ccode\u003emessage\u003c/code\u003e), denoted \u003ccode\u003ea\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eCiphertext (string, ciphertext).\u003c/li\u003e\n\u003cli\u003eInput Key Material.\u003c/li\u003e\n\u003cli\u003eThe Merkle root from \u003ccode\u003erecent-merkle-root\u003c/code\u003e in the message , \u003ccode\u003em\u003c/code\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eOutput\u003c/strong\u003e:\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003ePlaintext attribute contents, or decryption failure.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp dir=\"auto\"\u003e\u003cstrong\u003eAlgorithm\u003c/strong\u003e:\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eDecompose input 2 into \u003ccode\u003eh\u003c/code\u003e, \u003ccode\u003er\u003c/code\u003e, \u003ccode\u003eQ\u003c/code\u003e, \u003ccode\u003et\u003c/code\u003e, and \u003ccode\u003ec\u003c/code\u003e.\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003e\u003ccode\u003eh\u003c/code\u003e is always 1 byte long\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003er\u003c/code\u003e is always 32 bytes long\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eQ\u003c/code\u003e is always 32 bytes long\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003et\u003c/code\u003e is always 32 bytes long\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ec\u003c/code\u003e is always variable (equal to the length of the original plaintext)\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eEnsure \u003ccode\u003eh\u003c/code\u003e is equal to the expected version prefix (\u003ca href=\"#version-1-constants\"\u003e\u003ccode\u003eVERSION\u003c/code\u003e\u003c/a\u003e currently).\nIf it is not, return a decryption error.\u003c/li\u003e\n\u003cli\u003eDerive an authentication key, \u003ccode\u003eAk\u003c/code\u003e, through \u003ca href=\"#version-1-functions\"\u003e\u003ccode\u003eKDF\u003c/code\u003e\u003c/a\u003e with a NULL salt and an info string set to\n\u003ccode\u003eKDF_AUTH_KEY || h || r || len(a) || a\u003c/code\u003e, with an output length of 256 bits.\u003c/li\u003e\n\u003cli\u003eRecalculate the \u003ca href=\"#version-1-functions\"\u003e\u003ccode\u003eMAC\u003c/code\u003e\u003c/a\u003e of \u003ccode\u003eh || r || len(a) || a || len(c) || c || len(Q) || Q\u003c/code\u003e, with \u003ccode\u003eAk\u003c/code\u003e\nas the key. Truncate the HMAC output to the rightmost 32 bytes (256 bits) to obtain \u003ccode\u003et2\u003c/code\u003e. This is equivalent to\nreducing the HMAC output modulo 2^{256}.\u003c/li\u003e\n\u003cli\u003eCompare \u003ccode\u003et\u003c/code\u003e with \u003ccode\u003et2\u003c/code\u003e, using a \u003ca href=\"https://soatok.blog/2020/08/27/soatoks-guide-to-side-channel-attacks/#string-comparison\" rel=\"nofollow\"\u003econstant-time compare operation\u003c/a\u003e.\nIf the two are not equal, return a decryption error.\u003c/li\u003e\n\u003cli\u003eDerive an encryption key, \u003ccode\u003eEk\u003c/code\u003e, and nonce, \u003ccode\u003en\u003c/code\u003e, through \u003ca href=\"#version-1-functions\"\u003e\u003ccode\u003eKDF\u003c/code\u003e\u003c/a\u003e with a NULL salt and an info\nstring set to \u003ccode\u003eKDF_ENCRYPT_KEY || h || r || len(a) || a\u003c/code\u003e, with an output length of 384 bits. The most significant\n256 bits will be the encryption key, \u003ccode\u003eEk\u003c/code\u003e, while the remaining 128 bits will be the nonce, \u003ccode\u003en\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eDecrypt \u003ccode\u003ec\u003c/code\u003e using \u003ca href=\"#version-1-functions\"\u003e\u003ccode\u003eStream\u003c/code\u003e\u003c/a\u003e, with the nonce set to \u003ccode\u003en\u003c/code\u003e, to obtain the message attribute\nvalue, \u003ccode\u003ep\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eDerive a commitment salt, \u003ccode\u003es\u003c/code\u003e, as the \u003ca href=\"#version-1-functions\"\u003e\u003ccode\u003eHash\u003c/code\u003e\u003c/a\u003e of\n\u003ccode\u003eKDF_COMMIT_SALT || h || r || len(m) || m || len(a) || a\u003c/code\u003e\ntruncated to 128 bits (big endian / the least significant bits).\u003c/li\u003e\n\u003cli\u003eRecalculate \u003ca href=\"#message-attribute-plaintext-commitment-algorithm\"\u003ethe commitment of the plaintext\u003c/a\u003e to obtain  \u003ccode\u003eQ2\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eCompare \u003ccode\u003eQ\u003c/code\u003e with \u003ccode\u003eQ2\u003c/code\u003e using a \u003ca href=\"https://soatok.blog/2020/08/27/soatoks-guide-to-side-channel-attacks/#string-comparison\" rel=\"nofollow\"\u003econstant-time compare operation\u003c/a\u003e.\nIf the two are not equal, return a decryption error.\u003c/li\u003e\n\u003cli\u003eReturn \u003ccode\u003ep\u003c/code\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eHPKE Cipher Suites\u003c/h3\u003e\u003ca id=\"user-content-hpke-cipher-suites\" class=\"anchor\" aria-label=\"Permalink: HPKE Cipher Suites\" href=\"#hpke-cipher-suites\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eHPKE cipher suites consists of the following information:\u003c/p\u003e\n\u003cul dir=\"auto\"\u003e\n\u003cli\u003eKEM algorithm\u003c/li\u003e\n\u003cli\u003eKDF algorithm\u003c/li\u003e\n\u003cli\u003eAEAD algorithm\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp dir=\"auto\"\u003eThis table includes some example HPKE cipher suites. This list is not exhaustive.\u003c/p\u003e\n\u003cmarkdown-accessiblity-table\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eCipher Suite String\u003c/th\u003e\n\u003cth\u003eRemarks\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eCurve25519_SHA256_ChachaPoly\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eDefault; must be supported\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eP256_SHA256_AES_GCM_256\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eP384_SHA384_AES_GCM_256\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eP521_SHA512_AES_GCM_256\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\u003c/markdown-accessiblity-table\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch2 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eSecurity Considerations\u003c/h2\u003e\u003ca id=\"user-content-security-considerations\" class=\"anchor\" aria-label=\"Permalink: Security Considerations\" href=\"#security-considerations\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eRules For Cryptography Implementors\u003c/h3\u003e\u003ca id=\"user-content-rules-for-cryptography-implementors\" class=\"anchor\" aria-label=\"Permalink: Rules For Cryptography Implementors\" href=\"#rules-for-cryptography-implementors\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAll implementations of cryptographic primitives (i.e., AES) must be resistant to side-channel attacks and use the\nstrictest possible validation criteria.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eFor randomness and entropy, the Operating System's Cryptographic Random Number Generator must be used. On Linux systems,\nthe \u003ccode\u003egetrandom(2)\u003c/code\u003e syscall or \u003ccode\u003e/dev/urandom\u003c/code\u003e device is acceptable. Userspace random number generators (e.g., OpenSSL's\n\u003ccode\u003eRAND_bytes()\u003c/code\u003e) \u003cstrong\u003eMUST NOT\u003c/strong\u003e be used.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eFor AES, this means only supporting hardware acceleration or constant-time, bitsliced software implementations.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eFor Ed25519, this means rejecting low-order public keys or non-canonical signatures.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eFor Argon2id, this means that at least one of the rounds must use data-independent memory addresses. It's acceptable if\none or more rounds uses data-dependent memory addresses to improve GPU attack resistance.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eWhen base64url-encoding a non-secret value, there is no expectation of constant-time behavior. However, if the data\nbeing encoded or decoded is a secret (e.g., plaintext or cryptography key), the codec \u003cstrong\u003eMUST\u003c/strong\u003e be implemented in\nconstant-time.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eWhen comparing cryptographic outputs, a constant-time comparison \u003cstrong\u003eMUST\u003c/strong\u003e always be used.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eCryptographic Agility\u003c/h3\u003e\u003ca id=\"user-content-cryptographic-agility\" class=\"anchor\" aria-label=\"Permalink: Cryptographic Agility\" href=\"#cryptographic-agility\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThis specification uses sequential versioning as a mechanism for cryptographic agility with minimal in-band signaling.\nEach suite of algorithm is assigned to a number, which provides a hard-coded set of cryptographic primitives.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThere are no options within each version; only one algorithm is permitted in a specific context. Should multiple use\ncases exist that demand different algorithms, each use case will be codified in a distinct version.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe suite of algorithms used are outlined in the \u003ca href=\"#algorithm-suite-versions\"\u003eAlgorithm Suite Versions\u003c/a\u003e section.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eInteroperability As A Non-Goal\u003c/h3\u003e\u003ca id=\"user-content-interoperability-as-a-non-goal\" class=\"anchor\" aria-label=\"Permalink: Interoperability As A Non-Goal\" href=\"#interoperability-as-a-non-goal\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eOther software and protocols are welcome to be compatible with our designs, but we will make no effort to support\nincumbent designs or protocols (i.e., the PGP ecosystem and its Web Of Trust model).\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eEncryption of Protocol Message Attributes\u003c/h3\u003e\u003ca id=\"user-content-encryption-of-protocol-message-attributes\" class=\"anchor\" aria-label=\"Permalink: Encryption of Protocol Message Attributes\" href=\"#encryption-of-protocol-message-attributes\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eThe main security consideration of encrypted message attributes (i.e., Actor ID) is to ensure that the contents are\nindistinguishable from random once the key has been securely erased. Beyond that, it only exists for compliance, not\nsecurity.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThus, without the key, it should be computationally infeasible to recover the plaintext attribute. With this security\nguarantee in place, so long as all parties honor the request of the key to be erased in response to a \"right to be\nforgotten\" request, the plaintext is effectively deleted.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThis allows operators to store these fields and honor such requests without having to violate the integrity of the\nunderlying transparency log when a legal request comes in.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003ePlaintext Commitment\u003c/h4\u003e\u003ca id=\"user-content-plaintext-commitment\" class=\"anchor\" aria-label=\"Permalink: Plaintext Commitment\" href=\"#plaintext-commitment\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eWhen the Public Key Directory has the symmetric key, it will respond to queries with both the ciphertext and the\ncorresponding plaintext. In order to keep the PKD honest, the ciphertext includes a commitment to the plaintext. It\nshould be computationally infeasible for a PKD to convincingly lie about the plaintext that produced a given ciphertext,\neven though the key is not being disclosed.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eTo accomplish this, the commitment is a Argon2id KDF output where the password is based on the plaintext value,\nattribute name, and a recent Merkle root for a previously accepted Protocol Message.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe salt is calculated from the random value used for encrypting this record, the attribute name, and the same recent\nMerkle root as the password.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe goal of this construction is to be completely deterministic based on public inputs (plaintext, attribute name,\nrecent Merkle root), yet still difficult to perform offline dictionary attacks against (i.e., rainbow tables).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe resulting plaintext commitment consists of a 256-bit Argon2id KDF output. This commitment is also covered by the\nauthentication tag on the associated ciphertext, which is then committed to a new Merkle root. This gives no opportunity\nfor the server to behave dishonestly about which plaintext corresponds to a committed ciphertext, outside complying with\nRight To Be Forgotten style legal demands.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eRevocation and Account Recovery\u003c/h3\u003e\u003ca id=\"user-content-revocation-and-account-recovery\" class=\"anchor\" aria-label=\"Permalink: Revocation and Account Recovery\" href=\"#revocation-and-account-recovery\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003ePublic key revocation is a thorny topic, and is difficult to balance for all threat models.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eSome users may want the ability to re-establish themselves in the protocol, no matter how badly they mismanage their\nkeys. Thus, their instance being able to issue a \u003ca href=\"#burndown\"\u003e\u003ccode\u003eBurnDown\u003c/code\u003e\u003c/a\u003e is essential as a break-glass feature for\naccount recovery.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eOther users may expect a higher degree of security, and may wish to opt out of this \u003ccode\u003eBurnDown\u003c/code\u003e capability from their\nFediverse instance. Once they have opted out, the only way to undo opting out is by issuing an \u003ccode\u003eUndoFireproof\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"#revokekeythirdparty\"\u003e\u003ccode\u003eRevokeKeyThirdParty\u003c/code\u003e\u003c/a\u003e is an emergency feature that allows anyone to pull the plug on a\ncompromised identity key. Every time one is issued, the community should pay close attention to the Actor affected by\nit.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIf a third party issues a \u003ccode\u003eRevokeKeyThirdParty\u003c/code\u003e with a valid revocation token for a fireproof user's only valid public\nkey, the system \u003cstrong\u003eMUST\u003c/strong\u003e prioritize handling the key compromise as a higher priority. This means that \u003ccode\u003eFireproof\u003c/code\u003e is\nignored in this edge case.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eMinimal Trust of Instance Operators\u003c/h3\u003e\u003ca id=\"user-content-minimal-trust-of-instance-operators\" class=\"anchor\" aria-label=\"Permalink: Minimal Trust of Instance Operators\" href=\"#minimal-trust-of-instance-operators\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eA malicious operator of your Fediverse server can do the following:\u003c/p\u003e\n\u003col dir=\"auto\"\u003e\n\u003cli\u003eIssue an \u003ccode\u003eAddKey\u003c/code\u003e protocol message for any Actor that doesn't currently have a Public Key registered to the PKD.\u003c/li\u003e\n\u003cli\u003eIssue a \u003ccode\u003eBurnDown\u003c/code\u003e protocol message for any Actor that has not previously issued a \u003ccode\u003eFireproof\u003c/code\u003e message.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp dir=\"auto\"\u003eThe first capability is necessary in order to bootstrap trust on first use. These messages must be signed by your\nserver to ensure that the first public key you register has come from your Fediverse server. However, a malicious admin\ncan issue \u003ccode\u003eAddKey\u003c/code\u003e messages for users that have not currently enrolled.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe second capability is an emergency break-glass feature to allow a user that has lost all their secret keys to regain\naccess to their account. The instance operator can publish a \u003ccode\u003eBurnDown\u003c/code\u003e to \"reset\" the PKD for a given Actor, which\ndistrusts all of that Actor's public keys and allows them to start over with a fresh \u003ccode\u003eAddKey\u003c/code\u003e to enroll from zero.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eA malicious instance operator could use this to replace a user's public key with one the operator can sign messages for.\nTherefore, we strongly recommend that independent third parties scrutinize any use of \u003ccode\u003eBurnDown\u003c/code\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eIf users wish to opt out of being able to ever issue a \u003ccode\u003eBurnDown\u003c/code\u003e, they can issue a \u003ccode\u003eFireproof\u003c/code\u003e at any time to turn this\nfeature off. The only way to reverse this opt-out is to issue an \u003ccode\u003eUndoFireproof\u003c/code\u003e message, signed by one of the user's\nsecret keys. This is a deliberate design decision to enable power users to choose security over convenience, without\nbeing forever locked out of convenience if their personal threat model changes.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch4 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003ePosition Statement From the Authors\u003c/h4\u003e\u003ca id=\"user-content-position-statement-from-the-authors\" class=\"anchor\" aria-label=\"Permalink: Position Statement From the Authors\" href=\"#position-statement-from-the-authors\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eAny attempt to enable account recovery is necessarily a backdoor, no matter how it's designed or implemented. This is\ntautology: granting access when you have no credentials to gain access is a violation of the integrity (and, sometimes,\nthe confidentiality) of a system.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eConversely, \u003ca href=\"https://security.stackexchange.com/a/6116\" rel=\"nofollow\"\u003esecurity at the cost of usability comes at the cost of security\u003c/a\u003e.\nWe introduced this capability in our designs in order to improve the usability of protocols that build upon our Public\nKey Directory project. We include an explicit, reversible opt-out mechanism for any users that might feel threatened\nby the existence of this capability.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eWe believe this strikes the right balance between security and usability. It's important that this is communicated\ntransparently to users, and they are made aware of the \u003ccode\u003eFireproof\u003c/code\u003e opt-out mechanism (and its consequences).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eSecurity researchers and whistleblowers \u003cstrong\u003eSHOULD\u003c/strong\u003e keep up-to-date on any use of \u003ccode\u003eBurnDown\u003c/code\u003e in their social graph, as\nwell as any suspicious \u003ccode\u003eAddKey\u003c/code\u003e messages for users that have no interest in end-to-end encryption. Both signals may\nserve as clues that someone may be up to no good, but they could also indicate a harmless human error. Don't jump to\nconclusions based on these issuances alone.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eFinally, the entire point of using Transparency Logs is to force attackers to publish their activity, which enables\ndefenders and activists to be immediately aware of the potentially malicious actions. You cannot attack the network\nto impersonate a flammable Actor without risking detection.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eAvailability\u003c/h3\u003e\u003ca id=\"user-content-availability\" class=\"anchor\" aria-label=\"Permalink: Availability\" href=\"#availability\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eClient software \u003cstrong\u003eSHOULD\u003c/strong\u003e route Protocol Messages to more than one Public Key Directory, in case of catastrophic\noutages or data corruption, as outlined in \u003ca href=\"#cosmic-ray-causes-a-bit-flip-on-stored-data-or-the-result-of-a-computation\"\u003ethe threat model\u003c/a\u003e.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eEach Public Key Directory \u003cstrong\u003eSHOULD\u003c/strong\u003e use a different symmetric key for attribute encryption. Fediverse Servers \u003cstrong\u003eMAY\u003c/strong\u003e\naccept batches of different Protocol Messages (one for each Public Key Directory), and then fan them out asynchronously.\nClients \u003cstrong\u003eSHOULD\u003c/strong\u003e also use a \u003ca href=\"#recent-merkle-root-included-in-plaintext-commitments\"\u003erecent Merkle root\u003c/a\u003e from the\nSigsum instance tied to that particular Public Key Directory.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eWhen requesting the public keys or auxiliary data for a specific ActivityPub actor, clients \u003cstrong\u003eSHOULD\u003c/strong\u003e query multiple\nPublic Key Directories. The \u003cstrong\u003eRECOMMENDED\u003c/strong\u003e behavior is to require a specific entry exists in multiple PKDs to meet some\nclient-side-configurable Quorum, and reject public keys that have not yet been broadcast to, and accepted by, sufficient\nPublic Key Directory servers.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eReasoning for Encryption of Protocol Messages from Clients\u003c/h3\u003e\u003ca id=\"user-content-reasoning-for-encryption-of-protocol-messages-from-clients\" class=\"anchor\" aria-label=\"Permalink: Reasoning for Encryption of Protocol Messages from Clients\" href=\"#reasoning-for-encryption-of-protocol-messages-from-clients\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003eIf clients seek to hide the contents of any Protocol Message they are sending to the Public Key Directory from the\nFediverse Server that hosts their account, this provides a mechanism to prevent an honest but curious admin from\ncomprehending their actions.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe public key \u003cstrong\u003eMUST\u003c/strong\u003e be fetched directly from each Public Key Directory. Client software \u003cstrong\u003eMUST NOT\u003c/strong\u003e trust any\npublic key provided by the Fediverse Server.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca href=\"#burndown\"\u003e\u003ccode\u003eBurnDown\u003c/code\u003e\u003c/a\u003e messages \u003cstrong\u003eMUST NOT\u003c/strong\u003e be encrypted this way. The reason for this is that the Public Key\nDirectory has no idea who is an administrator and who isn't. Therefore, the instance administration team \u003cstrong\u003eMUST\u003c/strong\u003e be the\nonly entities capable of issuing a BurnDown.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\" dir=\"auto\"\u003e\u003ch3 tabindex=\"-1\" class=\"heading-element\" dir=\"auto\"\u003eQuantifying the Trustworthiness of the Public Key Directory\u003c/h3\u003e\u003ca id=\"user-content-quantifying-the-trustworthiness-of-the-public-key-directory\" class=\"anchor\" aria-label=\"Permalink: Quantifying the Trustworthiness of the Public Key Directory\" href=\"#quantifying-the-trustworthiness-of-the-public-key-directory\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp dir=\"auto\"\u003ePublic keys distributed through the Public Key Directory can be generally considered more trustworthy than \u003cem\u003eTrust On\nFirst Use\u003c/em\u003e (TOFU) but less trustworthy than manually-verified public keys communicated out-of-band.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe exact point on the continuum between these extremes is indeterminate and may depend on various individuals'\nrisk appetites. When building applications atop this protocol, keep this in mind.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThis system has no concept of Authorities in its design. Trust decisions must be made at the edge, and cannot be\ntotally outsourced to the Public Key Directory (at least, without relying on hypothetical third-party designs).\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eDon't blindly assume that the public keys we vend are trusted to the maximum level without the users verifying some\nother mechanism (e.g. safety numbers).\u003c/p\u003e\n\u003c/article\u003e","renderedFileInfo":null,"shortPath":null,"symbolsEnabled":true,"tabSize":4,"topBannersInfo":{"overridingGlobalFundingFile":false,"globalPreferredFundingPath":null,"showInvalidCitationWarning":false,"citationHelpUrl":"https://docs.github.com/github/creating-cloning-and-archiving-repositories/creating-a-repository-on-github/about-citation-files","actionsOnboardingTip":null},"truncated":false,"viewable":true,"workflowRedirectUrl":null,"symbols":{"timed_out":false,"not_analyzed":false,"symbols":[{"name":"Public Key Directory Specification","kind":"section_1","ident_start":2,"ident_end":36,"extent_start":0,"extent_end":146007,"fully_qualified_name":"Public Key Directory Specification","ident_utf16":{"start":{"line_number":0,"utf16_col":2},"end":{"line_number":0,"utf16_col":36}},"extent_utf16":{"start":{"line_number":0,"utf16_col":0},"end":{"line_number":2599,"utf16_col":0}}},{"name":"Introduction","kind":"section_2","ident_start":439,"ident_end":451,"extent_start":436,"extent_end":4655,"fully_qualified_name":"Introduction","ident_utf16":{"start":{"line_number":9,"utf16_col":3},"end":{"line_number":9,"utf16_col":15}},"extent_utf16":{"start":{"line_number":9,"utf16_col":0},"end":{"line_number":86,"utf16_col":0}}},{"name":"Motivation","kind":"section_3","ident_start":457,"ident_end":467,"extent_start":453,"extent_end":3144,"fully_qualified_name":"Motivation","ident_utf16":{"start":{"line_number":11,"utf16_col":4},"end":{"line_number":11,"utf16_col":14}},"extent_utf16":{"start":{"line_number":11,"utf16_col":0},"end":{"line_number":54,"utf16_col":0}}},{"name":"Public Key Infrastructures","kind":"section_4","ident_start":847,"ident_end":873,"extent_start":842,"extent_end":2847,"fully_qualified_name":"Public Key Infrastructures","ident_utf16":{"start":{"line_number":19,"utf16_col":5},"end":{"line_number":19,"utf16_col":31}},"extent_utf16":{"start":{"line_number":19,"utf16_col":0},"end":{"line_number":47,"utf16_col":0}}},{"name":"Use Case","kind":"section_4","ident_start":2852,"ident_end":2860,"extent_start":2847,"extent_end":3144,"fully_qualified_name":"Use Case","ident_utf16":{"start":{"line_number":47,"utf16_col":5},"end":{"line_number":47,"utf16_col":13}},"extent_utf16":{"start":{"line_number":47,"utf16_col":0},"end":{"line_number":54,"utf16_col":0}}},{"name":"This Document","kind":"section_3","ident_start":3148,"ident_end":3161,"extent_start":3144,"extent_end":3720,"fully_qualified_name":"This Document","ident_utf16":{"start":{"line_number":54,"utf16_col":4},"end":{"line_number":54,"utf16_col":17}},"extent_utf16":{"start":{"line_number":54,"utf16_col":0},"end":{"line_number":67,"utf16_col":0}}},{"name":"Out Of Scope","kind":"section_3","ident_start":3724,"ident_end":3736,"extent_start":3720,"extent_end":4340,"fully_qualified_name":"Out Of Scope","ident_utf16":{"start":{"line_number":67,"utf16_col":4},"end":{"line_number":67,"utf16_col":16}},"extent_utf16":{"start":{"line_number":67,"utf16_col":0},"end":{"line_number":80,"utf16_col":0}}},{"name":"Notation and Conventions","kind":"section_3","ident_start":4344,"ident_end":4368,"extent_start":4340,"extent_end":4655,"fully_qualified_name":"Notation and Conventions","ident_utf16":{"start":{"line_number":80,"utf16_col":4},"end":{"line_number":80,"utf16_col":28}},"extent_utf16":{"start":{"line_number":80,"utf16_col":0},"end":{"line_number":86,"utf16_col":0}}},{"name":"Concepts","kind":"section_2","ident_start":4658,"ident_end":4666,"extent_start":4655,"extent_end":17138,"fully_qualified_name":"Concepts","ident_utf16":{"start":{"line_number":86,"utf16_col":3},"end":{"line_number":86,"utf16_col":11}},"extent_utf16":{"start":{"line_number":86,"utf16_col":0},"end":{"line_number":321,"utf16_col":0}}},{"name":"Identity Binding","kind":"section_3","ident_start":4672,"ident_end":4688,"extent_start":4668,"extent_end":4996,"fully_qualified_name":"Identity Binding","ident_utf16":{"start":{"line_number":88,"utf16_col":4},"end":{"line_number":88,"utf16_col":20}},"extent_utf16":{"start":{"line_number":88,"utf16_col":0},"end":{"line_number":95,"utf16_col":0}}},{"name":"Message Blocks","kind":"section_3","ident_start":5000,"ident_end":5014,"extent_start":4996,"extent_end":6250,"fully_qualified_name":"Message Blocks","ident_utf16":{"start":{"line_number":95,"utf16_col":4},"end":{"line_number":95,"utf16_col":18}},"extent_utf16":{"start":{"line_number":95,"utf16_col":0},"end":{"line_number":115,"utf16_col":0}}},{"name":"Public Key Encoding","kind":"section_3","ident_start":6254,"ident_end":6273,"extent_start":6250,"extent_end":6532,"fully_qualified_name":"Public Key Encoding","ident_utf16":{"start":{"line_number":115,"utf16_col":4},"end":{"line_number":115,"utf16_col":23}},"extent_utf16":{"start":{"line_number":115,"utf16_col":0},"end":{"line_number":122,"utf16_col":0}}},{"name":"Merkle Root Encoding","kind":"section_3","ident_start":6536,"ident_end":6556,"extent_start":6532,"extent_end":6867,"fully_qualified_name":"Merkle Root Encoding","ident_utf16":{"start":{"line_number":122,"utf16_col":4},"end":{"line_number":122,"utf16_col":24}},"extent_utf16":{"start":{"line_number":122,"utf16_col":0},"end":{"line_number":129,"utf16_col":0}}},{"name":"Protocol Signatures","kind":"section_3","ident_start":6871,"ident_end":6890,"extent_start":6867,"extent_end":8624,"fully_qualified_name":"Protocol Signatures","ident_utf16":{"start":{"line_number":129,"utf16_col":4},"end":{"line_number":129,"utf16_col":23}},"extent_utf16":{"start":{"line_number":129,"utf16_col":0},"end":{"line_number":171,"utf16_col":0}}},{"name":"Key Identifiers","kind":"section_3","ident_start":8628,"ident_end":8643,"extent_start":8624,"extent_end":9695,"fully_qualified_name":"Key Identifiers","ident_utf16":{"start":{"line_number":171,"utf16_col":4},"end":{"line_number":171,"utf16_col":19}},"extent_utf16":{"start":{"line_number":171,"utf16_col":0},"end":{"line_number":187,"utf16_col":0}}},{"name":"Revocation Tokens","kind":"section_3","ident_start":9699,"ident_end":9716,"extent_start":9695,"extent_end":11065,"fully_qualified_name":"Revocation Tokens","ident_utf16":{"start":{"line_number":187,"utf16_col":4},"end":{"line_number":187,"utf16_col":21}},"extent_utf16":{"start":{"line_number":187,"utf16_col":0},"end":{"line_number":215,"utf16_col":0}}},{"name":"Auxiliary Data","kind":"section_3","ident_start":11069,"ident_end":11083,"extent_start":11065,"extent_end":12786,"fully_qualified_name":"Auxiliary Data","ident_utf16":{"start":{"line_number":215,"utf16_col":4},"end":{"line_number":215,"utf16_col":18}},"extent_utf16":{"start":{"line_number":215,"utf16_col":0},"end":{"line_number":255,"utf16_col":0}}},{"name":"Auxiliary Data Identifiers","kind":"section_4","ident_start":12012,"ident_end":12038,"extent_start":12007,"extent_end":12544,"fully_qualified_name":"Auxiliary Data Identifiers","ident_utf16":{"start":{"line_number":230,"utf16_col":5},"end":{"line_number":230,"utf16_col":31}},"extent_utf16":{"start":{"line_number":230,"utf16_col":0},"end":{"line_number":249,"utf16_col":0}}},{"name":"Requirements for Auxiliary Data Extensions","kind":"section_4","ident_start":12549,"ident_end":12591,"extent_start":12544,"extent_end":12786,"fully_qualified_name":"Requirements for Auxiliary Data Extensions","ident_utf16":{"start":{"line_number":249,"utf16_col":5},"end":{"line_number":249,"utf16_col":47}},"extent_utf16":{"start":{"line_number":249,"utf16_col":0},"end":{"line_number":255,"utf16_col":0}}},{"name":"Message Attribute Shreddability","kind":"section_3","ident_start":12790,"ident_end":12821,"extent_start":12786,"extent_end":16690,"fully_qualified_name":"Message Attribute Shreddability","ident_utf16":{"start":{"line_number":255,"utf16_col":4},"end":{"line_number":255,"utf16_col":35}},"extent_utf16":{"start":{"line_number":255,"utf16_col":0},"end":{"line_number":311,"utf16_col":0}}},{"name":"Timestamps","kind":"section_3","ident_start":16694,"ident_end":16704,"extent_start":16690,"extent_end":17138,"fully_qualified_name":"Timestamps","ident_utf16":{"start":{"line_number":311,"utf16_col":4},"end":{"line_number":311,"utf16_col":14}},"extent_utf16":{"start":{"line_number":311,"utf16_col":0},"end":{"line_number":321,"utf16_col":0}}},{"name":"Threat Model","kind":"section_2","ident_start":17141,"ident_end":17153,"extent_start":17138,"extent_end":43665,"fully_qualified_name":"Threat Model","ident_utf16":{"start":{"line_number":321,"utf16_col":3},"end":{"line_number":321,"utf16_col":15}},"extent_utf16":{"start":{"line_number":321,"utf16_col":0},"end":{"line_number":707,"utf16_col":0}}},{"name":"Assumptions","kind":"section_3","ident_start":17372,"ident_end":17383,"extent_start":17368,"extent_end":19033,"fully_qualified_name":"Assumptions","ident_utf16":{"start":{"line_number":326,"utf16_col":4},"end":{"line_number":326,"utf16_col":15}},"extent_utf16":{"start":{"line_number":326,"utf16_col":0},"end":{"line_number":347,"utf16_col":0}}},{"name":"Assets","kind":"section_3","ident_start":19037,"ident_end":19043,"extent_start":19033,"extent_end":19384,"fully_qualified_name":"Assets","ident_utf16":{"start":{"line_number":347,"utf16_col":4},"end":{"line_number":347,"utf16_col":10}},"extent_utf16":{"start":{"line_number":347,"utf16_col":0},"end":{"line_number":360,"utf16_col":0}}},{"name":"Actors","kind":"section_3","ident_start":19388,"ident_end":19394,"extent_start":19384,"extent_end":21157,"fully_qualified_name":"Actors","ident_utf16":{"start":{"line_number":360,"utf16_col":4},"end":{"line_number":360,"utf16_col":10}},"extent_utf16":{"start":{"line_number":360,"utf16_col":0},"end":{"line_number":384,"utf16_col":0}}},{"name":"Risks","kind":"section_3","ident_start":21161,"ident_end":21166,"extent_start":21157,"extent_end":43665,"fully_qualified_name":"Risks","ident_utf16":{"start":{"line_number":384,"utf16_col":4},"end":{"line_number":384,"utf16_col":9}},"extent_utf16":{"start":{"line_number":384,"utf16_col":0},"end":{"line_number":707,"utf16_col":0}}},{"name":"Attackers seek to change history.","kind":"section_4","ident_start":26695,"ident_end":26728,"extent_start":26690,"extent_end":26999,"fully_qualified_name":"Attackers seek to change history.","ident_utf16":{"start":{"line_number":417,"utf16_col":5},"end":{"line_number":417,"utf16_col":38}},"extent_utf16":{"start":{"line_number":417,"utf16_col":0},"end":{"line_number":426,"utf16_col":0}}},{"name":"Attackers seek to selectively censor historical records.","kind":"section_4","ident_start":27004,"ident_end":27060,"extent_start":26999,"extent_end":27995,"fully_qualified_name":"Attackers seek to selectively censor historical records.","ident_utf16":{"start":{"line_number":426,"utf16_col":5},"end":{"line_number":426,"utf16_col":61}},"extent_utf16":{"start":{"line_number":426,"utf16_col":0},"end":{"line_number":444,"utf16_col":0}}},{"name":"Attackers seek to replace public key mappings without altering the ledger.","kind":"section_4","ident_start":28000,"ident_end":28074,"extent_start":27995,"extent_end":28662,"fully_qualified_name":"Attackers seek to replace public key mappings without altering the ledger.","ident_utf16":{"start":{"line_number":444,"utf16_col":5},"end":{"line_number":444,"utf16_col":79}},"extent_utf16":{"start":{"line_number":444,"utf16_col":0},"end":{"line_number":457,"utf16_col":0}}},{"name":"Attackers seek to leverage plaintext commitment to recover encrypted records whose keys were wiped.","kind":"section_4","ident_start":28667,"ident_end":28766,"extent_start":28662,"extent_end":30011,"fully_qualified_name":"Attackers seek to leverage plaintext commitment to recover encrypted records whose keys were wiped.","ident_utf16":{"start":{"line_number":457,"utf16_col":5},"end":{"line_number":457,"utf16_col":104}},"extent_utf16":{"start":{"line_number":457,"utf16_col":0},"end":{"line_number":476,"utf16_col":0}}},{"name":"Instance administrator enrolls a public key on behalf of an un-enrolled user.","kind":"section_4","ident_start":30016,"ident_end":30093,"extent_start":30011,"extent_end":30688,"fully_qualified_name":"Instance administrator enrolls a public key on behalf of an un-enrolled user.","ident_utf16":{"start":{"line_number":476,"utf16_col":5},"end":{"line_number":476,"utf16_col":82}},"extent_utf16":{"start":{"line_number":476,"utf16_col":0},"end":{"line_number":489,"utf16_col":0}}},{"name":"Instance administrator attempts to enroll a new public key for a previously enrolled user.","kind":"section_4","ident_start":30693,"ident_end":30783,"extent_start":30688,"extent_end":31393,"fully_qualified_name":"Instance administrator attempts to enroll a new public key for a previously enrolled user.","ident_utf16":{"start":{"line_number":489,"utf16_col":5},"end":{"line_number":489,"utf16_col":95}},"extent_utf16":{"start":{"line_number":489,"utf16_col":0},"end":{"line_number":501,"utf16_col":0}}},{"name":"Instance administrator attempts to reset the public keys for a previously enrolled user.","kind":"section_4","ident_start":31398,"ident_end":31486,"extent_start":31393,"extent_end":31632,"fully_qualified_name":"Instance administrator attempts to reset the public keys for a previously enrolled user.","ident_utf16":{"start":{"line_number":501,"utf16_col":5},"end":{"line_number":501,"utf16_col":93}},"extent_utf16":{"start":{"line_number":501,"utf16_col":0},"end":{"line_number":507,"utf16_col":0}}},{"name":"Race condition between successful BurnDown and subsequent AddKey.","kind":"section_4","ident_start":31637,"ident_end":31702,"extent_start":31632,"extent_end":32048,"fully_qualified_name":"Race condition between successful BurnDown and subsequent AddKey.","ident_utf16":{"start":{"line_number":507,"utf16_col":5},"end":{"line_number":507,"utf16_col":70}},"extent_utf16":{"start":{"line_number":507,"utf16_col":0},"end":{"line_number":516,"utf16_col":0}}},{"name":"Hostile nation state demands their public key be added to an existing actor under a gag order.","kind":"section_4","ident_start":32053,"ident_end":32147,"extent_start":32048,"extent_end":32840,"fully_qualified_name":"Hostile nation state demands their public key be added to an existing actor under a gag order.","ident_utf16":{"start":{"line_number":516,"utf16_col":5},"end":{"line_number":516,"utf16_col":99}},"extent_utf16":{"start":{"line_number":516,"utf16_col":0},"end":{"line_number":529,"utf16_col":0}}},{"name":"Hostile nation state seeks to abuse _Right To Be Forgotten_ mechanisms to cover up an unlawful intrusion.","kind":"section_4","ident_start":32845,"ident_end":32950,"extent_start":32840,"extent_end":34534,"fully_qualified_name":"Hostile nation state seeks to abuse _Right To Be Forgotten_ mechanisms to cover up an unlawful intrusion.","ident_utf16":{"start":{"line_number":529,"utf16_col":5},"end":{"line_number":529,"utf16_col":110}},"extent_utf16":{"start":{"line_number":529,"utf16_col":0},"end":{"line_number":552,"utf16_col":0}}},{"name":"Instance administrator loses all their signing keys.","kind":"section_4","ident_start":34539,"ident_end":34591,"extent_start":34534,"extent_end":35652,"fully_qualified_name":"Instance administrator loses all their signing keys.","ident_utf16":{"start":{"line_number":552,"utf16_col":5},"end":{"line_number":552,"utf16_col":57}},"extent_utf16":{"start":{"line_number":552,"utf16_col":0},"end":{"line_number":573,"utf16_col":0}}},{"name":"Attacker sends spoofed messages on behalf of another server.","kind":"section_4","ident_start":35657,"ident_end":35717,"extent_start":35652,"extent_end":36345,"fully_qualified_name":"Attacker sends spoofed messages on behalf of another server.","ident_utf16":{"start":{"line_number":573,"utf16_col":5},"end":{"line_number":573,"utf16_col":65}},"extent_utf16":{"start":{"line_number":573,"utf16_col":0},"end":{"line_number":586,"utf16_col":0}}},{"name":"Attacker sends spoofed messages from a compromised Fediverse server.","kind":"section_4","ident_start":36350,"ident_end":36418,"extent_start":36345,"extent_end":38063,"fully_qualified_name":"Attacker sends spoofed messages from a compromised Fediverse server.","ident_utf16":{"start":{"line_number":586,"utf16_col":5},"end":{"line_number":586,"utf16_col":73}},"extent_utf16":{"start":{"line_number":586,"utf16_col":0},"end":{"line_number":610,"utf16_col":0}}},{"name":"Cosmic ray causes a bit-flip on stored data or the result of a computation.","kind":"section_4","ident_start":38068,"ident_end":38143,"extent_start":38063,"extent_end":38852,"fully_qualified_name":"Cosmic ray causes a bit-flip on stored data or the result of a computation.","ident_utf16":{"start":{"line_number":610,"utf16_col":5},"end":{"line_number":610,"utf16_col":80}},"extent_utf16":{"start":{"line_number":610,"utf16_col":0},"end":{"line_number":627,"utf16_col":0}}},{"name":"Malicious instance administrator attempts to censor Fireproof messages to retain control.","kind":"section_4","ident_start":38857,"ident_end":38946,"extent_start":38852,"extent_end":39798,"fully_qualified_name":"Malicious instance administrator attempts to censor Fireproof messages to retain control.","ident_utf16":{"start":{"line_number":627,"utf16_col":5},"end":{"line_number":627,"utf16_col":94}},"extent_utf16":{"start":{"line_number":627,"utf16_col":0},"end":{"line_number":642,"utf16_col":0}}},{"name":"Malicious instance administrator also controls the Public Key Directory.","kind":"section_4","ident_start":39803,"ident_end":39875,"extent_start":39798,"extent_end":40670,"fully_qualified_name":"Malicious instance administrator also controls the Public Key Directory.","ident_utf16":{"start":{"line_number":642,"utf16_col":5},"end":{"line_number":642,"utf16_col":77}},"extent_utf16":{"start":{"line_number":642,"utf16_col":0},"end":{"line_number":657,"utf16_col":0}}},{"name":"Attacker uses a decoy Public Key Directory that publishes a dishonest history.","kind":"section_4","ident_start":40675,"ident_end":40753,"extent_start":40670,"extent_end":41519,"fully_qualified_name":"Attacker uses a decoy Public Key Directory that publishes a dishonest history.","ident_utf16":{"start":{"line_number":657,"utf16_col":5},"end":{"line_number":657,"utf16_col":83}},"extent_utf16":{"start":{"line_number":657,"utf16_col":0},"end":{"line_number":672,"utf16_col":0}}},{"name":"Attacker submits contraband as auxiliary data.","kind":"section_4","ident_start":41524,"ident_end":41570,"extent_start":41519,"extent_end":42207,"fully_qualified_name":"Attacker submits contraband as auxiliary data.","ident_utf16":{"start":{"line_number":672,"utf16_col":5},"end":{"line_number":672,"utf16_col":51}},"extent_utf16":{"start":{"line_number":672,"utf16_col":0},"end":{"line_number":685,"utf16_col":0}}},{"name":"Sharing Accounts","kind":"section_4","ident_start":42212,"ident_end":42228,"extent_start":42207,"extent_end":43665,"fully_qualified_name":"Sharing Accounts","ident_utf16":{"start":{"line_number":685,"utf16_col":5},"end":{"line_number":685,"utf16_col":21}},"extent_utf16":{"start":{"line_number":685,"utf16_col":0},"end":{"line_number":707,"utf16_col":0}}},{"name":"Sharing an  account by sharing the secret key","kind":"section_5","ident_start":42823,"ident_end":42868,"extent_start":42817,"extent_end":43269,"fully_qualified_name":"Sharing an  account by sharing the secret key","ident_utf16":{"start":{"line_number":692,"utf16_col":6},"end":{"line_number":692,"utf16_col":51}},"extent_utf16":{"start":{"line_number":692,"utf16_col":0},"end":{"line_number":700,"utf16_col":0}}},{"name":"Shared accounts by adding two keys","kind":"section_5","ident_start":43275,"ident_end":43309,"extent_start":43269,"extent_end":43665,"fully_qualified_name":"Shared accounts by adding two keys","ident_utf16":{"start":{"line_number":700,"utf16_col":6},"end":{"line_number":700,"utf16_col":40}},"extent_utf16":{"start":{"line_number":700,"utf16_col":0},"end":{"line_number":707,"utf16_col":0}}},{"name":"Protocol Messages","kind":"section_2","ident_start":43668,"ident_end":43685,"extent_start":43665,"extent_end":71954,"fully_qualified_name":"Protocol Messages","ident_utf16":{"start":{"line_number":707,"utf16_col":3},"end":{"line_number":707,"utf16_col":20}},"extent_utf16":{"start":{"line_number":707,"utf16_col":0},"end":{"line_number":1175,"utf16_col":0}}},{"name":"AddKey","kind":"section_3","ident_start":46249,"ident_end":46255,"extent_start":46245,"extent_end":49039,"fully_qualified_name":"AddKey","ident_utf16":{"start":{"line_number":759,"utf16_col":4},"end":{"line_number":759,"utf16_col":10}},"extent_utf16":{"start":{"line_number":759,"utf16_col":0},"end":{"line_number":805,"utf16_col":0}}},{"name":"AddKey Attributes","kind":"section_4","ident_start":47029,"ident_end":47046,"extent_start":47024,"extent_end":47943,"fully_qualified_name":"AddKey Attributes","ident_utf16":{"start":{"line_number":775,"utf16_col":5},"end":{"line_number":775,"utf16_col":22}},"extent_utf16":{"start":{"line_number":775,"utf16_col":0},"end":{"line_number":788,"utf16_col":0}}},{"name":"AddKey Validation Steps","kind":"section_4","ident_start":47948,"ident_end":47971,"extent_start":47943,"extent_end":49039,"fully_qualified_name":"AddKey Validation Steps","ident_utf16":{"start":{"line_number":788,"utf16_col":5},"end":{"line_number":788,"utf16_col":28}},"extent_utf16":{"start":{"line_number":788,"utf16_col":0},"end":{"line_number":805,"utf16_col":0}}},{"name":"RevokeKey","kind":"section_3","ident_start":49043,"ident_end":49052,"extent_start":49039,"extent_end":51592,"fully_qualified_name":"RevokeKey","ident_utf16":{"start":{"line_number":805,"utf16_col":4},"end":{"line_number":805,"utf16_col":13}},"extent_utf16":{"start":{"line_number":805,"utf16_col":0},"end":{"line_number":845,"utf16_col":0}}},{"name":"RevokeKey Attributes","kind":"section_4","ident_start":49617,"ident_end":49637,"extent_start":49612,"extent_end":50541,"fully_qualified_name":"RevokeKey Attributes","ident_utf16":{"start":{"line_number":816,"utf16_col":5},"end":{"line_number":816,"utf16_col":25}},"extent_utf16":{"start":{"line_number":816,"utf16_col":0},"end":{"line_number":829,"utf16_col":0}}},{"name":"RevokeKey Validation Steps","kind":"section_4","ident_start":50546,"ident_end":50572,"extent_start":50541,"extent_end":51592,"fully_qualified_name":"RevokeKey Validation Steps","ident_utf16":{"start":{"line_number":829,"utf16_col":5},"end":{"line_number":829,"utf16_col":31}},"extent_utf16":{"start":{"line_number":829,"utf16_col":0},"end":{"line_number":845,"utf16_col":0}}},{"name":"RevokeKeyThirdParty","kind":"section_3","ident_start":51596,"ident_end":51615,"extent_start":51592,"extent_end":53339,"fully_qualified_name":"RevokeKeyThirdParty","ident_utf16":{"start":{"line_number":845,"utf16_col":4},"end":{"line_number":845,"utf16_col":23}},"extent_utf16":{"start":{"line_number":845,"utf16_col":0},"end":{"line_number":880,"utf16_col":0}}},{"name":"RevokeKeyThirdParty Attributes","kind":"section_4","ident_start":52495,"ident_end":52525,"extent_start":52490,"extent_end":52708,"fully_qualified_name":"RevokeKeyThirdParty Attributes","ident_utf16":{"start":{"line_number":864,"utf16_col":5},"end":{"line_number":864,"utf16_col":35}},"extent_utf16":{"start":{"line_number":864,"utf16_col":0},"end":{"line_number":869,"utf16_col":0}}},{"name":"RevokeKeyThirdParty Validation Steps","kind":"section_4","ident_start":52713,"ident_end":52749,"extent_start":52708,"extent_end":53339,"fully_qualified_name":"RevokeKeyThirdParty Validation Steps","ident_utf16":{"start":{"line_number":869,"utf16_col":5},"end":{"line_number":869,"utf16_col":41}},"extent_utf16":{"start":{"line_number":869,"utf16_col":0},"end":{"line_number":880,"utf16_col":0}}},{"name":"MoveIdentity","kind":"section_3","ident_start":53343,"ident_end":53355,"extent_start":53339,"extent_end":55807,"fully_qualified_name":"MoveIdentity","ident_utf16":{"start":{"line_number":880,"utf16_col":4},"end":{"line_number":880,"utf16_col":16}},"extent_utf16":{"start":{"line_number":880,"utf16_col":0},"end":{"line_number":921,"utf16_col":0}}},{"name":"MoveIdentity Attributes","kind":"section_4","ident_start":53825,"ident_end":53848,"extent_start":53820,"extent_end":54707,"fully_qualified_name":"MoveIdentity Attributes","ident_utf16":{"start":{"line_number":890,"utf16_col":5},"end":{"line_number":890,"utf16_col":28}},"extent_utf16":{"start":{"line_number":890,"utf16_col":0},"end":{"line_number":903,"utf16_col":0}}},{"name":"MoveIdentity Validation Steps","kind":"section_4","ident_start":54712,"ident_end":54741,"extent_start":54707,"extent_end":55807,"fully_qualified_name":"MoveIdentity Validation Steps","ident_utf16":{"start":{"line_number":903,"utf16_col":5},"end":{"line_number":903,"utf16_col":34}},"extent_utf16":{"start":{"line_number":903,"utf16_col":0},"end":{"line_number":921,"utf16_col":0}}},{"name":"BurnDown","kind":"section_3","ident_start":55811,"ident_end":55819,"extent_start":55807,"extent_end":58854,"fully_qualified_name":"BurnDown","ident_utf16":{"start":{"line_number":921,"utf16_col":4},"end":{"line_number":921,"utf16_col":12}},"extent_utf16":{"start":{"line_number":921,"utf16_col":0},"end":{"line_number":969,"utf16_col":0}}},{"name":"BurnDown Attributes","kind":"section_4","ident_start":56321,"ident_end":56340,"extent_start":56316,"extent_end":57538,"fully_qualified_name":"BurnDown Attributes","ident_utf16":{"start":{"line_number":932,"utf16_col":5},"end":{"line_number":932,"utf16_col":24}},"extent_utf16":{"start":{"line_number":932,"utf16_col":0},"end":{"line_number":949,"utf16_col":0}}},{"name":"BurnDown Validation Steps","kind":"section_4","ident_start":57543,"ident_end":57568,"extent_start":57538,"extent_end":58854,"fully_qualified_name":"BurnDown Validation Steps","ident_utf16":{"start":{"line_number":949,"utf16_col":5},"end":{"line_number":949,"utf16_col":30}},"extent_utf16":{"start":{"line_number":949,"utf16_col":0},"end":{"line_number":969,"utf16_col":0}}},{"name":"Fireproof","kind":"section_3","ident_start":58858,"ident_end":58867,"extent_start":58854,"extent_end":61217,"fully_qualified_name":"Fireproof","ident_utf16":{"start":{"line_number":969,"utf16_col":4},"end":{"line_number":969,"utf16_col":13}},"extent_utf16":{"start":{"line_number":969,"utf16_col":0},"end":{"line_number":1008,"utf16_col":0}}},{"name":"Fireproof Attributes","kind":"section_4","ident_start":59582,"ident_end":59602,"extent_start":59577,"extent_end":60285,"fully_qualified_name":"Fireproof Attributes","ident_utf16":{"start":{"line_number":982,"utf16_col":5},"end":{"line_number":982,"utf16_col":25}},"extent_utf16":{"start":{"line_number":982,"utf16_col":0},"end":{"line_number":993,"utf16_col":0}}},{"name":"Fireproof Validation Steps","kind":"section_4","ident_start":60290,"ident_end":60316,"extent_start":60285,"extent_end":61217,"fully_qualified_name":"Fireproof Validation Steps","ident_utf16":{"start":{"line_number":993,"utf16_col":5},"end":{"line_number":993,"utf16_col":31}},"extent_utf16":{"start":{"line_number":993,"utf16_col":0},"end":{"line_number":1008,"utf16_col":0}}},{"name":"UndoFireproof","kind":"section_3","ident_start":61221,"ident_end":61234,"extent_start":61217,"extent_end":63320,"fully_qualified_name":"UndoFireproof","ident_utf16":{"start":{"line_number":1008,"utf16_col":4},"end":{"line_number":1008,"utf16_col":17}},"extent_utf16":{"start":{"line_number":1008,"utf16_col":0},"end":{"line_number":1044,"utf16_col":0}}},{"name":"UndoFireproof Attributes","kind":"section_4","ident_start":61669,"ident_end":61693,"extent_start":61664,"extent_end":62380,"fully_qualified_name":"UndoFireproof Attributes","ident_utf16":{"start":{"line_number":1018,"utf16_col":5},"end":{"line_number":1018,"utf16_col":29}},"extent_utf16":{"start":{"line_number":1018,"utf16_col":0},"end":{"line_number":1029,"utf16_col":0}}},{"name":"UndoFireproof Validation Steps","kind":"section_4","ident_start":62385,"ident_end":62415,"extent_start":62380,"extent_end":63320,"fully_qualified_name":"UndoFireproof Validation Steps","ident_utf16":{"start":{"line_number":1029,"utf16_col":5},"end":{"line_number":1029,"utf16_col":35}},"extent_utf16":{"start":{"line_number":1029,"utf16_col":0},"end":{"line_number":1044,"utf16_col":0}}},{"name":"AddAuxData","kind":"section_3","ident_start":63324,"ident_end":63334,"extent_start":63320,"extent_end":66165,"fully_qualified_name":"AddAuxData","ident_utf16":{"start":{"line_number":1044,"utf16_col":4},"end":{"line_number":1044,"utf16_col":14}},"extent_utf16":{"start":{"line_number":1044,"utf16_col":0},"end":{"line_number":1086,"utf16_col":0}}},{"name":"AddAuxData Attributes","kind":"section_4","ident_start":63632,"ident_end":63653,"extent_start":63627,"extent_end":64825,"fully_qualified_name":"AddAuxData Attributes","ident_utf16":{"start":{"line_number":1051,"utf16_col":5},"end":{"line_number":1051,"utf16_col":26}},"extent_utf16":{"start":{"line_number":1051,"utf16_col":0},"end":{"line_number":1067,"utf16_col":0}}},{"name":"AddAuxData Validation Steps","kind":"section_4","ident_start":64830,"ident_end":64857,"extent_start":64825,"extent_end":66165,"fully_qualified_name":"AddAuxData Validation Steps","ident_utf16":{"start":{"line_number":1067,"utf16_col":5},"end":{"line_number":1067,"utf16_col":32}},"extent_utf16":{"start":{"line_number":1067,"utf16_col":0},"end":{"line_number":1086,"utf16_col":0}}},{"name":"RevokeAuxData","kind":"section_3","ident_start":66169,"ident_end":66182,"extent_start":66165,"extent_end":69124,"fully_qualified_name":"RevokeAuxData","ident_utf16":{"start":{"line_number":1086,"utf16_col":4},"end":{"line_number":1086,"utf16_col":17}},"extent_utf16":{"start":{"line_number":1086,"utf16_col":0},"end":{"line_number":1129,"utf16_col":0}}},{"name":"RevokeAuxData Attributes","kind":"section_4","ident_start":66267,"ident_end":66291,"extent_start":66262,"extent_end":67652,"fully_qualified_name":"RevokeAuxData Attributes","ident_utf16":{"start":{"line_number":1090,"utf16_col":5},"end":{"line_number":1090,"utf16_col":29}},"extent_utf16":{"start":{"line_number":1090,"utf16_col":0},"end":{"line_number":1109,"utf16_col":0}}},{"name":"RevokeAuxData Validation Steps","kind":"section_4","ident_start":67657,"ident_end":67687,"extent_start":67652,"extent_end":69124,"fully_qualified_name":"RevokeAuxData Validation Steps","ident_utf16":{"start":{"line_number":1109,"utf16_col":5},"end":{"line_number":1109,"utf16_col":35}},"extent_utf16":{"start":{"line_number":1109,"utf16_col":0},"end":{"line_number":1129,"utf16_col":0}}},{"name":"Checkpoint","kind":"section_3","ident_start":69128,"ident_end":69138,"extent_start":69124,"extent_end":71954,"fully_qualified_name":"Checkpoint","ident_utf16":{"start":{"line_number":1129,"utf16_col":4},"end":{"line_number":1129,"utf16_col":14}},"extent_utf16":{"start":{"line_number":1129,"utf16_col":0},"end":{"line_number":1175,"utf16_col":0}}},{"name":"Checkpoint Attributes","kind":"section_4","ident_start":70264,"ident_end":70285,"extent_start":70259,"extent_end":71072,"fully_qualified_name":"Checkpoint Attributes","ident_utf16":{"start":{"line_number":1150,"utf16_col":5},"end":{"line_number":1150,"utf16_col":26}},"extent_utf16":{"start":{"line_number":1150,"utf16_col":0},"end":{"line_number":1161,"utf16_col":0}}},{"name":"Checkpoint Validation Steps","kind":"section_4","ident_start":71077,"ident_end":71104,"extent_start":71072,"extent_end":71954,"fully_qualified_name":"Checkpoint Validation Steps","ident_utf16":{"start":{"line_number":1161,"utf16_col":5},"end":{"line_number":1161,"utf16_col":32}},"extent_utf16":{"start":{"line_number":1161,"utf16_col":0},"end":{"line_number":1175,"utf16_col":0}}},{"name":"The Federated Public Key Directory","kind":"section_2","ident_start":71957,"ident_end":71991,"extent_start":71954,"extent_end":122285,"fully_qualified_name":"The Federated Public Key Directory","ident_utf16":{"start":{"line_number":1175,"utf16_col":3},"end":{"line_number":1175,"utf16_col":37}},"extent_utf16":{"start":{"line_number":1175,"utf16_col":0},"end":{"line_number":2190,"utf16_col":0}}},{"name":"Encryption of Protocol Messages","kind":"section_3","ident_start":71997,"ident_end":72028,"extent_start":71993,"extent_end":74249,"fully_qualified_name":"Encryption of Protocol Messages","ident_utf16":{"start":{"line_number":1177,"utf16_col":4},"end":{"line_number":1177,"utf16_col":35}},"extent_utf16":{"start":{"line_number":1177,"utf16_col":0},"end":{"line_number":1223,"utf16_col":0}}},{"name":"Protocol Message Encryption","kind":"section_4","ident_start":72555,"ident_end":72582,"extent_start":72550,"extent_end":73618,"fully_qualified_name":"Protocol Message Encryption","ident_utf16":{"start":{"line_number":1187,"utf16_col":5},"end":{"line_number":1187,"utf16_col":32}},"extent_utf16":{"start":{"line_number":1187,"utf16_col":0},"end":{"line_number":1212,"utf16_col":0}}},{"name":"Protocol Message Decryption","kind":"section_4","ident_start":73623,"ident_end":73650,"extent_start":73618,"extent_end":74249,"fully_qualified_name":"Protocol Message Decryption","ident_utf16":{"start":{"line_number":1212,"utf16_col":5},"end":{"line_number":1212,"utf16_col":32}},"extent_utf16":{"start":{"line_number":1212,"utf16_col":0},"end":{"line_number":1223,"utf16_col":0}}},{"name":"Protocol Message Processing","kind":"section_3","ident_start":74253,"ident_end":74280,"extent_start":74249,"extent_end":79557,"fully_qualified_name":"Protocol Message Processing","ident_utf16":{"start":{"line_number":1223,"utf16_col":4},"end":{"line_number":1223,"utf16_col":31}},"extent_utf16":{"start":{"line_number":1223,"utf16_col":0},"end":{"line_number":1311,"utf16_col":0}}},{"name":"Rate-Limiting Bad Requests","kind":"section_4","ident_start":74620,"ident_end":74646,"extent_start":74615,"extent_end":76199,"fully_qualified_name":"Rate-Limiting Bad Requests","ident_utf16":{"start":{"line_number":1231,"utf16_col":5},"end":{"line_number":1231,"utf16_col":31}},"extent_utf16":{"start":{"line_number":1231,"utf16_col":0},"end":{"line_number":1256,"utf16_col":0}}},{"name":"Protocol Message Parsing","kind":"section_4","ident_start":76204,"ident_end":76228,"extent_start":76199,"extent_end":77997,"fully_qualified_name":"Protocol Message Parsing","ident_utf16":{"start":{"line_number":1256,"utf16_col":5},"end":{"line_number":1256,"utf16_col":29}},"extent_utf16":{"start":{"line_number":1256,"utf16_col":0},"end":{"line_number":1287,"utf16_col":0}}},{"name":"Handling Protocol Messages","kind":"section_4","ident_start":78002,"ident_end":78028,"extent_start":77997,"extent_end":79557,"fully_qualified_name":"Handling Protocol Messages","ident_utf16":{"start":{"line_number":1287,"utf16_col":5},"end":{"line_number":1287,"utf16_col":31}},"extent_utf16":{"start":{"line_number":1287,"utf16_col":0},"end":{"line_number":1311,"utf16_col":0}}},{"name":"TOTP","kind":"section_3","ident_start":79561,"ident_end":79565,"extent_start":79557,"extent_end":83486,"fully_qualified_name":"TOTP","ident_utf16":{"start":{"line_number":1311,"utf16_col":4},"end":{"line_number":1311,"utf16_col":8}},"extent_utf16":{"start":{"line_number":1311,"utf16_col":0},"end":{"line_number":1393,"utf16_col":0}}},{"name":"TOTP Configuration","kind":"section_4","ident_start":80639,"ident_end":80657,"extent_start":80634,"extent_end":80815,"fully_qualified_name":"TOTP Configuration","ident_utf16":{"start":{"line_number":1329,"utf16_col":5},"end":{"line_number":1329,"utf16_col":23}},"extent_utf16":{"start":{"line_number":1329,"utf16_col":0},"end":{"line_number":1337,"utf16_col":0}}},{"name":"TOTP Enrollment","kind":"section_4","ident_start":80820,"ident_end":80835,"extent_start":80815,"extent_end":81603,"fully_qualified_name":"TOTP Enrollment","ident_utf16":{"start":{"line_number":1337,"utf16_col":5},"end":{"line_number":1337,"utf16_col":20}},"extent_utf16":{"start":{"line_number":1337,"utf16_col":0},"end":{"line_number":1352,"utf16_col":0}}},{"name":"TOTP Disenrollment","kind":"section_4","ident_start":81608,"ident_end":81626,"extent_start":81603,"extent_end":81973,"fully_qualified_name":"TOTP Disenrollment","ident_utf16":{"start":{"line_number":1352,"utf16_col":5},"end":{"line_number":1352,"utf16_col":23}},"extent_utf16":{"start":{"line_number":1352,"utf16_col":0},"end":{"line_number":1362,"utf16_col":0}}},{"name":"TOTP Rotation","kind":"section_4","ident_start":81978,"ident_end":81991,"extent_start":81973,"extent_end":82165,"fully_qualified_name":"TOTP Rotation","ident_utf16":{"start":{"line_number":1362,"utf16_col":5},"end":{"line_number":1362,"utf16_col":18}},"extent_utf16":{"start":{"line_number":1362,"utf16_col":0},"end":{"line_number":1368,"utf16_col":0}}},{"name":"TOTP Signatures","kind":"section_4","ident_start":82170,"ident_end":82185,"extent_start":82165,"extent_end":83080,"fully_qualified_name":"TOTP Signatures","ident_utf16":{"start":{"line_number":1368,"utf16_col":5},"end":{"line_number":1368,"utf16_col":20}},"extent_utf16":{"start":{"line_number":1368,"utf16_col":0},"end":{"line_number":1384,"utf16_col":0}}},{"name":"TOTP Verification","kind":"section_4","ident_start":83085,"ident_end":83102,"extent_start":83080,"extent_end":83486,"fully_qualified_name":"TOTP Verification","ident_utf16":{"start":{"line_number":1384,"utf16_col":5},"end":{"line_number":1384,"utf16_col":22}},"extent_utf16":{"start":{"line_number":1384,"utf16_col":0},"end":{"line_number":1393,"utf16_col":0}}},{"name":"JSON REST API","kind":"section_3","ident_start":83490,"ident_end":83503,"extent_start":83486,"extent_end":115542,"fully_qualified_name":"JSON REST API","ident_utf16":{"start":{"line_number":1393,"utf16_col":4},"end":{"line_number":1393,"utf16_col":17}},"extent_utf16":{"start":{"line_number":1393,"utf16_col":0},"end":{"line_number":2050,"utf16_col":0}}},{"name":"GET api/actor/:actor_id","kind":"section_4","ident_start":84159,"ident_end":84182,"extent_start":84154,"extent_end":85260,"fully_qualified_name":"GET api/actor/:actor_id","ident_utf16":{"start":{"line_number":1403,"utf16_col":5},"end":{"line_number":1403,"utf16_col":28}},"extent_utf16":{"start":{"line_number":1403,"utf16_col":0},"end":{"line_number":1432,"utf16_col":0}}},{"name":"GET api/actor/:actor_id/keys","kind":"section_4","ident_start":85265,"ident_end":85293,"extent_start":85260,"extent_end":88439,"fully_qualified_name":"GET api/actor/:actor_id/keys","ident_utf16":{"start":{"line_number":1432,"utf16_col":5},"end":{"line_number":1432,"utf16_col":33}},"extent_utf16":{"start":{"line_number":1432,"utf16_col":0},"end":{"line_number":1493,"utf16_col":0}}},{"name":"GET api/actor/:actor_id/key/:key_id","kind":"section_4","ident_start":88444,"ident_end":88479,"extent_start":88439,"extent_end":90909,"fully_qualified_name":"GET api/actor/:actor_id/key/:key_id","ident_utf16":{"start":{"line_number":1493,"utf16_col":5},"end":{"line_number":1493,"utf16_col":40}},"extent_utf16":{"start":{"line_number":1493,"utf16_col":0},"end":{"line_number":1532,"utf16_col":0}}},{"name":"GET api/actor/:actor_id/auxiliary","kind":"section_4","ident_start":90914,"ident_end":90947,"extent_start":90909,"extent_end":93055,"fully_qualified_name":"GET api/actor/:actor_id/auxiliary","ident_utf16":{"start":{"line_number":1532,"utf16_col":5},"end":{"line_number":1532,"utf16_col":38}},"extent_utf16":{"start":{"line_number":1532,"utf16_col":0},"end":{"line_number":1593,"utf16_col":0}}},{"name":"GET api/actor/:actor_id/auxiliary/:aux_data_id","kind":"section_4","ident_start":93060,"ident_end":93106,"extent_start":93055,"extent_end":95728,"fully_qualified_name":"GET api/actor/:actor_id/auxiliary/:aux_data_id","ident_utf16":{"start":{"line_number":1593,"utf16_col":5},"end":{"line_number":1593,"utf16_col":51}},"extent_utf16":{"start":{"line_number":1593,"utf16_col":0},"end":{"line_number":1634,"utf16_col":0}}},{"name":"GET api/history","kind":"section_4","ident_start":95733,"ident_end":95748,"extent_start":95728,"extent_end":96630,"fully_qualified_name":"GET api/history","ident_utf16":{"start":{"line_number":1634,"utf16_col":5},"end":{"line_number":1634,"utf16_col":20}},"extent_utf16":{"start":{"line_number":1634,"utf16_col":0},"end":{"line_number":1660,"utf16_col":0}}},{"name":"GET api/history/since/:last_hash","kind":"section_4","ident_start":96635,"ident_end":96667,"extent_start":96630,"extent_end":100601,"fully_qualified_name":"GET api/history/since/:last_hash","ident_utf16":{"start":{"line_number":1660,"utf16_col":5},"end":{"line_number":1660,"utf16_col":37}},"extent_utf16":{"start":{"line_number":1660,"utf16_col":0},"end":{"line_number":1718,"utf16_col":0}}},{"name":"GET api/history/view/:hash","kind":"section_4","ident_start":100606,"ident_end":100632,"extent_start":100601,"extent_end":104742,"fully_qualified_name":"GET api/history/view/:hash","ident_utf16":{"start":{"line_number":1718,"utf16_col":5},"end":{"line_number":1718,"utf16_col":31}},"extent_utf16":{"start":{"line_number":1718,"utf16_col":0},"end":{"line_number":1772,"utf16_col":0}}},{"name":"GET api/extensions","kind":"section_4","ident_start":104747,"ident_end":104765,"extent_start":104742,"extent_end":106139,"fully_qualified_name":"GET api/extensions","ident_utf16":{"start":{"line_number":1772,"utf16_col":5},"end":{"line_number":1772,"utf16_col":23}},"extent_utf16":{"start":{"line_number":1772,"utf16_col":0},"end":{"line_number":1812,"utf16_col":0}}},{"name":"GET api/replicas","kind":"section_4","ident_start":106144,"ident_end":106160,"extent_start":106139,"extent_end":107578,"fully_qualified_name":"GET api/replicas","ident_utf16":{"start":{"line_number":1812,"utf16_col":5},"end":{"line_number":1812,"utf16_col":21}},"extent_utf16":{"start":{"line_number":1812,"utf16_col":0},"end":{"line_number":1852,"utf16_col":0}}},{"name":"GET api/replica/:replica_id/{...}","kind":"section_4","ident_start":107583,"ident_end":107616,"extent_start":107578,"extent_end":108440,"fully_qualified_name":"GET api/replica/:replica_id/{...}","ident_utf16":{"start":{"line_number":1852,"utf16_col":5},"end":{"line_number":1852,"utf16_col":38}},"extent_utf16":{"start":{"line_number":1852,"utf16_col":0},"end":{"line_number":1871,"utf16_col":0}}},{"name":"GET api/server-public-key","kind":"section_4","ident_start":108445,"ident_end":108470,"extent_start":108440,"extent_end":109466,"fully_qualified_name":"GET api/server-public-key","ident_utf16":{"start":{"line_number":1871,"utf16_col":5},"end":{"line_number":1871,"utf16_col":30}},"extent_utf16":{"start":{"line_number":1871,"utf16_col":0},"end":{"line_number":1899,"utf16_col":0}}},{"name":"POST api/revoke","kind":"section_4","ident_start":109471,"ident_end":109486,"extent_start":109466,"extent_end":110392,"fully_qualified_name":"POST api/revoke","ident_utf16":{"start":{"line_number":1899,"utf16_col":5},"end":{"line_number":1899,"utf16_col":20}},"extent_utf16":{"start":{"line_number":1899,"utf16_col":0},"end":{"line_number":1927,"utf16_col":0}}},{"name":"POST api/totp/disenroll","kind":"section_4","ident_start":110397,"ident_end":110420,"extent_start":110392,"extent_end":111912,"fully_qualified_name":"POST api/totp/disenroll","ident_utf16":{"start":{"line_number":1927,"utf16_col":5},"end":{"line_number":1927,"utf16_col":28}},"extent_utf16":{"start":{"line_number":1927,"utf16_col":0},"end":{"line_number":1966,"utf16_col":0}}},{"name":"POST api/totp/enroll","kind":"section_4","ident_start":111917,"ident_end":111937,"extent_start":111912,"extent_end":113610,"fully_qualified_name":"POST api/totp/enroll","ident_utf16":{"start":{"line_number":1966,"utf16_col":5},"end":{"line_number":1966,"utf16_col":25}},"extent_utf16":{"start":{"line_number":1966,"utf16_col":0},"end":{"line_number":2006,"utf16_col":0}}},{"name":"POST api/totp/rotate","kind":"section_4","ident_start":113615,"ident_end":113635,"extent_start":113610,"extent_end":115542,"fully_qualified_name":"POST api/totp/rotate","ident_utf16":{"start":{"line_number":2006,"utf16_col":5},"end":{"line_number":2006,"utf16_col":25}},"extent_utf16":{"start":{"line_number":2006,"utf16_col":0},"end":{"line_number":2050,"utf16_col":0}}},{"name":"Gossip Protocol","kind":"section_3","ident_start":115546,"ident_end":115561,"extent_start":115542,"extent_end":119643,"fully_qualified_name":"Gossip Protocol","ident_utf16":{"start":{"line_number":2050,"utf16_col":4},"end":{"line_number":2050,"utf16_col":19}},"extent_utf16":{"start":{"line_number":2050,"utf16_col":0},"end":{"line_number":2130,"utf16_col":0}}},{"name":"Gossip Protocol Background","kind":"section_4","ident_start":115568,"ident_end":115594,"extent_start":115563,"extent_end":115763,"fully_qualified_name":"Gossip Protocol Background","ident_utf16":{"start":{"line_number":2052,"utf16_col":5},"end":{"line_number":2052,"utf16_col":31}},"extent_utf16":{"start":{"line_number":2052,"utf16_col":0},"end":{"line_number":2057,"utf16_col":0}}},{"name":"Active Gossip (Checkpoints)","kind":"section_4","ident_start":115768,"ident_end":115795,"extent_start":115763,"extent_end":116741,"fully_qualified_name":"Active Gossip (Checkpoints)","ident_utf16":{"start":{"line_number":2057,"utf16_col":5},"end":{"line_number":2057,"utf16_col":32}},"extent_utf16":{"start":{"line_number":2057,"utf16_col":0},"end":{"line_number":2073,"utf16_col":0}}},{"name":"Passive Gossip (Mirroring)","kind":"section_4","ident_start":116746,"ident_end":116772,"extent_start":116741,"extent_end":118740,"fully_qualified_name":"Passive Gossip (Mirroring)","ident_utf16":{"start":{"line_number":2073,"utf16_col":5},"end":{"line_number":2073,"utf16_col":31}},"extent_utf16":{"start":{"line_number":2073,"utf16_col":0},"end":{"line_number":2116,"utf16_col":0}}},{"name":"Recursive Replication","kind":"section_5","ident_start":117339,"ident_end":117360,"extent_start":117333,"extent_end":117836,"fully_qualified_name":"Recursive Replication","ident_utf16":{"start":{"line_number":2086,"utf16_col":6},"end":{"line_number":2086,"utf16_col":27}},"extent_utf16":{"start":{"line_number":2086,"utf16_col":0},"end":{"line_number":2100,"utf16_col":0}}},{"name":"Trusted Mirrors","kind":"section_5","ident_start":117842,"ident_end":117857,"extent_start":117836,"extent_end":118740,"fully_qualified_name":"Trusted Mirrors","ident_utf16":{"start":{"line_number":2100,"utf16_col":6},"end":{"line_number":2100,"utf16_col":21}},"extent_utf16":{"start":{"line_number":2100,"utf16_col":0},"end":{"line_number":2116,"utf16_col":0}}},{"name":"Mirror Plaintext Cache Invalidation","kind":"section_4","ident_start":118745,"ident_end":118780,"extent_start":118740,"extent_end":119643,"fully_qualified_name":"Mirror Plaintext Cache Invalidation","ident_utf16":{"start":{"line_number":2116,"utf16_col":5},"end":{"line_number":2116,"utf16_col":40}},"extent_utf16":{"start":{"line_number":2116,"utf16_col":0},"end":{"line_number":2130,"utf16_col":0}}},{"name":"Sigsum Integration","kind":"section_3","ident_start":119647,"ident_end":119665,"extent_start":119643,"extent_end":121883,"fully_qualified_name":"Sigsum Integration","ident_utf16":{"start":{"line_number":2130,"utf16_col":4},"end":{"line_number":2130,"utf16_col":22}},"extent_utf16":{"start":{"line_number":2130,"utf16_col":0},"end":{"line_number":2181,"utf16_col":0}}},{"name":"Witness Co-Signing","kind":"section_4","ident_start":121169,"ident_end":121187,"extent_start":121164,"extent_end":121883,"fully_qualified_name":"Witness Co-Signing","ident_utf16":{"start":{"line_number":2169,"utf16_col":5},"end":{"line_number":2169,"utf16_col":23}},"extent_utf16":{"start":{"line_number":2169,"utf16_col":0},"end":{"line_number":2181,"utf16_col":0}}},{"name":"Auxiliary Data Extensions","kind":"section_3","ident_start":121887,"ident_end":121912,"extent_start":121883,"extent_end":122285,"fully_qualified_name":"Auxiliary Data Extensions","ident_utf16":{"start":{"line_number":2181,"utf16_col":4},"end":{"line_number":2181,"utf16_col":29}},"extent_utf16":{"start":{"line_number":2181,"utf16_col":0},"end":{"line_number":2190,"utf16_col":0}}},{"name":"Cryptography Protocols","kind":"section_2","ident_start":122288,"ident_end":122310,"extent_start":122285,"extent_end":134674,"fully_qualified_name":"Cryptography Protocols","ident_utf16":{"start":{"line_number":2190,"utf16_col":3},"end":{"line_number":2190,"utf16_col":25}},"extent_utf16":{"start":{"line_number":2190,"utf16_col":0},"end":{"line_number":2420,"utf16_col":0}}},{"name":"Protocol Message Encryption","kind":"section_3","ident_start":122844,"ident_end":122871,"extent_start":122840,"extent_end":123698,"fully_qualified_name":"Protocol Message Encryption","ident_utf16":{"start":{"line_number":2202,"utf16_col":4},"end":{"line_number":2202,"utf16_col":31}},"extent_utf16":{"start":{"line_number":2202,"utf16_col":0},"end":{"line_number":2219,"utf16_col":0}}},{"name":"Encrypting Message Attributes to Enable Crypto Shredding","kind":"section_3","ident_start":123702,"ident_end":123758,"extent_start":123698,"extent_end":126976,"fully_qualified_name":"Encrypting Message Attributes to Enable Crypto Shredding","ident_utf16":{"start":{"line_number":2219,"utf16_col":4},"end":{"line_number":2219,"utf16_col":60}},"extent_utf16":{"start":{"line_number":2219,"utf16_col":0},"end":{"line_number":2266,"utf16_col":0}}},{"name":"Recent Merkle Root Included in Plaintext Commitments","kind":"section_4","ident_start":125048,"ident_end":125100,"extent_start":125043,"extent_end":126976,"fully_qualified_name":"Recent Merkle Root Included in Plaintext Commitments","ident_utf16":{"start":{"line_number":2240,"utf16_col":5},"end":{"line_number":2240,"utf16_col":57}},"extent_utf16":{"start":{"line_number":2240,"utf16_col":0},"end":{"line_number":2266,"utf16_col":0}}},{"name":"Algorithm Suite Versions","kind":"section_3","ident_start":126980,"ident_end":127004,"extent_start":126976,"extent_end":134073,"fully_qualified_name":"Algorithm Suite Versions","ident_utf16":{"start":{"line_number":2266,"utf16_col":4},"end":{"line_number":2266,"utf16_col":28}},"extent_utf16":{"start":{"line_number":2266,"utf16_col":0},"end":{"line_number":2403,"utf16_col":0}}},{"name":"Version 1","kind":"section_4","ident_start":127605,"ident_end":127614,"extent_start":127600,"extent_end":129173,"fully_qualified_name":"Version 1","ident_utf16":{"start":{"line_number":2278,"utf16_col":5},"end":{"line_number":2278,"utf16_col":14}},"extent_utf16":{"start":{"line_number":2278,"utf16_col":0},"end":{"line_number":2305,"utf16_col":0}}},{"name":"Version 1 Constants","kind":"section_5","ident_start":127622,"ident_end":127641,"extent_start":127616,"extent_end":128308,"fully_qualified_name":"Version 1 Constants","ident_utf16":{"start":{"line_number":2280,"utf16_col":6},"end":{"line_number":2280,"utf16_col":25}},"extent_utf16":{"start":{"line_number":2280,"utf16_col":0},"end":{"line_number":2293,"utf16_col":0}}},{"name":"Version 1 Functions","kind":"section_5","ident_start":128314,"ident_end":128333,"extent_start":128308,"extent_end":129173,"fully_qualified_name":"Version 1 Functions","ident_utf16":{"start":{"line_number":2293,"utf16_col":6},"end":{"line_number":2293,"utf16_col":25}},"extent_utf16":{"start":{"line_number":2293,"utf16_col":0},"end":{"line_number":2305,"utf16_col":0}}},{"name":"Message Attribute Plaintext Commitment Algorithm","kind":"section_4","ident_start":129178,"ident_end":129226,"extent_start":129173,"extent_end":129803,"fully_qualified_name":"Message Attribute Plaintext Commitment Algorithm","ident_utf16":{"start":{"line_number":2305,"utf16_col":5},"end":{"line_number":2305,"utf16_col":53}},"extent_utf16":{"start":{"line_number":2305,"utf16_col":0},"end":{"line_number":2327,"utf16_col":0}}},{"name":"Message Attribute Encryption Algorithm","kind":"section_4","ident_start":129808,"ident_end":129846,"extent_start":129803,"extent_end":131601,"fully_qualified_name":"Message Attribute Encryption Algorithm","ident_utf16":{"start":{"line_number":2327,"utf16_col":5},"end":{"line_number":2327,"utf16_col":43}},"extent_utf16":{"start":{"line_number":2327,"utf16_col":0},"end":{"line_number":2360,"utf16_col":0}}},{"name":"Message Attribute Decryption Algorithm","kind":"section_4","ident_start":131606,"ident_end":131644,"extent_start":131601,"extent_end":134073,"fully_qualified_name":"Message Attribute Decryption Algorithm","ident_utf16":{"start":{"line_number":2360,"utf16_col":5},"end":{"line_number":2360,"utf16_col":43}},"extent_utf16":{"start":{"line_number":2360,"utf16_col":0},"end":{"line_number":2403,"utf16_col":0}}},{"name":"HPKE Cipher Suites","kind":"section_3","ident_start":134077,"ident_end":134095,"extent_start":134073,"extent_end":134674,"fully_qualified_name":"HPKE Cipher Suites","ident_utf16":{"start":{"line_number":2403,"utf16_col":4},"end":{"line_number":2403,"utf16_col":22}},"extent_utf16":{"start":{"line_number":2403,"utf16_col":0},"end":{"line_number":2420,"utf16_col":0}}},{"name":"Security Considerations","kind":"section_2","ident_start":134677,"ident_end":134700,"extent_start":134674,"extent_end":146007,"fully_qualified_name":"Security Considerations","ident_utf16":{"start":{"line_number":2420,"utf16_col":3},"end":{"line_number":2420,"utf16_col":26}},"extent_utf16":{"start":{"line_number":2420,"utf16_col":0},"end":{"line_number":2599,"utf16_col":0}}},{"name":"Rules For Cryptography Implementors","kind":"section_3","ident_start":134706,"ident_end":134741,"extent_start":134702,"extent_end":135923,"fully_qualified_name":"Rules For Cryptography Implementors","ident_utf16":{"start":{"line_number":2422,"utf16_col":4},"end":{"line_number":2422,"utf16_col":39}},"extent_utf16":{"start":{"line_number":2422,"utf16_col":0},"end":{"line_number":2444,"utf16_col":0}}},{"name":"Cryptographic Agility","kind":"section_3","ident_start":135927,"ident_end":135948,"extent_start":135923,"extent_end":136512,"fully_qualified_name":"Cryptographic Agility","ident_utf16":{"start":{"line_number":2444,"utf16_col":4},"end":{"line_number":2444,"utf16_col":25}},"extent_utf16":{"start":{"line_number":2444,"utf16_col":0},"end":{"line_number":2454,"utf16_col":0}}},{"name":"Interoperability As A Non-Goal","kind":"section_3","ident_start":136516,"ident_end":136546,"extent_start":136512,"extent_end":136748,"fully_qualified_name":"Interoperability As A Non-Goal","ident_utf16":{"start":{"line_number":2454,"utf16_col":4},"end":{"line_number":2454,"utf16_col":34}},"extent_utf16":{"start":{"line_number":2454,"utf16_col":0},"end":{"line_number":2459,"utf16_col":0}}},{"name":"Encryption of Protocol Message Attributes","kind":"section_3","ident_start":136752,"ident_end":136793,"extent_start":136748,"extent_end":138908,"fully_qualified_name":"Encryption of Protocol Message Attributes","ident_utf16":{"start":{"line_number":2459,"utf16_col":4},"end":{"line_number":2459,"utf16_col":45}},"extent_utf16":{"start":{"line_number":2459,"utf16_col":0},"end":{"line_number":2493,"utf16_col":0}}},{"name":"Plaintext Commitment","kind":"section_4","ident_start":137512,"ident_end":137532,"extent_start":137507,"extent_end":138908,"fully_qualified_name":"Plaintext Commitment","ident_utf16":{"start":{"line_number":2472,"utf16_col":5},"end":{"line_number":2472,"utf16_col":25}},"extent_utf16":{"start":{"line_number":2472,"utf16_col":0},"end":{"line_number":2493,"utf16_col":0}}},{"name":"Revocation and Account Recovery","kind":"section_3","ident_start":138912,"ident_end":138943,"extent_start":138908,"extent_end":140023,"fully_qualified_name":"Revocation and Account Recovery","ident_utf16":{"start":{"line_number":2493,"utf16_col":4},"end":{"line_number":2493,"utf16_col":35}},"extent_utf16":{"start":{"line_number":2493,"utf16_col":0},"end":{"line_number":2512,"utf16_col":0}}},{"name":"Minimal Trust of Instance Operators","kind":"section_3","ident_start":140027,"ident_end":140062,"extent_start":140023,"extent_end":143298,"fully_qualified_name":"Minimal Trust of Instance Operators","ident_utf16":{"start":{"line_number":2512,"utf16_col":4},"end":{"line_number":2512,"utf16_col":39}},"extent_utf16":{"start":{"line_number":2512,"utf16_col":0},"end":{"line_number":2558,"utf16_col":0}}},{"name":"Position Statement From the Authors","kind":"section_4","ident_start":141678,"ident_end":141713,"extent_start":141673,"extent_end":143298,"fully_qualified_name":"Position Statement From the Authors","ident_utf16":{"start":{"line_number":2535,"utf16_col":5},"end":{"line_number":2535,"utf16_col":40}},"extent_utf16":{"start":{"line_number":2535,"utf16_col":0},"end":{"line_number":2558,"utf16_col":0}}},{"name":"Availability","kind":"section_3","ident_start":143302,"ident_end":143314,"extent_start":143298,"extent_end":144382,"fully_qualified_name":"Availability","ident_utf16":{"start":{"line_number":2558,"utf16_col":4},"end":{"line_number":2558,"utf16_col":16}},"extent_utf16":{"start":{"line_number":2558,"utf16_col":0},"end":{"line_number":2573,"utf16_col":0}}},{"name":"Reasoning for Encryption of Protocol Messages from Clients","kind":"section_3","ident_start":144386,"ident_end":144444,"extent_start":144382,"extent_end":145146,"fully_qualified_name":"Reasoning for Encryption of Protocol Messages from Clients","ident_utf16":{"start":{"line_number":2573,"utf16_col":4},"end":{"line_number":2573,"utf16_col":62}},"extent_utf16":{"start":{"line_number":2573,"utf16_col":0},"end":{"line_number":2586,"utf16_col":0}}},{"name":"Quantifying the Trustworthiness of the Public Key Directory","kind":"section_3","ident_start":145150,"ident_end":145209,"extent_start":145146,"extent_end":146007,"fully_qualified_name":"Quantifying the Trustworthiness of the Public Key Directory","ident_utf16":{"start":{"line_number":2586,"utf16_col":4},"end":{"line_number":2586,"utf16_col":63}},"extent_utf16":{"start":{"line_number":2586,"utf16_col":0},"end":{"line_number":2599,"utf16_col":0}}}]}},"copilotInfo":null,"copilotAccessAllowed":false,"modelsAccessAllowed":false,"modelsRepoIntegrationEnabled":false,"isMarketplaceEnabled":true,"csrf_tokens":{"/fedi-e2ee/public-key-directory-specification/branches":{"post":"KrhA7cPwoWNLfIHfe8QCkj1SOauVKhAKnb3cdb0kVr2SpAJrav3lkjTCLF-ymHUQzwklw9goDcyUDS7QyyIQ7A"},"/repos/preferences":{"post":"Ih711PUURx_qPY3SifwBF6dy_LoyHn4hSFOPwpDwxb4ya8futulWymub9Ue1EXnfI4zERY63F7Q3_PK9uEawJw"}}},"title":"public-key-directory-specification/Specification.md at main · fedi-e2ee/public-key-directory-specification","appPayload":{"helpUrl":"https://docs.github.com","findFileWorkerPath":"/assets-cdn/worker/find-file-worker-9bd411a8e273.js","findInFileWorkerPath":"/assets-cdn/worker/find-in-file-worker-4747241b1152.js","githubDevUrl":null,"enabled_features":{"code_nav_ui_events":false,"react_blob_overlay":false,"accessible_code_button":true}}}</script>
  <div data-target="react-app.reactRoot"></div>
</react-app>
</turbo-frame>



  </div>

</turbo-frame>

    </main>
  </div>

  </div>

          <footer class="footer pt-8 pb-6 f6 color-fg-muted p-responsive" role="contentinfo" >
  <h2 class='sr-only'>Footer</h2>

  


  <div class="d-flex flex-justify-center flex-items-center flex-column-reverse flex-lg-row flex-wrap flex-lg-nowrap">
    <div class="d-flex flex-items-center flex-shrink-0 mx-2">
      <a aria-label="GitHub Homepage" class="footer-octicon mr-2" href="https://github.com">
        <svg aria-hidden="true" height="24" viewBox="0 0 24 24" version="1.1" width="24" data-view-component="true" class="octicon octicon-mark-github">
    <path d="M12 1C5.923 1 1 5.923 1 12c0 4.867 3.149 8.979 7.521 10.436.55.096.756-.233.756-.522 0-.262-.013-1.128-.013-2.049-2.764.509-3.479-.674-3.699-1.292-.124-.317-.66-1.293-1.127-1.554-.385-.207-.936-.715-.014-.729.866-.014 1.485.797 1.691 1.128.99 1.663 2.571 1.196 3.204.907.096-.715.385-1.196.701-1.471-2.448-.275-5.005-1.224-5.005-5.432 0-1.196.426-2.186 1.128-2.956-.111-.275-.496-1.402.11-2.915 0 0 .921-.288 3.024 1.128a10.193 10.193 0 0 1 2.75-.371c.936 0 1.871.123 2.75.371 2.104-1.43 3.025-1.128 3.025-1.128.605 1.513.221 2.64.111 2.915.701.77 1.127 1.747 1.127 2.956 0 4.222-2.571 5.157-5.019 5.432.399.344.743 1.004.743 2.035 0 1.471-.014 2.654-.014 3.025 0 .289.206.632.756.522C19.851 20.979 23 16.854 23 12c0-6.077-4.922-11-11-11Z"></path>
</svg>
</a>
      <span>
        &copy; 2025 GitHub,&nbsp;Inc.
      </span>
    </div>

    <nav aria-label="Footer">
      <h3 class="sr-only" id="sr-footer-heading">Footer navigation</h3>

      <ul class="list-style-none d-flex flex-justify-center flex-wrap mb-2 mb-lg-0" aria-labelledby="sr-footer-heading">

          <li class="mx-2">
            <a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to Terms&quot;,&quot;label&quot;:&quot;text:terms&quot;}" href="https://docs.github.com/site-policy/github-terms/github-terms-of-service" data-view-component="true" class="Link--secondary Link">Terms</a>
          </li>

          <li class="mx-2">
            <a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to privacy&quot;,&quot;label&quot;:&quot;text:privacy&quot;}" href="https://docs.github.com/site-policy/privacy-policies/github-privacy-statement" data-view-component="true" class="Link--secondary Link">Privacy</a>
          </li>

          <li class="mx-2">
            <a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to security&quot;,&quot;label&quot;:&quot;text:security&quot;}" href="https://github.com/security" data-view-component="true" class="Link--secondary Link">Security</a>
          </li>

          <li class="mx-2">
            <a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to status&quot;,&quot;label&quot;:&quot;text:status&quot;}" href="https://www.githubstatus.com/" data-view-component="true" class="Link--secondary Link">Status</a>
          </li>

          <li class="mx-2">
            <a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to community&quot;,&quot;label&quot;:&quot;text:community&quot;}" href="https://github.community/" data-view-component="true" class="Link--secondary Link">Community</a>
          </li>

          <li class="mx-2">
            <a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to docs&quot;,&quot;label&quot;:&quot;text:docs&quot;}" href="https://docs.github.com/" data-view-component="true" class="Link--secondary Link">Docs</a>
          </li>

          <li class="mx-2">
            <a data-analytics-event="{&quot;category&quot;:&quot;Footer&quot;,&quot;action&quot;:&quot;go to contact&quot;,&quot;label&quot;:&quot;text:contact&quot;}" href="https://support.github.com?tags=dotcom-footer" data-view-component="true" class="Link--secondary Link">Contact</a>
          </li>

          <li class="mx-2" >
  <cookie-consent-link>
    <button
      type="button"
      class="Link--secondary underline-on-hover border-0 p-0 color-bg-transparent"
      data-action="click:cookie-consent-link#showConsentManagement"
      data-analytics-event="{&quot;location&quot;:&quot;footer&quot;,&quot;action&quot;:&quot;cookies&quot;,&quot;context&quot;:&quot;subfooter&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;cookies_link_subfooter_footer&quot;}"
    >
       Manage cookies
    </button>
  </cookie-consent-link>
</li>

<li class="mx-2">
  <cookie-consent-link>
    <button
      type="button"
      class="Link--secondary underline-on-hover border-0 p-0 color-bg-transparent text-left"
      data-action="click:cookie-consent-link#showConsentManagement"
      data-analytics-event="{&quot;location&quot;:&quot;footer&quot;,&quot;action&quot;:&quot;dont_share_info&quot;,&quot;context&quot;:&quot;subfooter&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;label&quot;:&quot;dont_share_info_link_subfooter_footer&quot;}"
    >
      Do not share my personal information
    </button>
  </cookie-consent-link>
</li>

      </ul>
    </nav>
  </div>
</footer>



    <ghcc-consent id="ghcc" class="position-fixed bottom-0 left-0" style="z-index: 999999"
      data-locale="en"
      data-initial-cookie-consent-allowed=""
      data-cookie-consent-required="false"
    ></ghcc-consent>




  <div id="ajax-error-message" class="ajax-error-message flash flash-error" hidden>
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-alert">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg>
    <button type="button" class="flash-close js-ajax-error-dismiss" aria-label="Dismiss error">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
    </button>
    You can’t perform that action at this time.
  </div>

    <template id="site-details-dialog">
  <details class="details-reset details-overlay details-overlay-dark lh-default color-fg-default hx_rsm" open>
    <summary role="button" aria-label="Close dialog"></summary>
    <details-dialog class="Box Box--overlay d-flex flex-column anim-fade-in fast hx_rsm-dialog hx_rsm-modal">
      <button class="Box-btn-octicon m-0 btn-octicon position-absolute right-0 top-0" type="button" aria-label="Close dialog" data-close-dialog>
        <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-x">
    <path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.749.749 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.749.749 0 0 1-.734-.215L8 9.06l-3.22 3.22a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06Z"></path>
</svg>
      </button>
      <div class="octocat-spinner my-6 js-details-dialog-spinner"></div>
    </details-dialog>
  </details>
</template>

    <div class="Popover js-hovercard-content position-absolute" style="display: none; outline: none;">
  <div class="Popover-message Popover-message--bottom-left Popover-message--large Box color-shadow-large" style="width:360px;">
  </div>
</div>

    <template id="snippet-clipboard-copy-button">
  <div class="zeroclipboard-container position-absolute right-0 top-0">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn js-clipboard-copy m-2 p-0" data-copy-feedback="Copied!" data-tooltip-direction="w">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon m-2">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none m-2">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div>
</template>
<template id="snippet-clipboard-copy-button-unpositioned">
  <div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div>
</template>




    </div>
    <div id="js-global-screen-reader-notice" class="sr-only mt-n1" aria-live="polite" aria-atomic="true" ></div>
    <div id="js-global-screen-reader-notice-assertive" class="sr-only mt-n1" aria-live="assertive" aria-atomic="true"></div>
  </body>
</html>

